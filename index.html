<!DOCTYPE html>
<html>
<head>
   <title>genai_trade_tracker</title>
</head>
   <body style="display:flex;flex-direction: column;">
<style>/* PC */
hr{border-top: solid 1px cadetblue;
   border-bottom: none;}
   html, body { height: 100%; width:100%; background:black; margin:0}
   body{padding-top:1em;display:flex;flex-direction:column;overflow:hidden;
   justify-content:space-evenly;align-items:center;    font-size: 1.222rem;}
   input { width: auto; box-sizing: border-box; }         
   .topLeftBtn1{position:absolute;top:3px;left:6px;display:flex;}
   .topLeftBtn1 .txt1{ color:skyblue; font-size:0.444em;margin:3px 0 0 3px;}
   .topLeftBtn1 .icon1 {font-size:1em;padding-bottom:6px;}
   .topRightBtn2{position:absolute;top:3px;right:6px;display:flex;}
   .topRightBtn2 .txt1{ color:skyblue; font-size:0.444em;margin:3px 0 0 3px;}
   .topRightBtn2 .icon1 {font-size:1em;padding-bottom:6px;}
   .docDeleteBtn {border-radius: 100%; background: darkgrey;}
   .docTopicBtn {border-radius: 13px;margin-top: 10px;background: slategrey;
      color: skyblue; font-size: 0.666em; padding: 6px;}
   .docTopicBtn:hover{border:2px solid steelblue}
   .mainBtn{margin:1em; color:darkblue;} 
   .subMenuBtn { color:#75bdb7; border-radius: 13px;  background-image: linear-gradient(grey, steelblue, black);
               margin:0.666em;cursor:pointer;font-size:0.888em;padding: 2px 6px 4px 6px; }
   .boxTitle{font-size:1.222em; color:#6868dc;}
   .btnTXT{font-size:1em;}
   .addBtn1{border-radius:13px;background:#7bd67b;float: right;
   margin-right: 0%;cursor:pointer;
   font-size: 0.777em;
   /* margin-top: 0.888em; */
}
   .genReportBtn1{border-radius:13px;
   background:#6cd8d8;
   float: right;
   margin-right: 2%;cursor:pointer;
   font-size: 0.777em;
   margin-top: 0.555em; 
   padding:0.222em;
   padding-left: 0.666em;color:#012d56;padding-right: 0.444em;
   padding-bottom: 0.444em;
}
   .storyzHeaderSaveBtn1{border-radius:13px;
   background:#6cd8d8;
   float: right;
   margin-right: 2%;cursor:pointer;
   font-size: 0.777em;margin-top: 0.888em;padding:0.222em;
   padding-left: 0.666em;color:#012d56;padding-right: 0.444em;
   padding-bottom: 0.444em;
   height: 2em;
   padding-top: 1px;    
}

.genReportBtn2{border-radius:13px;
   background:#6cd8d8;
   float: right;
   margin-right: 2%;cursor:pointer;
   font-size: 0.777em;margin-top: 0.888em;
   padding-left: 0.666em;color:#012d56;padding-right: 0.444em;
}
.genBtn1{font-size:0.777em; border-radius:22px; cursor:pointer;
   background:#5fa9a9; border-radius: 10px;color:#060252;
   margin: 1em;
}
.editBtn01{
   border-radius: 13px;
   background: #6ebc97;
    cursor: pointer;
    margin: 1% 1% 1% 1%;
    font-size: 0.666em;
    height: 1.444em;
    padding: 1% 1%;
    display: flex;
    color: #174345;
    align-items: center;
}
.editBtn02{
   border-radius: 13px;
   background: #e29d98;
    cursor: pointer;
    margin: 1% 1% 1% 1%;
    font-size: 0.666em;
    height: 1.444em;
    padding: 1% 1%;
    display: flex;
    color: #174345;
    align-items: center;
}
.saveBtn0{
    min-width: 5em;
    justify-content: center;
   border-radius: 13px;
    background: #d1d67b;
    cursor: pointer;
    /* margin: 1% 1% 1% 1%; */
    font-size: 0.666em;
    height: 1.444em;
    /* padding: 1% 1%; */
    display: none;
    align-items: center;
}
.saveBtn03{
   border-radius: 13px;
    background: #d1d67b;
    cursor: pointer;
    margin: 1% 1% 1% 1%;
    font-size: 0.666em;
    height: 1.444em;
    padding: 1% 1%;
    display: none;
    align-items: center;
}
.saveBtn2{border-radius:13px;
   background:#d1d67b;
   cursor:pointer; margin:1em 0 1em 0;
   font-size: 0.777em;
}
.addBtn4{border-radius:13px;
   /* background:#d1d67b; */
   cursor:pointer; margin:1em 0 1em 0;
   font-size: 0.777em;
   background: cadetblue;
   border-radius: 13px;
   max-width: 9em;
   float:right;
   margin-right: 2%;
   margin-left: 1%;
}
.addBtn5{border-radius:13px;
   /* background:#d1d67b; */
   cursor:pointer; 
   /* margin:3px 0 3px 0; */
   font-size: 0.777em;
   background: cadetblue;
   border-radius: 13px;
   max-width: 9em;
   float:right;
   margin-right: 2%;
   margin-left: 1%;
   margin-top: 2%;
}
.addBtn6{border-radius:13px;
   /* background:#d1d67b; */
   cursor:pointer; 
   /* margin:3px 0 3px 0; */
   font-size: 0.777em;
   background: #05393b;
   border-radius: 13px;
   max-width: 9em;
   float:right;
   margin-right: 2%;
   margin-left: 1%;
   margin-top: 0.6em;
    max-height: 1.777em;
    padding-top:0;
}
.addBtn7{border-radius:13px;
   /* background:#d1d67b; */
   cursor:pointer; 
   /* margin:3px 0 3px 0; */
   /* font-size: 0.777em; */
   background: #20053b;
   border-radius: 13px;
   max-width: 9em;
   float:right;
   margin-right: 2%;
   margin-left: 1%;
   /* margin-top: 0.6em; */
    max-height: 1.777em;
    padding-top:0;
    height: 1.555em;
    margin-top: 0.111em;
    margin-bottom: 0.444em;
    padding-top: 0;
    font-size: 0.6em;
    padding-bottom: 20px;    
}
.expandCollapseBtn0{
   border-radius:13px;background:#d1d67b;
   cursor:pointer; margin:1em 0 1em 0;
   font-size: 0.777em;
   background: cadetblue;
   border-radius: 13px;
   max-width: 9em;
   float:right;
   margin-right: 2%;
   margin-left: 1%;
}
.expandCollapseBtn1{
   border-radius:13px;background:#d1d67b;
   cursor:pointer; margin:1em 0 1em 0;
   font-size: 0.777em;
   background: cadetblue;
   border-radius: 13px;
   max-width: 9em;
   float:right;
   margin-right: 2%;
   margin-left: 1%;
}
.decBtn1{font-size:0.777em; border-radius:22px; cursor:pointer;
   background:#5fa9a9; border-radius: 10px;color:#060252;
}
#saveTickBtn1{border-radius:13px;background:#d1d67b;float: right;
   margin-right: 2%;cursor:pointer;display:none;
   font-size: 0.777em;
}
#saveSpotBtn1{border-radius:13px;background:#d1d67b;float: right;
   margin-right: 2%;cursor:pointer;display:none;
   font-size: 0.777em;
}
.yellowBtn1{border-radius:13px;background:#d1d67b;float: right;
   margin-right: 2%;cursor:pointer;display:none;
   font-size: 0.777em;margin-top: 0.888em;
}
.delBtn1{    
   border: solid 1px #9e1717;
   border-radius: 22px;
   background: #38014e;
   font-size: 0.777em;
   cursor:pointer;
   /* margin: 0.444em; */
   margin-left:1em;
}
.delBtn2{
   float: right;
   margin-top: 0.777em;
   margin-right: 4%;
   border: solid 1px #9e1717;
   border-radius: 22px;
   background: #38014e;
   font-size: 1em;
   cursor:pointer;
}   

.roleBOX1{border-radius: 8px;
   font-size: 0.777em;
   background: #1a0033;
   color:  #136567;
   padding-left: 0.555em;
   margin: 0.444em 1em;
   display: flex;
   max-height: 24px;
   align-items: center;
   text-align: right;
}
.roleData1{    border-radius: 8px;
   font-size: 0.777em;
   background: #02184b;
   color: cyan;
   padding: 0;
   text-align: center;
   max-width: 68px;
   height: 16px;
   margin-bottom: -1px;
   border: 1px solid steelblue;}
   .typeBOX1{border-radius: 8px;
   font-size: 0.777em;
   background: #1a0033;
   color:  #136567;
   padding-left: 0.555em;
   margin: 0.444em 1em;
   display: flex;
   max-height: 24px;
   align-items: center;
   text-align: right;
}
   .typeData1 {
   border-radius: 8px;
   background: #02184b;
   color: cyan;
   padding: 0;
   text-align: center;
   max-width: 36px;
   height: 16px;
   margin-bottom: -1px;
   border: 1px solid steelblue;
   font-size: 1.111em;
}

.tkrPriceBOX1{border-radius: 8px;
   font-size: 0.666em;
   background: #1a0033;
   color: cyan;
   padding-left: 0.555em;
   margin: 0.444em 1em;
   display: flex;
   max-height: 24px;
   align-items: center;
   text-align: right;
}
.tkrPriceData1{    border-radius: 8px;
   font-size: 0.999em;
   background: #02184b;
   color: cyan;
   padding: 0 0.444em;
   text-align: center;
   max-width: 50px;
   height: 16px;
   margin-bottom: -1px;
   border: 1px solid steelblue;}

   .tkrPriceDate1{    border-radius: 8px;
   font-size: 0.888em;
   background: #02184b;
   color: #546a9b;
   padding: 0 0.444em;
   text-align: center;
   max-width: 50px;
   height: 16px;
   font-size: 0.555em;
   margin-bottom: -1px;
   border: none;
   color: cadetblue;
   font-size: 0.6em;
}

.spotamountBOX1{border-radius: 8px;
   font-size: 0.777em;
   background: #1a0033;
   color:  #136567;
   padding-left: 0.555em;
   margin: 0.222em 1em;
   display: flex;
   max-height: 24px;
   align-items: center;
   text-align: right;
}
.spotamountData1{    border-radius: 8px;
   font-size: 0.888em;
   background: #02184b;
   color: #136567;
   padding: 0 0.444em;
   text-align: center;
   max-width: 50px;
   height: 16px;
   margin-bottom: -1px;
   border: 1px solid steelblue;}

   .tkrATHBOX1{border-radius: 8px;
   font-size: 0.666em;
   background: #1a0033;
   color: cyan;
   padding-left: 0.555em;
   margin: 0.444em 1em;
   display: flex;
   max-height: 24px;
   align-items: center;
   text-align: right;
   width:fit-content;
}
.tkrATHData1{    border-radius: 8px;
   font-size: 0.999em;
   background: #02184b;
   color: cyan;
   padding: 0 0.444em;
   text-align: center;
   max-width: 50px;
   height: 16px;
   margin-bottom: -1px;
   border: 1px solid steelblue;}
.tkrATHDate1{    border-radius: 8px;
   font-size: 0.999em;
   padding: 0 0.444em;
   text-align: center;
   max-width: 45px;
   height: 16px;
   margin-bottom: -1px;
   background: transparent;
    border: none;
    font-size: 0.6em;
    color: cadetblue;
    background: #02184b;
    margin-top: 0.222em;
    min-width: 7em;
}


.spotATHBOX1{border-radius: 8px;
   font-size: 0.777em;
   background: #1a0033;
   color: cyan;
   padding-left: 0.555em;
   margin: 0.222em 1em;
   display: flex;
   max-height: 24px;
   align-items: center;
   text-align: right;
}
.spotATHData1{    border-radius: 8px;
   font-size: 0.999em;
   background: #02184b;
   color: cyan;
   padding: 0 0.444em;
   text-align: center;
   max-width: 34px;
   height: 16px;
   margin-bottom: -1px;
   border: 1px solid steelblue;}
.spotAtBOX1{border-radius: 8px;
   font-size: 0.777em;
   background: #1a0033;
   color: #136567;
   padding-left: 0.555em;
   margin: 0.222em 1em;
   display: flex;
   max-height: 24px;
   align-items: center;
   text-align: right;
}
.amtBOX1{border-radius: 8px;
   font-size: 0.777em;
   background: #1a0033;
   color: #136567;
   padding-left: 0.555em;
   margin: 0.222em 1em;
   display: flex;
   max-height: 24px;
   align-items: center;
   text-align: right;
}
.spotAtData1{    border-radius: 8px;
   font-size: 0.888em;
   background: #02184b;
   color: cyan;
   padding: 0 0.444em;
   text-align: center;
   max-width: 50px;
   height: 16px;
   margin-bottom: -1px;
   border: 1px solid steelblue;}
.genTicker1{    border-radius: 10px;
      max-width: 66px;
   text-align: center;
   font-size: 0.777em;
   color: cyan;;
   background: #6679a0;
}
   .genTicker1::-webkit-input-placeholder {
   color: rgb(68, 52, 106);
 }
 .decodeTick1{  border-radius: 10px;
   max-width: 66px;
   text-align: center;
   font-size: 0.777em;
   color: cyan;;
   background: #6679a0;
      }
   .decodeDate1{
   font-size:0.444em;color: #1a8c8c;background: none;
   border: 0;
   max-width: 6em;
   }
.decodeRow1{margin: 1%;
display: flex;
justify-content: space-around;
align-items: center;
flex-wrap: wrap;      
width: 92%;
border: solid 1px steelblue;
padding: 0 0 0 1%;
padding-left: 2%;
border-radius: 22px;
}
.encodeNUMBOX1{
      font-family: sans-serif;
   font-size: 0.555em;
   margin-left: -2em;
   padding-left: 1em;
   display: flex;
}

.capsNUMBOX0{
   font-family: sans-serif;
   font-size: 0.777em;
   display: flex;
   width:4em;
}   

.eventzNUMBOX0{
   font-family: sans-serif;
   font-size: 0.777em;
   display:flex;
   float:left;
   margin-top: -6px;
   width: 4em;
   margin-left: 1em;
}   
.quickNUMBOX0{
   font-family: sans-serif;
   font-size: 0.555em;
   float:left;
   margin-top: 3px;
}
.quickNUMBOX1{
   font-family: sans-serif;
   font-size: 0.555em;
   display: flex;
   margin-top: 0px;
}
.capsNUMBOX1{
   font-family: sans-serif;
   font-size: 0.555em;
   display: flex;
}
.capsNUMBOX2{
   font-family: sans-serif;
   font-size: 0.777em;
   margin-left: -2em;
   padding-left: 1em;
   display: flex;
}
.capsNUMBOX3{
   font-family: sans-serif;
   font-size: 0.777em;
   display: flex;
   margin-top: -8px;
}

.encodeSelect1{
   color:cyan;
}
.decodeNUMBOX1{
   font-family: sans-serif;
   font-size: 0.555em;
   margin-left: -1em;
   padding-left: 1em;
   display: flex;
}
.decodeSelect1{
   color:cyan;
}
.genRow1{margin: 1%; width:92%; border:solid 1px steelblue;
   border-radius:18px;padding-left: 3%;padding-top: 0;
   display: flex;
   justify-content: space-around;
   align-items: center;
   flex-wrap: wrap;
}
.hoverTXT:hover{color:navajowhite;}
.subMenuBtn:hover{border:2px solid steelblue; color:darkslategrey}
.disabled{ color: darkslategrey; border: 1px solid steelblue; 
   background: transparent !important;}
.hiddenTab{ display:none !important;}
.hiddenBtn1{ display:none !important;}
.textareaBOX {
   background:darkslateblue;
   background-attachment: local;
   background-image:
      linear-gradient(to right, darkslateblue 20px, transparent 20px),
      linear-gradient(to left, darkslateblue 20px, transparent 20px),
      repeating-linear-gradient(darkslateblue, darkslateblue 40px, #344065 40px, #344065 41px, darkslateblue 41px);
   line-height: 44px;
   padding: 8px 10px;
   width: 100%;
   padding-left: 8%;
color: darkcyan;  
font-size:0.888em;          
}
.textareaBOX2 {
   background:darkslateblue;
   background-attachment: local;
   background-image:
      linear-gradient(to right, darkslateblue 20px, transparent 20px),
      linear-gradient(to left, darkslateblue 20px, transparent 20px),
      repeating-linear-gradient(darkslateblue, darkslateblue 40px, #344065 40px, #344065 41px, darkslateblue 41px);
   line-height: 44px;
   padding: 2% 3%;
   width: 100%;
   padding-left: 8%;
color: darkcyan;  
font-size:0.666em;     
margin-right: 2%;     
}
#rightBOX,#leftBOX,#keyBOX{margin:2px;border: solid 1px steelblue;width: 100%;font-size: 0.777em;}

#encodeBOX, #decodeBOX, #instructionBOX, #scheduleBOX, #padSequenceBOX, 
#historyBOX, #allMarginsBOX, #reviewPreviewBOX {
   margin:2%;
}

#generatedScheduleBOX, #generatedProfitsBOX, #generatedMarginsBOX, 
#eventzFRAME, #storyzFRAME, #generatedReviewPreviewBOX{
   margin:2%;
}
.quarterBOX{
   display: flex;
flex-direction: column;
   margin-top:2em;
   background:#1b0227;
   border-radius: 13px;
}
.QuickQuarterBOX{
   display: flex;
flex-direction: column;
   margin-top:0.222em;
   background:#010e14;
   border-radius: 13px;
}

.storyzHeader{display:flex;    
   justify-content: space-between; 
   flex-wrap: wrap;
}
.storyzBOX{
   display: flex;
   flex-direction: column;
   margin-top:2em;
   background:#2c263d;
   border-radius: 13px;
   padding-top:0.222em;
   box-shadow: inset 0px 1px 8px 0px #a44ba9;
   padding-left: 3%;
}
.trimTick{
   font-family: sans-serif;
   border-radius: 10px;
   /* max-width: 52px; */
   /* display:flex; */
   text-align: center;
   font-size: 0.777em;
   color: cyan;;
   background: #6679a0;
   /* height: 1.222em; */
   align-self: center;
   min-width: 4em;
    width: 0;
}
.inputDATABOX4,.inputDATABOX5{
   display : none;
}

.inputDATABOX1, .inputDATABOX2,.inputDATABOX3,.inputDATABOX4,.inputDATABOX5{
   border-radius: 8px;
    font-size: 0.777em;
    background: #1a0033;
    color: #1e8385;
    /* padding-left: 0.555em; */
    padding-left: 0.444em;
    /* margin: 0.222em 0; */
    margin: 0.222em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
    align-self: center;
    padding-right: 1em;
    font-family: arial;    
}
.inputDATABOX0{
border-radius: 8px;
    font-size: 0.777em;
    background: #1a0033;
    color: #1e8385;
    padding-left: 0.444em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
    align-self: center;
    padding-right: 1em;
    font-family: arial;   
    margin-right: 1.444em; 
}
.inputDATA0{    border-radius: 8px;
    font-size: 0.777em;
    background: #02184b;
    color:    #136567;
    padding: 0 0.444em;
    text-align: center;
    min-width: 100%;
    width: 2em;
    height: 20px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}
.inputDATA1{    border-radius: 8px;
    font-size: 0.999em;
    background: #02184b;
    color:    #136567;
    padding: 0 0.444em;
    text-align: center;
    max-width: 50px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}

.saveBOX1{
   border-radius: 8px;
   display: flex;
   min-width: 4em;
   align-items: center;
}
.inputDATABOX2{border-radius: 8px;
    font-size: 0.777em;
    background: #1a0033;
    color: #b19f50;
    padding-left: 0.444em;
    margin: 0.222em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
    align-self: center;
}
.inputDATA2{    border-radius: 8px;
    font-size: 0.777em;
    background: #02184b;
    color: #b19f50;
    padding: 0 0.444em;
    text-align: center;
    max-width: 22px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}
.inputDATA3{    border-radius: 8px;
    font-size: 0.777em;
    background: #02184b;
    color: #b19f50;
    padding: 0 0.444em;
    text-align: center;
    max-width: 15px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;
}

.profitRow1, .marginsRow1, .detailRow1 {
   display: flex;
    justify-content: space-between;
    margin-right: 2%;
    flex-wrap: wrap;
}
.detailRow2 {
   display: flex;
    justify-content: space-between;
    margin-right: 2%;
    flex-wrap: wrap;
    padding-left:6.666%;
    font-size: 0.777em;
    color: #136567;
    align-items: center;
}

.fifoGRIDROW {
   display: flex;
    justify-content: space-between;
    margin-right: 2%;
    flex-wrap: wrap;
    font-size: 0.777em;
    color: #136567;
    align-items: flex-start;
    background: #0b0014;
    font-size: 1.111em;
    margin-left: 5.555%;
    border-radius: 13px;
    margin-right: 2%;
    margin-top: 0.555%;
    margin-bottom: 0.555%;
    flex-direction: column;
    padding-left: 2%;
    padding-top: 1%;    
}
.fifoGRIDBOX{
   margin-left: 1%;
    border: 1px solid steelblue;
    border-radius: 13px;
    padding: 0 1%;
    width: 93.333%;
    margin-bottom: 2%;
    margin-top: 1%;
}
.fifoTITLE1{
   font-size: 0.444em;
    color: #4b53b9;
    padding: 2%;
    background: transparent;
    border: none;
}
.fifoTrimYMD{
   font-size:0.444em;
   color:steelblue;
   display: flex;
    text-align: center;
    background: transparent;
    align-self: center;
    min-width: 7em;
    width: 0;
    border: none;   
}
.fifoTrimNUM{
  font-size:0.666em;
  color:lime;
  display: flex;
    text-align: center;
    background: transparent;
    align-self: center;
    min-width: 4em;
    width: 0;
    border: none;    
}
.fifoPadYMD{
   font-size:0.444em;
   color:steelblue;
   display: flex;
    text-align: center;
    background: transparent;
    align-self: center;
    min-width: 7em;
    width: 0;
    border: none;  
}
.fifoPadNUM{
  font-size:0.666em;
  color:red;
  display: flex;
    text-align: center;
    background: transparent;
    align-self: center;
    min-width: 4em;
    width: 0;
    border: none;  
}
.fifoData{
   display: flex;
    width: 3em;
    flex-direction: column;
    margin: 1%;
}
.fifoBOX{
   display:flex;
   flex-wrap: wrap;
}
.btnzROW {
   display: flex;
    justify-content: space-between;
    margin-right: 2%;
    flex-wrap: wrap;
    padding-left:6.666%;
    font-size: 0.777em;
    color: #136567;
    align-items: center;
    background: #0b0014;
    font-size: 1.111em;
    margin-left: 5.555%;
    border-radius: 13px;
    margin-right: 2%;
    /* margin-top: 0.555%;
    margin-bottom: 0.555%; */
    padding: 0.222em;    
    line-height: 1em;
}
.inputSAVEROW {
   display: none;
    justify-content: space-between;
    margin-right: 2%;
    flex-wrap: wrap;
    padding-left:6.666%;
    font-size: 0.777em;
    color: #136567;
    align-items: center;
    background: #0b0014;
    font-size: 1.111em;
    margin-left: 5.555%;
    border-radius: 13px;
    margin-right: 2%;
    margin-top: 0.555%;
    margin-bottom: 0.555%;
    padding: 0.222em;    
}
.tickrNOTEZROW {
   display: flex;
    justify-content: space-between;
    margin-right: 2%;
    flex-wrap: wrap;
    padding-left:6.666%;
    font-size: 0.777em;
    color: #136567;
    align-items: center;
    background: #0b0014;
    font-size: 1.111em;
    margin-left: 5.555%;
    border-radius: 13px;
    margin-right: 2%;
    margin-top: 0.555%;
    margin-bottom: 0.555%;
    padding: 0.222em;
    padding-left: 2%;    
}
.totalsRow1{
   display: flex;
    justify-content: space-evenly;
    font-size: 1.222em;
    color: limegreen;
}
.profitRow1 aside{
   display: flex;
    align-items: center;
}
.marginsRow1 aside{
   display: flex;
    align-items: center;
}
.detailRow1 aside{
   font-size :0.777em;
    align-items: center;
    padding-left:2%;
    color:#595fa5;
    line-height: 1.666em;
    text-align: right;
    width: 80px;
}
.scheduleRow1{
   display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 2%;
}

.addEVTZRow1{
   display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 2%;
    background: #4f3529;
    border-radius: 22px;
    border: 1px solid burlywood;
    margin-top: 1em;
    box-shadow: 1px 1px 6px burlywood;   
    flex-wrap: wrap; 
}
.detailDate1{
   background: none;
    color: #4b53b9;
    font-size: 0.555em;
    border: none;
    max-width: 6em;
}
.detailDate2{
   background: none;
    color: #de9257;
    font-size: 0.555em;
    border: none;
    max-width: 6em;
    margin-top: 6px;
}
.capROW{
   display: flex;
    justify-content: space-between;
    flex-wrap: wrap;    margin: 0 10px; 
}
.QuickROW{
   display: flex;
    justify-content: space-between;
    flex-wrap: wrap;    
    margin: 0 10px; 
    border-radius: 30%;
    background: #060615;
    padding-left: 2%;    
    
}
.quarterTitle{
   font-weight: bold;
    font-family: sans-serif;
    color: #3db63f;
    background: black;
    border-radius: 14px;
    padding: 6px;
    margin-left: 0.666em;    
    min-width: 9em;
    width: 0; 
    text-align: center;   
}
.quarterTXT{
   line-height: 1em;
   font-weight: bold;
    font-family: sans-serif;
    color: #3db63f;
    background: black;
    border-radius: 14px;
    padding: 6px;
    /* max-width: 7em; */
    margin-left: 0.666em;    
}

.storyzTITLE{
   line-height: 1em;
   font-weight: bold;
    font-family: sans-serif;
    color: cyan;
    background: transparent;
    border-radius: 14px;
    padding: 6px;
    /* max-width: 7em; */
    margin-left: 0.666em; 
    border: none;   
}
.trimBtnROW{
   display: flex;
    justify-content: space-between;
    flex-wrap: wrap;    margin: 0 10px;
}
.proTick1{
   width: 44px; /*align item column*/
}
      .smICON{font-size:0.555em;}
      #instructionText{display:none;margin:4%;}

      #keyINPUT:-webkit-autofill { -webkit-box-shadow: 0 0 0px 1000px #233453 inset;}


      #scrollFrame{width: 88%; padding-top:2.666%}  
      /*  custom scroll bar */
      .scrollBarV {height:97%; overflow-x:scroll; background:#010111; border: 1px steelblue solid; border-radius:13px;}
      .scrollBarV::-webkit-scrollbar-track { background-color: #010213;  border-radius: 13px; }
      .scrollBarV::-webkit-scrollbar { width: 1.222em; height: 100%;  }
      .scrollBarV::-webkit-scrollbar-thumb { background-color: #04223c; border-radius: 13px;
      background-image: -webkit-linear-gradient(0deg, rgba(255, 255, 255, 0.6) 26%, transparent 26%, transparent 51%, rgba(255, 255, 255, -0.4) 51%, rgba(255, 255, 255, 0.6) 74%, transparent 74%, transparent);
      }

      .typeTRIMColor{
         color:lime;
      }
      .typePADColor{
         color:red;
      }

/*******EVENTZ******/
.eventzNUM1{
   padding-top: 0.6em;
    margin-right: 0.555em;
    padding-left: 4px;
    font-weight: bold;
    font-family: cursive;
   }
.eventzBOX{
   display: flex;
flex-direction: column;
   margin-top:2em;
   background:#4f3529;
   border-radius: 13px;
   color:#231501;
   padding-top:0.555em;
   box-shadow: inset 0px 0px 6px 0px #f09f02;
}
.eventzROW{
   display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    margin: 0 10px;
    align-items: flex-start;
    padding-left: 1.444em; 
    /* height: 2em; */
    margin-bottom: 0.777em;
}
.eventzTXT{
   line-height: 1em;
   font-weight: bold;
    font-family: sans-serif;
    color: #de9257;
    background: transparent;
    border-radius: 14px;
    padding: 6px;
    margin-left: 0.666em; 
}
.eventzTitle{
   width:10em;
   width: 7em;
    text-align: center;
    border-radius: 13px;
    margin-top: 4px;
    background: burlywood;
    font-weight: bold;   
}
.eventzTypeBOX1{border-radius: 8px;
   border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: #136567;
    padding-left: 0.555em;
    margin: 0.444em 0.444em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
    width: 9em;
}
.eventzTypeBOX2{border-radius: 8px;
   border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: #136567;
    padding-left: 0.555em;
    margin: 0.444em 0.444em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
    width: 9em;
}
.eventzTypeBOX3{border-radius: 8px;
   border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: #136567;
    padding-left: 0.555em;
    margin: 0.444em 0.444em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
    width: 9em;
}
    .eventzTypeData1 {
    border-radius: 8px;
    background: #02184b;
    color: cyan;
    padding: 0;
    text-align: center;
    max-width: 66px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;
    font-size: 1.111em;
}
    .eventzTypeData2 {
    border-radius: 8px;
    background: #02184b;
    color: cyan;
    padding: 0;
    text-align: center;
    max-width: 46px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;
    font-size: 1.111em;
}
/*******ENDEVENTZ******/

.checkboxFrame {
  display: block;
  position: relative;
  padding: 0 4px;
    margin: 17px 6px 0 6px;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.checkboxFrame2 {
  display: block;
  position: relative;
  padding: 0 4px;
    margin: 14px 6px 0 6px;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* Hide the browser's default checkbox */
.checkboxFrame input {
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
}
.checkboxFrame2 input {
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
}

/* Create a custom checkbox */
.checkmark {
border:1px solid lime;
border-radius:13px;
  position: absolute;
  top: 0;
  left: 0;
  height: 10px;
  width: 10px;
  background-color: black;
  box-shadow: 0px 2px 6px 1px #010191;  
}

/* On mouse-over, add a grey background color */
.checkboxFrame:hover input ~ .checkmark {
  background-color: #014601;
}

/* When the checkbox is checked, add a blue background */
.checkboxFrame input:checked ~ .checkmark {
  background-color: steelblue;
}
/* On mouse-over, add a grey background color */
.checkboxFrame2:hover input ~ .checkmark {
  background-color: #014601;
}

/* When the checkbox is checked, add a blue background */
.checkboxFrame2 input:checked ~ .checkmark {
  background-color: steelblue;
}

/* Create the checkmark/indicator (hidden when not checked) */
.checkmark:after {
  content: "";
  position: absolute;
  display: none;
}

/* Show the checkmark when checked */
.checkboxFrame input:checked ~ .checkmark:after {
  display: block;
}

/* Style the checkmark/indicator */
.checkboxFrame .checkmark:after {
   left: 4px;
    top: -1px;
    width: 2px;
    height: 6px;
  border: solid #014601;
  border-width: 0 3px 3px 0;
  -webkit-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  transform: rotate(45deg);
}
/* Show the checkmark when checked */
.checkboxFrame2 input:checked ~ .checkmark:after {
  display: block;
}

/* Style the checkmark/indicator */
.checkboxFrame2 .checkmark:after {
   left: 4px;
    top: -1px;
    width: 2px;
    height: 6px;
  border: solid #014601;
  border-width: 0 3px 3px 0;
  -webkit-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  transform: rotate(45deg);
}

.btmBtns1{
   margin:1em 1%;
   font-size:0.777em;
}


.redTXT{color:#a43d3d!important;}
.greenTXT{color:#3db63f !important;}

      @media only screen and (max-width: 800px) { /* TABLET */
         body{  background-color: #000f1b;}
         .btnTXT{font-size:0.999em;}
         .mainBtn{margin:0.888em;}
         .subMenuBtn{font-size:0.777em;}
         #rightBOX{margin-right:6%; border:0px} 
         #leftBOX{margin-left:8%; border:0px }
         .boxTitle{font-size:0.999em}
      }  
      @media only screen and (max-width: 500px) { /* PHONE */
         body{ background-color: #08011e;}
         .btnTXT{font-size:0.999em;}
         .mainBtn{margin:0.666em;}
         .subMenuBtn{font-size:0.777em;}
         #messageBOX{flex-direction: column;}
         #encodeBOX, #decodeBOX, #instructionBOX, #scheduleBOX, #historyBOX,
         #padSequenceBOX, #reviewPreviewBOX, #allMarginsBOX{
            margin:2% 0;
         }  
         #scrollFrame{width: 95%; }       
         .boxTitle{font-size:0.777em}
         #appFooter{
            font-size: 0.666em;
         }
      }

     </style>
     <aside class="topLeftBtn1">
      <span class="icon1" style="border-radius:100%;background:steelblue; 
      border:2px solid grey;">🎪</span><span class="txt1">home</span>
      </aside>
      <aside style="font-size: 1em;color: steelblue;margin: -13px 0 14px 0;text-shadow: 0px -1px 5px #66aef3;">
        genai_trade_tracker</aside>
      <aside style="font-size: 0.777em;color: steelblue;margin: -10px 0 4px 0;">
      </aside>
      <aside class="topRightBtn2">
         <span class="txt1">charts</span>
         <span class="icon1" style="border-radius:100%;background:crimson; 
         border:2px solid grey;">🎢</span>
         </aside>      
      <header style="display:flex;justify-content:space-evenly; flex: 0 0 auto;
        background-image: linear-gradient(grey, steelblue, black);
        box-shadow:0 0 14px 0px steelblue;border-radius:13px; margin:0 auto;
        width:93%;">
         <button class="mainBtn" onclick="transcribeTXT()" style="border-radius:8px;
            background:grey; 
            cursor:pointer;box-shadow: inset 0px 0px 10px 0px limegreen;">
            <span style="border-radius:100%;background:limegreen;
              border:1px solid grey;">
            🏰</span><span class="btnTXT hoverTXT">Network</span>
         </button>

         <section id="notConnectedBox" class="mainBtn" style="border-radius:8px;
         background:#61f361;padding: 6px;">
            <span>🔴</span> Not Connected 
        </section>

         <section id="ConnectedBox" class="mainBtn" style="border-radius:8px;
         background:#6283be;padding: 6px;border: 1px solid darkslateblue;
         display:none;"><span style="border-radius:33%;background:skyblue;
              border:1px solid grey;">⚡</span>Connected
        </section>

         <section id="savedBox" class="mainBtn" style="border-radius:20px;
            background:rgb(249, 231, 130);padding:4px 4px 8px 4px;display:none;
            border: 1px solid rgb(221, 118, 2);color:rgb(221, 118, 2);
            ">💾 saved.</section>

         <section id="copiedBox" class="mainBtn" style="border-radius:20px;
            background:#fad688;padding:4px 4px 8px 4px;display:none;
            border: 1px solid rgb(221, 118, 2);color:rgb(221, 118, 2);
            ">🎭 copied.</section>

         <section id="errorBox" class="mainBtn" style="border-radius:20px;
            background:#091d3e;padding:4px 4px 8px 4px;display:none;
            border: 1px solid rgb(221, 118, 2);color:rgb(221, 118, 2);
            ">⚠️ error...</section>


         <button class= "mainBtn " onclick="stopTXT()" style="border-radius:8px;
            background:grey;box-shadow: inset 0px 0px 10px 0px crimson;
            cursor:pointer;"><span style="border-radius:100%;background:firebrick;
              border:1px solid grey;">
            💡</span><span class="btnTX hoverTXT">Market</span>
         </button>
        </header>
      <header id="messageBOX" style="display:flex;flex: 0 0 auto;
      margin: 0.222em;">
         <section id="leftBOX" style="display:flex; justify-content: center;
         border-radius: 13px;padding: 2px 6px;color: steelblue;align-items: center;
         "><span class="smICON">✴&nbsp;&nbsp;</span> ai viewz, of ledger metadata <span class="smICON">&nbsp;✳</span></section>            
         <section id="keyBOX" style="display:flex;border: solid 1px steelblue;
         border-radius: 13px;padding: 2px 6px;color: steelblue;align-items: center;
         margin:2px;">
               API:<input id="keyINPUT"  type="password" placeholder="api_key" 
               style="margin-left: 1em; background:#233453;
               border-radius: 10px 0px 0px 10px;"></input>
               <button style="margin-right: 1em; background:#03cbcb;cursor:pointer;
               border-radius: 0px 10px 10px 0px; font-size:0.777em;padding: 4px;" onclick="setAPIKEY();">SET</button>
         </section>
         <section id="rightBOX" style="display:flex;  justify-content: center;
         border-radius: 13px;padding: 2px 6px;color: steelblue;align-items: center;
         "><span class="smICON">&nbsp;&nbsp;✧&nbsp;</span>
         generated margins, schedules, trade idea trax and charts.<span class="smICON">&nbsp;❇</span></section>
      
      </header>         

<article id="scrollFrame" class="scrollBarV" style="overflow:auto;    display: flex;
flex-direction: column; max-width: 777px;
align-items: center;">


      <section id="QuickBOX"
        style="width:80.888%; flex:1;    background: #001512;
        border-radius: 13px;
        border: #35f405;
        box-shadow: inset 0px 0px 7px 0px #02f048;padding: 2%;padding-top: 3%;
        padding-left:4%; color: #b19f50; line-height: 2.111em;">
        <button id=expandCollapseBtn0 class="expandCollapseBtn1" onclick="ExpandCollapseQuickClick()">🕸️</button>        
        <span class="boxTitle">🦁 
         <span style="font-size:0.777em; color:cyan"></span>
         <span style="font-size:0.555em">⏱🗠</span>
         <span style="font-size: 1.222em;color:cyan;font-family: monospace;">QUICK TRACK</span>
         <span style="font-size:0.555em"> 🐇(trim|pad)🐒</span>
        </span><br>
        <article>
           <hr>   
           <section id="generatedQuickBOX"></section>
           <hr>   
           <button class="delBtn1"  style="float:right;margin-top:0.888em;margin-right:4%;"  
           onclick="deleteSelectedQuick(event)">🗑️</button> 
           <button id="copyQuickBtn" class="addBtn1" style="background: #7b97d6;margin-top: 0.888em;margin-right: 1%;" onclick="copyQuickQrtrClick()">
            copy fwd👻</button>
           <button id="addQuickBtn" class="addBtn1" style="margin-top: 0.888em;margin-right: 1%;" onclick="addQuickSectionClick()">
            blank qrtr🌷</button>
           <button id="saveQuickBtn1" class="yellowBtn1" onclick="saveQuickClick()">save⚓</button>
         </article>
      </section>

      <section id="encodeBOX"
        style="width:80.888%; flex:1;border-radius: 13px; border: solid 1px steelblue; 
        box-shadow: inset 1px 1px 11px 0px cyan; padding:2%;padding-top: 3%;padding-left:4%; color: cyan; line-height: 2.444em;">
        <button id="latestBtn1" class="genBtn1" style="display:none;float:right" onclick="getLatestTickerClick()">latest🔄</button>
        <span class="boxTitle">🎯 <span style="font-size:0.777em; color:cyan">1</span>
         <span style="font-size:0.555em">Encode</span>
         <span style="font-size: 1.222em;color:cyan;font-family: monospace;">Assets</span> 
         <span style="font-size:0.555em">(metadata) 🎪</span></span>
         <button id=expandCollapseBtn1 class="expandCollapseBtn1" onclick="assetsExpandCollapseClick()">🕸️</button>
         <hr/>
         <article id="encodeDATA"></article>
         <hr/>
        <button id="saveTickBtn1" onclick="saveTickerClick()">save🌟</button>
        <button class="delBtn1" style="float:right;margin-right:4%;" onclick="deleteSelectedTicker()">🗑️</button>
          <button id="addTickBtn" class="addBtn1" onclick="addTickerClick()">add🎇</button>
         </section>
      <section id="decodeBOX"
         style="width:80.888%; flex:1;background: #0a0014;border-radius: 13px; border: solid 1px steelblue; box-shadow: 0px 7px 20px 6px #39029e;
        padding: 2%;padding-left:4%;padding-top: 3%; color: cyan; line-height: 2.444em;">
        
        <span class="boxTitle">🎲 <span style="font-size:0.777em; color:cyan">2</span>
         <span style="font-size:0.555em">Decode</span>
         <span style="font-size: 1.222em;color:cyan;font-family: monospace;">Spots</span>
         <span style="font-size:0.555em">(time spot) 🎱</span></span>
         <button id=expandCollapseBtn2 class="expandCollapseBtn1" onclick="spotsExpandCollapseClick()">🕸️</button>
         <hr/>
         <aside id="decodeSPOTZ"></aside>
         <hr/>
        <button class="delBtn1"  style="float:right;margin-right:4%;"  onclick="deleteSelectedSpot()">🗑️</button>
        <button id="addSpotBtn" class="addBtn1" onclick="addSpotClick()">add🎆</button>
        <button id="saveSpotBtn1" onclick="saveSpotClick()">save⚓</button>
      </section>

      <section id="allMarginsBOX"
         style="width:80.888%; flex:1;background:#071936;border-radius: 13px; border: solid 1px #4ba1a9; 
         box-shadow: inset 0px 1px 20px 0px #023e16;padding: 2%;padding-left:4%;padding-top: 3%;
          color: #47c270; line-height: 2.444em;" 
         ">
         <button id=expandCollapseBtn3 class="expandCollapseBtn1" onclick="marginsExpandCollapseClick()">🕸️</button>
         <!-- <button id="generateMarginsBtn" class="genReportBtn1" onclick="initMarginsClick()">gener8🎰</button> -->
         <span class="boxTitle">🐤 <span style="font-size:0.777em; color:cyan">3</span> 
         <span style="font-size:0.555em">Generate</span>
         <span style="font-size: 1.222em;color:cyan;font-family: monospace;">MARGINS</span>
         <span style="font-size:0.555em">📏(on spots)💎</span>
         </span><br>
         <article style="font-size:0.777em;font-family: sans-serif;line-height:2.222em;">
            <hr> 
            <!-- Margins: -->
            <section id="generatedMarginsBOX"></section>
            <hr> 
            <button id="detailsBtn1" class="genReportBtn1" style="display:none;" onclick="setMarginDetailsClick(event)">details💎</button> 
            <button id="totalsBtn1" class="genReportBtn1" style="display:none;" onclick="setMarginDetailsClick(event)">totals⚙️</button> 
      </section>
      <section id="scheduleBOX"
        style="width:80.888%; flex:1;background:#0e0015;border-radius:13px; 
        border:#f46f05;box-shadow:inset 0px 0px 7px 0px #f0ae02;padding: 2%;padding-top: 3%;
        padding-left:4%; color: #b19f50; line-height: 2.444em;">
        <!-- <button id="generateScheduleBtn" class="genReportBtn1" onclick="generateScheduleClick()">gener8📉</button> -->
        <button id=expandCollapseBtn4 class="expandCollapseBtn1" onclick="capsExpandCollapseClick()">🕸️</button>        
        <span class="boxTitle">🔔 
         <span style="font-size:0.777em; color:cyan">4</span>
         <span style="font-size:0.555em">Generate</span>
         <span style="font-size: 1.222em;color:cyan;font-family: monospace;">CAPS & Levels</span>
         <span style="font-size:0.555em"> 📉(LVLz)📈</span>
        </span><br>
        <article>
           <hr>   
           <section id="generatedScheduleBOX"></section>
           <hr>   
           <button class="delBtn1"  style="float:right;margin-top:0.888em;margin-right:4%;"  
           onclick="deleteSelectedSchedule(event)">🗑️</button> 
           <button id="trimScheduleBtn" class="genBtn1" onclick="trimScheduleClick()">trim🐇</button>
           <button id="padScheduleBtn1" class="genBtn1" onclick="padScheduleClick()">pad🐒</button>
           <button id="detailsBtn2" class="genReportBtn2" style="display:block;" onclick="setScheduleDetailsClick(event)">details🔬</button> 
           <button id="totalsBtn2" class="genReportBtn2" style="display:none;" onclick="setScheduleDetailsClick(event)">brief🔭</button> 
           <button id="addScheduleBtn" class="addBtn1" style="margin-top: 0.888em;margin-right: 1%;" onclick="addScheduleClick()">
            add qrtr👻</button>
           <button id="saveScheduleBtn1" class="yellowBtn1" onclick="saveScheduleClick()">save⚓</button>
         </article>
      </section>
      <section id="padSequenceBOX"
         style="width:80.888%; flex:1;background:#100601;border-radius: 13px; border: solid 1px #a9754b;
         box-shadow: 1px 2px 11px 0px #f09f02;padding: 2%; padding-left:4%;padding-top: 3%;
         color:#b5997d; line-height: 2.444em;">
         <!-- <button id="generatePadSequencesBtn" class="genReportBtn1" onclick="generateEVTZClick()">gener8🎈</button> -->
         <button id=expandCollapseBtn5 class="expandCollapseBtn1" onclick="eventzExpandCollapseClick()">🕸️</button>
         <span class="boxTitle">💡 
          <span style="font-size:0.777em; color:cyan">5</span>
          <span style="font-size:0.555em; color:#de9257;">Generate</span>
          <span style="font-size: 1.222em;color:cyan;font-family: monospace;">
            MILESTONES🐾</span> 
          <span style="font-size:0.555em; color:#de9257;">🎢(eventz)🚀</span>
         </span><br>
         <article style="font-size:0.777em;font-family: sans-serif;line-height:2.222em;">
            <hr> 
            <section id="eventzFRAME"></section>
            <hr> 
            <button id="evtzDeleteBtn5" class="delBtn2" style="font-size: 1em;" onclick="setEVTZDeleteClick(event)">🗑️</button> 
            <button id="evtzMilestoneBtn5" class="genReportBtn1" style="font-size: 0.888em;" onclick="addEVTZMilestoneClick(event)">add Milestone🐾</button> 
            <button id="evtzSaveBtn5" class="genReportBtn1" style="font-size: 0.888em;display:none;" onclick="setEVTZSaveClick(event)">save🤩</button> 
      </section>
      <section id="reviewPreviewBOX"
         style="width:80.888%; flex:1;background:#070c36;border-radius: 13px; border: solid 1px #a44ba9; 
         box-shadow:inset 0px 0px 11px 0px #5e336d;padding: 2%; padding-left:4%;padding-top: 3%;
         color: #917db5; line-height: 2.444em;">
         <!-- <button id="generateReviewPreviewsBtn" class="genReportBtn1" onclick="generateStoryClick()">gener8🎬</button> -->
         <button id=expandCollapseBtn6 class="expandCollapseBtn1" onclick="storyzExpandCollapseClick()">🕸️</button>
         <span class="boxTitle">🌪️ 
            <span style="font-size:0.777em; color:cyan">6</span>
          <span style="font-size:0.555em">Generate</span>
          <span style="font-size: 1.222em;color:cyan;font-family: monospace;">Reviews & Previews</span>
          <span style="font-size:0.555em">🎬(storyz)🛠️</span>
         </span><br>
         <article style="font-size:0.777em;font-family: sans-serif;line-height:2.222em;">
            <hr> 
            <section id="storyzFRAME"></section>
            <hr> 
            <button id="storyzDeleteBtn6" class="delBtn2" style="font-size: 1em;" onclick="storyzDeleteClick(event)">🗑️</button> 
            <button id="storyAddStoryzBtn6" class="genReportBtn1" style="font-size: 0.888em;" onclick="addStoryBOXClick(event)">addStoryz🐜🍄</button> 
      </section>
      <section id="historyBOX"
        style="width:80%;flex:1; background: #010301; border-radius: 13px; border: solid 1px darkgreen; box-shadow: 0px 7px 20px 0px #029e4a;
        padding: 2%; padding-left:4%; padding-top: 3%; color: cyan; line-height: 2.444em;">
        <!-- <button id="generateProfitBtn" class="genReportBtn1" onclick="generateProfitLossClick()">gener8🏰</button> -->
        <button id=expandCollapseBtn7 class="expandCollapseBtn1" onclick="totalzExpandCollapseClick()">🕸️</button>
        <span class="boxTitle">🌊 
         <span style="font-size:0.777em; color:cyan">7</span> 
        <span style="font-size:0.555em">Generate</span>
        <span style="font-size: 1.222em;color:cyan;font-family: monospace;">
         Profit/Loss/Tax</span>
         <span style="font-size:0.555em">🚦(reports)🚨</span>
         </span></span><br>
        <article style="font-size:0.777em;">
         <hr>   
         Profit & Loss:
         <section id="generatedProfitsBOX"></section>
         <hr>   
         Tax Calculations:<br>
         Tax_Max: <i>everything 25%</i> - tax-loss-harvesting (later)
         <hr>     
         Analytics:<br>
         <i>ai charts (later)</i>
         <hr>     
       </article> 
      </section>
      <section id="instructionBOX"
        style="width:80%; flex:1;padding: 1% 2% 1% 2%;
        background: #000815; font-size:0.777em;
        border-radius: 13px; border: solid 1px steelblue; box-shadow: 0px 7px 20px 0px #026767;
        color: steelblue; line-height: 3.222em;
    font-family: verdana; font-size: 0.888em;     font-weight: bold;
        ">
        <button id="openBtn1" class="genReportBtn1" style="margin-top: 1em;" onclick="openBtnClick()">show💠</button>        
        <span class="boxTitle">💡 Instructions:</span><br>
      <article id="instructionText">
        <hr>   
        Generate Worksheet, Generate Schedule, Generate Reports.
        <hr><br><hr>  

        Accordion Design pattern Financial ledger
        
        and Trade Tracking System. 
        
        With ai Methodology and ai data 
        
        for dynamic ai charts.

        # STEPS

        1. ADD numbers QUARTERLY and MONTHLY as WORKSHEET input.

        2. GENERATE REPORT metadata, 

        3. COMPARE against schedule for QUARTERLY and MONTHLY

        4. Try to see clear distinction between
        
        AXIOMS

        - do not fight fed
        - trust the TREND, while rates and cuts play.
        - seachange pivot to cut.
        - historic analysis 1995
        - aggressive 6 months into 1st cut.
        - down 6 months after 1st cut.
        - H1 and H2 in addition to Q1,Q2,Q3,Q4
        - Look at early_cycle late_cycle playbook.
        - softlanding confirmed by Q1 disinflation data and rates.
        - risk reward analysis. profit_system.


         RULES:
         DETERMINE MARKET MID, HI, LO.
         Important change of behaviors for HI or LO.
         HI_MARKET = LOWER_CAPS. TRIM_TOP. SMALLER PADS. Avoid hidry greed fomo.
         LO_MARKET = HIGHER_CAPS. PAD_LOW, LARGER PADS. Avoid freeze fear fogl.

        - buyRED or cutLOSS
        
        - upsideHEDGE or hidry bet.

       - TRIM_CAPS at TOP, PAD_CAPS at BTM. (52WKHI, 52WKLO)

         - TRIM_CAPS_TOP @ 52WKHI
         - PAD_CAPS_BTM  @ 52WKLO

        - TRIM_HIGHER_HIGHS and PAD_LOWER_LOWS

        - place alerts on BUY_RED and SELL_GREEN.

        - sellGREEN or rideBULL, DOWNLIMITLOSS UPLIMITTRIM

        - PRESSUP  PRESSDOWN, TRIMUP, TRIMDOWN.

        <hr><br><hr>
        # CAP STRATEGY

        Really nice and simple way to limit risk, schedule acts, and bank profits.

        In correction and downturn - level up positions - to new CAPS.

        Then on return sideways and bull market - bank at 10% increments.

        Keeping the CAPS the whole way.

        3 strike pad limit on all CAPS. to catch lows... 3 times.

        On Crash - level up positions. Example from 500 to 1000 or 2000 to 3000.

        Trim = 0 is beginning of crash.

        During Crash bottom is half down last bull run.

        Add new LEVEL each LEG DOWN CRASH.

        LEVEL LIMIT is also 3 strikes. 1, 2, 3. Graduated amounts 500, 500, 1000.

        REVIEW SCHEDULE each month on 1st - largest position on largest gainers?
        RESET LIMITS only in downturn. SIGNAL.
        BOLLINGER and RSI and VIX OVERSOLD. Fearful VOLUME RED FLUSH.
        HALF Prior Run.
        <hr><br><hr>
         # ACTS

         buyHOLD, sellSAFE, cutLOSS, buySPOT, sellSPOT

         #risk_on snap  robinhood  roblox

         #DIVERSIFY MU, V, PINS, HOOD, Z, and FIRSTSOLAR. CRYPTO

        #Trigger PAD SEQUENCE if:
            - 10% off YRHi
            - Bollinger Band Retrace
            - RSI Low - VIX Hi
            - Mean Inversion, - Uncertainty in air.
            TRIGGER_TOP_CASHOUT - top_liquidation. Tax write off, REPOS, if:
            - dogs are up from bottom, anywhere near break even.
            TRIGGER_REPOS
            TRIGGER_LOW_CASHOUT - liquidation on loss of interest or insight.
            - also it is important to cashout before deathmarch. 
            - because that money elsewhere, is worth the loss.

         <hr><br><hr>
        # PRINCIPLE_BASIS TRADES.

        11/14/2023 - clear equity rally vs crypto decline.
        if bitcoin becomes negative correlated to stocks
        trimming stocks at top, and buy crypto, for 
        reversal flight_to_safety sell crypto going down,
        for bottom of recession or decline, next bull run.
  
        RULE: only make PRINCIPLE moves at BOTTOM.
  
        11/14/2023 - growth levels on MDB, mirrors NVDA.
        LOOK for MDB and NVDA to be OVERBOUGHT boll.
        And switch from GROWTH to TRIM (at higher principle)
        TRIM_TGT: MDB 2,000_BAL and NVDA 5,000_BAL
        TRIM_TGT: MDB & NVDA upper boll band.
        TRIM_TGT: BANK_10% (2,000), then BANK_20% on TRIM_TOP. 
        CRASH_TGT: After all Pads used, and still down. 
        Set new POSITIONS DURING CRASH: 500, 500, 1000.
        EARLY_TRIM:MDB,AMD,MSFT,GOOG
        MID_TRIM:XLK,NDAQ,GOOG
        LATE_TRIM:
        PAD_LIMIT: 1,000_TOT_MONTH
        CRASH_LIMIT: 10_POSITION_PRESS_QUARTER
        PRINCIPLE-FOCUS METHOD.
        GROWTH_TGT - move to higher principle
        TRIM_TGT   - pull 100's off the top.
        SAFE_TGT - intended to not decline
        PAD_TGT: New_Lower_Low
        TRIM_TGT: New_Higher_High
        SAFE_TGT: BANK_PROFITS in very good times.
        - we do not want safe targets at the top. we want cash.
        - we want safe targets at toward the bottom, then growth.
        - Bear Rally great for returns.

        Quarterly and Monthly Limits. 
        
        - 10SPOT_LIMIT: 1000 per month max, 
        
        - 10, 100 SPOT_LIMIT. Per month.

        This financial tool uses NATURAL LANGUAGE PROCESSING to solve that.

        <hr><br><hr>

        # Technical description (ai)

        Ai encode/decode algorithms, to generate, a schedule, 
        of probabilistic states, with spot nlp, 
        and trades tracking with metadata.

        As scheduled routine, set EXPECTATIONS,
        and REVIEW on a MONTHLY and QUARTERLY basis.
        Specificallly, at times of tax review (quarterly),

        An overall report is generated, where NLP tokens,
        are used to generate visual charts of market_state.

        <hr><br><hr>
        # MONTHLY and QUARTERLY VISUALS of all spots:
        sideways, inGREEN, inRED.

        Ticker input is encoded, with spot input, and a 
        schedule of how it compares to static conditions,
        is generated.

        Static Conditions are like all time high, all time low,
        52 week high, 52 week low, quarterly high, quarterly low.
        Also computed, % off of ATH, and recency of ATH, as 1,2,3 months.
        
        LAST-WEDNESDAY (day before last THURSDAY) put in a GUESS and REAL.

        <hr><br><hr>
        QUARTERLY HiGH/LOWS (QHL) and MHL (monthly high lows.) 
        - monthHIGH, monthLOW, quarterHIGH, quarterLOW, yearHIGH, yearLOW
        <hr>
         This tool is designed to help solve a few common problems 
         in a financial ledger. Over and over, similar patters appear.
         Below are those patterns.
         Along with the strategy to classify each.
         In advance of defining probabalistic state.
         To then trigger articulated response and note keeping.

         <hr><br><hr>
        # Patterns of all possible probability.

         - sold too much, thinking it would go down - but it went way up.
         - sold correctly, before it tanked.
         - bought correctly, before it went way up. didnt buy enough.
         - bought and it tanked. Should've bought less, or not at all.
      
         As SPOT patterns:
         - upside hedge spots: put in more, before a BULL. Climbing Stairs.
         - downside buy spots: put in more, in expected CORRECTION. 
            Try to time the bottom of a Market Downturn.
         - rebalance spots: cut loss and move to better percentage spots.
         - upside sell profit spots: try to time the top.

         Formula:
         The prime determination of successful investment is ROI.
         So % ROI is a key metric, among other statistics.
         The state of each SPOT changes, based on TIME and %ROI
         <hr><br><hr>
         EXAMPLE:
         A spot that is down 10% - 1 week after purchase - still has TIME.
         But a spot down 10% - years after purchase - is very bad.
         <hr><br><hr>
         Another EXAMPLE:
         A stock that had a huge run, is only cash - as booked_profit.
         So trimming strategically is required to get returns.
         Alternatively, a stock that has a huge run, but then returns
         to minimal profit (or loss) - years laters, is out of time.
         And is a dog. At that point the state changes from a stock
         that still has time_to_turnaround, or a dog, that needs to 
         cut_loss and rebalance risk off into better profit_margin spots.
         <hr><br><hr>
         Strength and volume
         check low rsi on buy, And
         check for high selling volume as climax (low buys) sellers tapped out.
         check high rsi on sell, And
         check for high buying volume as climax (low sells) buyers tapped out
         check vix for climax of fear or greed. 
         VIX_INFLOW (greed,hype,fomo) VIX_OUTFLOWS(fear,risk,uncertainty)
         <hr><br><hr>
         Another Example:
         Biggest spots for heighest weighted probabilities.
         Smaller spots for less certain probabilities.
         Calculate TREND LENGTH, days above MA:100,200
         <hr><br><hr>
         Another Example:
         fallback to half of bull run - a year later.
         Need to see end of bull.
         Need to see end of bear.
         <hr><br><hr>
         FUD FOMO CASHOUT or CASHIN
         <hr><br><hr>
         Seasonality:
         buy halloween, sell thanksgiving
         <hr><br><hr>
         Bad comps
         last years numbers skewed.
         <hr><br><hr>
         Topics in news, SELLNEWS or BUYNEWS
         CATALYST EVENT_ON and EVENT_OFF
         have an input for topics in the news such as
         beginning or ending of wars, raising or lowering of interest rates,
         last thursday of the month (bustshort, bustputs).
         Or Earnings - how to opposite_respond - earnings calls?
         <hr><br><hr>
         ANALYTICS:
         - days_sideways
         - days_red
         - days_green
         - %_green
         - %_red
         <hr><br><hr>
         GOAL2GO
         GOAL to make in a YEAR, Goal to make in Quarter, 
         Goal to make in month
         Goal to make in week, goal to make in day.
         <hr><br><hr>
         VISUALIZATIONS:
         Graphs and charts for ticker over time, to show state.
         With Natural Language Processing parameters.
         To trigger various prescribed strategy.
         <hr><br><hr>
         Over TIME durations: 
         - stock goes up mild 10% 20% 
         - stock goes up hot  50%, 100% 500%
         - stock stays flat +- 10% range 
         - stock is cold -10% 20%
         - stock is dog.
         <hr><br><hr>
         FORCAST:
         select box: up middle down - then result.
         And set reactions on results.
         Example: every 20% up sell 10% 
         or 1/3 up, sell 1/4.
         <hr><br><hr>
         ## NLP Classification mechanism

         More animated pattern recognitions.
         hot-bull, mild-bull, mild-bear, hot-bear.
                  
         NLP parameters for the SPOTS, 
         top-out, dip, correction, retracement, head and shoulders.
         upside-hedge, seeking-bottom,
         pruning-top, rebalance-out, rebalance-in.
         % to point. Like % to go under water.
         And total trade-profits, with total-red positions,
         And total-green positions.
         <hr><br><hr>
         Quarterly_Market_Narratives:
         - higher for longer - geo-political risks
         - taboo 10yr over 5% - weakened consumer
         - consumer stimulus pullback
         NEGATIVE_TO_POSITIVE shift
         POSITIVE_TO_NEGATIVE shift
         NEW_NEGATIVE
         NEW_POSITIVE
         UPSIDE_SURPRISE
         DOWNSIDE_SURPRISE
         <hr><br><hr>
         LITMUS_STOCKS. TRENDS_TO_WATCH
         COSTCO and WMT to read CONSUMER_RISK
         GOOGLE and MICROSOFT for TECH GROWTH
         MDB and AMD and NVDIA for AI GROWTH
         QQQ XLK and SPX for Industry_Trends
         STATE_CHANGES: 
         HOOD moves from watch to risk_on or
         HOOD moves from watch to cutloss.
         
         <hr><br><hr>
         KEY_POINT_INDICATOR_worksheet:
         10yr 5% interest rates
         200 day moving average bounce to ATH or return
         breach of 100 day, 200day.
         breach of 10% up ytd
         breach of 20% up ytd
         RSI and Market sentiment fear_greed_index
         S&P500 4500
         Russel 200 turnaround
         <hr><br><hr>
         HISTORIC_DATA_MATRIX
         latest_price
         new_ath 
         new_high_quarter, new_low_month
         new_low_quarter, new_low_month
         month_spot, quarter_spot, ytd_spot
         resistance_support_ranges
         
         <hr><br><hr>

         With expectations as,
         Expecting_bull, expecting_bottom.

         Weighted probabilities, change actions on stocks,
         based on path that stocks take, over time.

         Where increasing time, increases weighted probability,
         of correctness of classification.

         Quarterly Story: buzzwords: 'higher for longer', 'quantitative easing'
         etc.
          
         TrimSpot: 1,2,3,4...: 10%, date, margin.
         PressSpots 1,2,3,4...: avg_price, date

         RISK_ON, RISK_OFF.
         NLP: Nomenclature,Taxonomy,Ontology,Index,FoundationModel.
         HeadWind, TailWind.
         <hr><br><hr>
         Forcast Dashboard: 
         what if it breaks out (earning beat) +10%
         - what if it tanks 10%?
         - what if sideways for quarter?
         <hr><br><hr>
         Analytic display.
         Individual Spot Profit/Loss.
         SpotFamily Profit/Loss.

         LAST_DAY, FIRST_DAY.
         - input data on the last day and first day of data every month.
         - put a reminder on phone. along with last thursday.
         - SET NEW upper band and lower band RANGE ALERTS! - every month.
         - 10% and 20% (mid moves and big moves) 

         <hr><br><hr>
         RULES:
         buy_red_support 🔴⚠️
         sell_green_resistance,🚀
         detect & respect market waves.🌊

      </article>

      </section>


   </article>

    <!-- <menu style="display:flex;justify-content:space-evenly;background: #182b3d;
        border-radius: 30px;margin:0;padding:0;margin-bottom:-6px;
        box-shadow: inset -5px 7px 8px 0px #472c88;">
        <button class="subMenuBtn" onclick="undoFn()">↶undo</button>
        <button class="subMenuBtn" onclick="titlelineFn()">#️⃣title</button>
        <button class="subMenuBtn" onclick="numberlineFn()">🔢1.2.3.</button>
        <button class="subMenuBtn" onclick="endlineFn()">🔣.,_?!</button>
        <button class="subMenuBtn" onclick="quotelineFn()">*️⃣quote</button>
    </menu> -->
      <footer id="appFooter" style="display:flex;justify-content:space-evenly;width:90%;margin:0 auto; 
      margin-bottom:0.666%; flex: 0 0 auto;    margin-top: 0.555em;
      background-image: linear-gradient(grey, steelblue, black);
      box-shadow:0 0 14px 0px steelblue;border-radius:13px;">
       <button onclick="copyLedgerFn()" class="btmBtns1" style="border-radius:8px;background:grey;
          cursor:pointer;box-shadow: inset -1px -1px 4px 1px gold;">
          <span style="border-radius:100%;background:gold;border:1px solid grey;">
            💾</span> <span class="btnTXT hoverTXT">LEDGER</span>
       </button>
       <button onclick="copyHistoryFn()" class="btmBtns1" style="border-radius:8px;background:grey;
          cursor:pointer;box-shadow: inset -1px -1px 4px 1px orangered;">
          <span style="border-radius:100%;background:orangered;border:1px solid grey;">
            📋</span> <span class="btnTXT hoverTXT">HISTORY</span>
       </button>
       <button onclick="copyMainFn()" class="btmBtns1" style="border-radius:8px;background:grey;
          cursor:pointer;box-shadow: inset -1px -1px 4px 1px orangered;">
          <span style="border-radius:100%;background:orangered;border:1px solid grey;">
            📋</span> <span class="btnTXT hoverTXT">MAIN</span>
       </button>
      <button onclick="copyScheduleFn()" class="btmBtns1" style="border-radius:8px;background:grey;
         cursor:pointer;box-shadow: inset -1px -1px 4px 1px rgb(51, 153, 109);">
         <span style="border-radius:100%;background:rgb(51, 153, 99);border:1px solid grey;">
            🍧</span> <span class="btnTXT hoverTXT">CAPS</span>
      </button>
      <button onclick="copyMilestonesFn()" class="btmBtns1" style="border-radius:8px;background:grey;
         cursor:pointer;box-shadow: inset -1px -1px 4px 1px rgb(51, 87, 153);">
         <span style="border-radius:100%;background:rgb(51, 88, 153);border:1px solid grey;">
            🍬</span> <span class="btnTXT hoverTXT">EVENTS</span>
      </button>
      <button onclick="copyStoryzFn()" class="btmBtns1" style="border-radius:8px;background:grey;
         cursor:pointer;box-shadow: inset -1px -1px 4px 1px rgb(68, 51, 153);">
         <span style="border-radius:100%;background:rgb(61, 51, 153);border:1px solid grey;">
            🎈</span> <span class="btnTXT hoverTXT">STORY</span>
      </button>
       <button onclick="resetAllFn()" class="btmBtns1" style="border-radius:8px;background:grey;
          cursor:pointer;box-shadow: inset -1px -1px 4px 1px rebeccapurple;">
          <span style="border-radius:100%;background:rebeccapurple;border:1px solid grey;">
            🎡</span> <span class="btnTXT hoverTXT">RESTART</span>
       </button>
      </footer>
      <legal style="color:darkslategray;font-size: 0.666em;">copyright 2020-2023 netcinematics llc, all rights reserved.
        this is a personal ledger system, not financial advice. 
        Not for day trading use, but quarterly review. Technical Research, of ai experiment to generate actual_intelligence from artificial-intelligence.
      </legal>
<script>
   const currentDate = new Date();
   const yearNUM = currentDate.getFullYear();
   const monthNUM = (currentDate.getMonth() + 1).toString().padStart(2, '0'); // Adding 1 because months are zero-indexed
   const dayNUM = currentDate.getDate().toString().padStart(2, '0');
   const current_ymd = `YMD_${yearNUM}_${monthNUM}_${dayNUM}`;
   // const current_date = formatYMD(); //gives YMD clean format.
   const qtrNUM = (monthNUM==='01'||monthNUM==='02'||monthNUM==='03')?1:
   (monthNUM==='04'||monthNUM==='05'||monthNUM==='06')?2:
   (monthNUM==='07'||monthNUM==='08'||monthNUM==='09')?3:4;
   const monthSHORT = (monthNUM==='01')?'JAN':
   (monthNUM==='02')?'FEB':(monthNUM==='03')?'MAR':
   (monthNUM==='04')?'APR':(monthNUM==='05')?'MAY':
   (monthNUM==='06')?'JUN':(monthNUM==='07')?'JUL':
   (monthNUM==='08')?'AUG':(monthNUM==='09')?'SEP':
   (monthNUM==='10')?'OCT':(monthNUM==='11')?'NOV':'DEC';

   let keyBOX = document.getElementById('keyBOX');
   let keyINPUT = document.getElementById('keyINPUT');
   let symbolINPUT = document.getElementById('symbolINPUT');
   
   let stateConnectedBox = document.getElementById('ConnectedBox');
   let stateNotConnectedBox = document.getElementById('notConnectedBox');

   let encodeBOX = document.getElementById('encodeBOX');
   let encodeDATA = document.getElementById('encodeDATA');
   let decodeBOX = document.getElementById('decodeBOX');
   let decodeSPOTZ = document.getElementById('decodeSPOTZ');
   let scheduleBOX = document.getElementById('scheduleBOX')
   let QuickBOX = document.getElementById('QuickBOX')
   let allMarginsBOX = document.getElementById('allMarginsBOX')
   let reviewPreviewBOX = document.getElementById('reviewPreviewBOX')
   let padSequenceBOX = document.getElementById('padSequenceBOX')

   let saveBtn0 = document.getElementById('saveBtn0');
   let saveBtn03 = document.getElementById('saveBtn03');
   let saveTickBtn1 = document.getElementById('saveTickBtn1');
   let saveSpotBtn1 = document.getElementById('saveSpotBtn1');
   let saveScheduleBtn1 = document.getElementById('saveScheduleBtn1');
   let evtzSaveBtn5 = document.getElementById('evtzSaveBtn5');

   let generatedScheduleBOX = document.getElementById('generatedScheduleBOX');         
   let generatedQuickBOX = document.getElementById('generatedQuickBOX');         
   let generatedProfitsBOX = document.getElementById('generatedProfitsBOX');
   let generatedMarginsBOX = document.getElementById('generatedMarginsBOX');
   let generatedPreviewBOX = document.getElementById('generatedPreviewBOX');         
   let eventzFRAME = document.getElementById('eventzFRAME');         
   let storyzFRAME = document.getElementById('storyzFRAME');         

   let detailsBtn1 = document.getElementById('detailsBtn1');
   let detailsBtn2 = document.getElementById('detailsBtn2');
   let totalsBtn1 = document.getElementById('totalsBtn1');
   let totalsBtn2 = document.getElementById('totalsBtn2');
   let openBtn1 = document.getElementById('openBtn1');
   
   //EXPANDCOLLAPSE
   let expandCollapseBtn0 = document.getElementById('expandCollapseBtn0');
   let expandCollapseBtn1 = document.getElementById('expandCollapseBtn1');
   let expandCollapseBtn2 = document.getElementById('expandCollapseBtn2');
   let expandCollapseBtn3 = document.getElementById('expandCollapseBtn3');
   let expandCollapseBtn4 = document.getElementById('expandCollapseBtn4');
   let expandCollapseBtn5 = document.getElementById('expandCollapseBtn5');
   let expandCollapseBtn6 = document.getElementById('expandCollapseBtn6');
   let expandCollapseBtn7 = document.getElementById('expandCollapseBtn7');

   //FINANCIAL - ANALYTICS - CALCULATIONS
   let target_SYMBOL = 'NVDA';
   let daily_data = null;
   let monthly_data = null;
   let calculate_ATH = 0;
   let calculate_ATL = 0;
   let current_PRICE = 0;

/************************************************\
 * - ai_ledger_MATRIX
 *  - ability to save quarterly NOTES in localstorage
\************************************************/
let ai_ledger=null;
const ai_ledger_LOAD_MOCK_DATA=()=>{ //READ
   ai_ledger = {"ticks":[{"tick":"NVDA","price":"474","ath":"505","ath_ymd":"2023_08_31","price_ymd":"2023_12_11"},{"tick":"MDB","price":"381","ath":"569","ath_ymd":"2021_09_19","price_ymd":"2023_12_11"},{"tick":"MSFT","price":"373","ath":"371","ath_ymd":"2023_07_14","price_ymd":"2023_12_11"},{"tick":"GOOGL","price":"134","ath":"150","ath_ymd":"2021_11_19","price_ymd":"2023_12_11"},{"tick":"QQQ","price":"392","ath":"400","ath_ymd":"2021_11_19","price_ymd":"2023_12_11"},{"tick":"XLK","price":"186","ath":"182","ath_ymd":"2023_07_18","price_ymd":"2023_12_11"},{"tick":"COIN","price":"147","ath":"105","ath_ymd":"2023_07_14","price_ymd":"2023_12_11"},{"tick":"V","price":"255","ath":"250","ath_ymd":"2023_09_13","price_ymd":"2023_12_11"},{"tick":"COST","price":"611","ath":"596","ath_ymd":"2022_04_08","price_ymd":"2023_12_11"},{"tick":"AMD","price":"129","ath":"130","ath_ymd":"2023_06_12","price_ymd":"2023_12_11"},{"tick":"TSLA","price":"243","ath":"300","ath_ymd":"2022_09_15","price_ymd":"2023_12_11"},{"tick":"META","price":"333","ath":"341","ath_ymd":"2023_11_22","price_ymd":"2023_12_11"},{"tick":"PINS","price":"34","ath":"46","ath_ymd":"2021_11_12","price_ymd":"2023_12_11"},{"tick":"FVRR","price":"26","ath":"46","ath_ymd":"2023_02_02","price_ymd":"2023_12_11"}],
   "spots":[{"tick":"NVDA","amount":"100","spot_at":"486","ymd":"2023_11_22","role":"WATCH"},{"tick":"NVDA","amount":"200","spot_at":"494","ymd":"2023_11_17","role":"LONG"},{"tick":"NVDA","amount":"200","spot_at":"412","ymd":"2023_10_20","role":"LOrLO"},{"tick":"NVDA","amount":"300","spot_at":"459","ymd":"2023_10_10","role":"LONG"},{"tick":"MDB","amount":"200","spot_at":"333","ymd":"2023_09_21","role":"WATCH"},{"tick":"V","amount":"200","spot_at":"232","ymd":"2023_10_24","role":"HOLD"},{"tick":"GOOGL","amount":"500","spot_at":"130","ymd":"2023_09_29","role":"TRIM"},{"tick":"QQQ","amount":"500","spot_at":"370","ymd":"2023_11_09","role":"TRIM"},{"tick":"XLK","amount":"300","spot_at":"168","ymd":"2023_09_18","role":"TRIM"},{"tick":"MSFT","amount":"100","spot_at":"330","ymd":"2023_10_26","role":"HOLD"},{"tick":"MSFT","amount":"200","spot_at":"316","ymd":"2023_10_02","role":"TRIM"},{"tick":"AMD","amount":"200","spot_at":"102","ymd":"2023_10_02","role":"LONG"},{"tick":"TSLA","amount":"100","spot_at":"235","ymd":"2023_11_30","role":"PAD"},{"tick":"FSLR","ymd":"2023_11_30","role":"WATCH"},{"tick":"AMZN","ymd":"2023_11_30","role":"WATCH"},{"tick":"META","amount":"100","spot_at":"326","ymd":"2023_11_30","role":"PAD"}],
   "asset_expanded":false,"spot_expanded":false,"margin_expanded":false,
   "caps_expanded":false,"eventz_expanded":false,"totalz_expanded":false,"quick_expanded":false
   }   
}
const ai_ledger_init=()=>{ //READ from LOCAL STORAGE
   ai_ledger = (localStorage.ai_ledger)?
      JSON.parse( localStorage.ai_ledger ):null;
   // ai_ledger = null; //DEV: load mock data
   if(!ai_ledger){
      ai_ledger_LOAD_MOCK_DATA();
   }
}; ai_ledger_init();

let initEncode = ()=>{
   console.log('load ai_ledger');//populate encode table
   let encodeRow,tick1,priceData1,priceDate1,priceBOX1;
   let athData1,athDate1,athBOX1,del1,btn1 = null;
   let encodeNUMBOX1,encodeCHECKBOX1,encodeSelect1;
   let uniqueMAP={};
   encodeDATA.innerHTML=''; //blank out reload.
   if(ai_ledger.asset_expanded){
      expandCollapseBtn1.innerHTML = '💨'
      for(var i=0; i<ai_ledger.ticks.length;i++){
         if(uniqueMAP[ai_ledger.ticks[i].tick]){continue;}
         encodeRow = document.createElement('article')
         encodeNUMBOX1 = document.createElement('aside')
         encodeNUMBOX1.classList.add('encodeNUMBOX1')
         encodeCHECKBOX1 = document.createElement('label')
         encodeCHECKBOX1.classList.add('checkboxFrame') //encodeNUMBOX1
         encodeNUMBOX1.innerHTML=i+1;            
         encodeSelect1 = document.createElement('input')
         encodeSelect1.type = "checkbox";
         encodeSelect1.classList.add('tkr_checkmark')
         encodeCHECKBOX1.appendChild(encodeSelect1)
         encodeCheckMark1 = document.createElement('span')
         encodeCheckMark1.classList.add('checkmark')
         encodeCHECKBOX1.appendChild(encodeCheckMark1)
         encodeNUMBOX1.appendChild(encodeCHECKBOX1)
         priceBOX1 = document.createElement('aside')
         athBOX1 = document.createElement('aside')
         priceBOX1.innerHTML = "close $&nbsp;"
         athBOX1.innerHTML = "ath&nbsp;"
         tick1 = document.createElement('input')
         priceData1 = document.createElement('input')
         priceDate1 = document.createElement('input')
         athData1 = document.createElement('input')
         athDate1 = document.createElement('input')
         btn1 = document.createElement('button')
         del1 = document.createElement('button')
         del1.innerHTML = '🗑️'
         del1.classList.add('delBtn1')
         del1.setAttribute('data-arg1',i)
         del1.addEventListener('click',(e)=>{
            deleteTickerClick(e.target.getAttribute('data-arg1'))})
         btn1.innerHTML = 'gener8⚡'
         tick1.value = ai_ledger.ticks[i].tick.toUpperCase();
         tick1.readOnly = false;
         tick1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         athData1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         athDate1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         priceData1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         priceDate1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         priceData1.placeholder = "$0";
         priceDate1.placeholder = "yyyy_mm_dd";
         priceData1.value = ai_ledger.ticks[i].price || '';
         priceDate1.value = ai_ledger.ticks[i].price_ymd || '';
         athData1.placeholder = "$0";
         athData1.value = ai_ledger.ticks[i].ath || '';
         athDate1.placeholder = "yyyy_mm_dd";
         athDate1.value = ai_ledger.ticks[i].ath_ymd || '';
         tick1.classList.add('genTicker1')
         priceData1.classList.add('tkrPriceData1')
         priceDate1.classList.add('tkrPriceDate1')
         priceBOX1.classList.add('tkrPriceBOX1')
         athData1.classList.add('tkrATHData1')
         athDate1.classList.add('tkrATHDate1')
         athBOX1.classList.add('tkrATHBOX1')
         btn1.classList.add('genBtn1')
         encodeRow.classList.add('genRow1')
         encodeRow.appendChild(encodeNUMBOX1)
         encodeRow.appendChild(tick1)
         priceBOX1.appendChild(priceData1)
         priceBOX1.appendChild(priceDate1)
         encodeRow.appendChild(priceBOX1)
         athBOX1.appendChild(athData1)
         athBOX1.appendChild(athDate1)
         encodeRow.appendChild(athBOX1)
         encodeDATA.appendChild(encodeRow)
         uniqueMAP[ai_ledger.ticks[i].tick] = ai_ledger.ticks[i];
      } //end loop
   } //end collapsed if
}; initEncode();

const initDecode = ()=>{
   let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11,role12;         
   let decodeRow1,date1,tick1,amountData1,amountBOX1,atData1,atBOX1;
   let btn1,roleBOX,roleData,decodeNUMBOX, decodeSelect1,decodeCHECKBOX1;
   decodeSPOTZ.innerHTML=''; //blank out reload.
   if(ai_ledger.spot_expanded){
      expandCollapseBtn2.innerHTML = '💨'
      for(var i=0; i<ai_ledger.spots.length;i++){
         decodeRow1 = document.createElement('article')
         decodeRow1.classList.add('decodeRow1')
         decodeNUMBOX1 = document.createElement('aside')
         decodeNUMBOX1.classList.add('decodeNUMBOX1')
         decodeCHECKBOX1 = document.createElement('label')
         decodeCHECKBOX1.classList.add('checkboxFrame') //decodeNUMBOX1
         decodeNUMBOX1.innerHTML=i+1;            
         decodeSelect1 = document.createElement('input')
         decodeSelect1.type = "checkbox";
         decodeSelect1.classList.add('spot_checkmark')
         decodeCHECKBOX1.appendChild(decodeSelect1)
         decodeCheckMark1 = document.createElement('span')
         decodeCheckMark1.classList.add('checkmark')
         decodeCHECKBOX1.appendChild(decodeCheckMark1)
         decodeNUMBOX1.appendChild(decodeCHECKBOX1)
         amountBOX1 = document.createElement('aside')
         atBOX1 = document.createElement('aside')
         atBOX1.innerHTML="@&nbsp;"
         roleBOX = document.createElement('aside')
         roleBOX.innerHTML="role&nbsp;"
         roleData = document.createElement('select')
         role1 = document.createElement('option')
         role2 = document.createElement('option')
         role3 = document.createElement('option')
         role4 = document.createElement('option')
         role5 = document.createElement('option')
         role6 = document.createElement('option')
         role7 = document.createElement('option')
         role8 = document.createElement('option')
         role9 = document.createElement('option')
         role10 = document.createElement('option')
         role11 = document.createElement('option')
         role12 = document.createElement('option')
         role1.value = "...";
         role2.value = "HOLD";
         role3.value = "WATCH";
         role4.value = "RISKOFF";
         role5.value = "LONG";
         role6.value = "TRIM";
         role7.value = "SAFE";
         role8.value = "RISKON";
         role9.value = "EXIT";
         role10.value = "PAD";
         role11.value = "LOrLO";
         role12.value = "HIrHI";
         role1.innerHTML = "...";
         role2.innerHTML = "HOLD";
         role3.innerHTML = "WATCH";
         role4.innerHTML = "RISKOFF";
         role5.innerHTML = "LONG";
         role6.innerHTML = "TRIM";
         role7.innerHTML = "SAFE";
         role8.innerHTML = "RISKON";
         role9.innerHTML = "EXIT";
         role10.innerHTML = "PAD";
         role11.innerHTML = "LOrLO";
         role12.innerHTML = "HIrHI";            
         roleData.appendChild(role1);
         roleData.appendChild(role2);
         roleData.appendChild(role3);
         roleData.appendChild(role4);
         roleData.appendChild(role5);
         roleData.appendChild(role6);
         roleData.appendChild(role7);
         roleData.appendChild(role8);
         roleData.appendChild(role9);
         roleData.appendChild(role10);
         roleData.appendChild(role11);
         roleData.appendChild(role12);
         roleData.value = ai_ledger.spots[i].role || '';
         roleBOX.appendChild(roleData)
         roleBOX.classList.add('roleBOX1')
         roleData.classList.add('roleData1')

         date1 = document.createElement('input')
         date1.value = ai_ledger.spots[i].ymd || '';
         date1.classList.add('decodeDate1')
         date1.addEventListener("keyup",(e)=>{
               saveSpotBtn1.style.display = 'block'; });
         tick1 = document.createElement('input')
         amountData1 = document.createElement('input')
         btn1 = document.createElement('button')
         del1 = document.createElement('button')
         del1.innerHTML = '🗑️'
         del1.classList.add('delBtn1')
         del1.setAttribute('data-arg1',i)
         del1.addEventListener('click',(e)=>{
            deleteSpotClick(e.target.getAttribute('data-arg1'))})            
            btn1.innerHTML = '✨Lock Profit/Loss💥'
            tick1.value = ai_ledger.spots[i].tick || '';
            tick1.readOnly = false;
            amountData1.placeholder = "start:$0";
            amountData1.value = ai_ledger.spots[i].amount || '';
         atData1 = document.createElement('input')
         atData1.placeholder = "$0";
         atData1.value = ai_ledger.spots[i].spot_at || '';
         tick1.addEventListener("keyup",(e)=>{
               saveSpotBtn1.style.display = 'block'; });            
         atData1.addEventListener("keyup",(e)=>{
               saveSpotBtn1.style.display = 'block'; });
         amountData1.addEventListener("keyup",(e)=>{
               saveSpotBtn1.style.display = 'block'; }); 
         roleData.addEventListener("change",(e)=>{
               saveSpotBtn1.style.display = 'block'; });
         roleBOX.value = ai_ledger.spots[i].role || '...';
                        
         tick1.classList.add('decodeTick1')
         amountBOX1.classList.add('spotamountBOX1')
         amountData1.classList.add('spotamountData1')
         atData1.classList.add('spotAtData1')
         atBOX1.classList.add('spotAtBOX1')
         btn1.classList.add('decBtn1')
         decodeRow1.appendChild(decodeNUMBOX1)
         decodeRow1.appendChild(date1)
         decodeRow1.appendChild(tick1)
         amountBOX1.innerHTML="$&nbsp;"
         amountBOX1.appendChild(amountData1)
         decodeRow1.appendChild(amountBOX1)
         atBOX1.appendChild(atData1)
         decodeRow1.appendChild(atBOX1)
         decodeRow1.appendChild(roleBOX)
         decodeSPOTZ.appendChild(decodeRow1)   
               
      }//end loop
   }//end collapsed if
}; initDecode();


let stock_api_key = null;//API_KEY - set in local storage.
let init_api_key = ()=>{
   //Does local storage have API_KEY?
   // if(!localStorage.stock_api_key){ //if no: display enter key
   //     stateConnectedBox.style.display = "none";
   //     stateNotConnectedBox.style.display = "inline";                   
   //     symbolBOX.style.display = "none";
   //     keyBOX.style.display = "inline";                   
   //     //SHOW NOT CONNECTED. Hide connected. Hide tgt show key input.
   // } else {//if yes init
   //     //SHOW CONNNECTED and tgt, hide disconnected and key input
   //     stateConnectedBox.style.display = "inline";
   //     stateNotConnectedBox.style.display = "none";   
   //     symbolBOX.style.display = "inline";
   //     keyBOX.style.display = "none"; 

   //     stock_api_key = (localStorage.stock_api_key)?localStorage.stock_api_key:'';
   //     //initLedger() 
   // }

//         if(!stock_api_key){return;}
//         // const apiKey = '';
//         const symbol = 'NVDA';
//         const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${symbol}&interval=5min&apikey=${stock_api_key}`;
//         fetch(apiUrl)
//         .then(response => response.json())
//         .then(data => {
//             // Process the data here (e.g., extract the latest stock price)
//             const latestPrice = data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]]['1. open'];

// //             data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]]['1. open'];
// // '175.3700'
// // data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]];
// // {1. open: '175.3700', 2. high: '175.3700', 3. low: '175.0000', 4. close: '175.0000', 5. volume: '24782'}
//             console.log(`Latest price for ${symbol}: ${latestPrice}`);
//         })
//         .catch(error => {
//             console.error('Error fetching data:', error);
//         });
}; //init_api_key();
let init_monthly = ()=>{
   // replace the "demo" apikey below with your own key from https://www.alphavantage.co/support/#api-key
   // var url = 'https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY_ADJUSTED&symbol=IBM&apikey=demo';
   if(!stock_api_key){return;}
   if(localStorage.monthly_NVDA_data){ //LOAD FROM LOCAL not API.
         monthly_data = JSON.parse(localStorage.monthly_NVDA_data);
         // let, val_ath=0,val_atl=0,curr_price=0,perc_off_ath=0;
         let data_keys = Object.keys(monthly_data);
         for(let i=0; i<data_keys.length;i++){
            daily_data = monthly_data[data_keys[i]];
            if(parseFloat(daily_data["2. high"]) > calculate_ATH){
               calculate_ATH = parseFloat(daily_data["2. high"])
            }
            if(parseFloat(daily_data["3. low"]) < calculate_ATL || calculate_ATL===0){
               calculate_ATL = parseFloat(daily_data["3. low"])
            }
         }
         console.log('ATH:',calculate_ATH)
         console.log('ATL:',calculate_ATL)
         console.log('Curr Price:', current_PRICE)
         console.log('%off ATH', perc_off_ath)
         return;
   }
   // const apiKey = '';
   // const symbol = 'NVDA';
   const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY_ADJUSTED&symbol=${target_SYMBOL}&apikey=${stock_api_key}`;
   fetch(apiUrl)
   .then(response => response.json())
   .then(data => {
         localStorage.monthly_NVDA_data = JSON.stringify(data["Monthly Adjusted Time Series"]);

   })
   .catch(error => {
         console.error('Error fetching data:', error);
   });
}; //init_monthly();

let setAPIKEY = ()=>{
   if(keyINPUT.value){
         stock_api_key = keyINPUT.value;
      //  localStorage.stock_api_key = stock_api_key
      getData_TestConnection();
      //  initLedger()
   }
}

const addTickerClick = ()=>{ 
   ai_ledger.asset_expanded = true;
   initEncode();
   // saveTickBtn1.style.display = 'block';
   let encodeRow,tick1,priceData1,priceDate1,athData1,athDate1,athBOX1,saveBtn2;
   encodeRow = document.createElement('article')
   priceBOX1 = document.createElement('aside')
   athBOX1 = document.createElement('aside')
   priceBOX1.innerHTML="now&nbsp;"
   athBOX1.innerHTML="ath&nbsp;"
   tick1 = document.createElement('input')
   priceData1 = document.createElement('input')
   priceDate1 = document.createElement('input')
   athData1 = document.createElement('input')
   athDate1 = document.createElement('input')
   saveBtn2 = document.createElement('button')
   tick1.value = "";
   tick1.readOnly = false;
   tick1.placeholder = "ticker";
   priceData1.placeholder = "$0";
   priceDate1.placeholder = "yyyy_mm_dd";
   athData1.placeholder = "$0";
   athDate1.placeholder = "yyyy_mm_dd";
   tick1.classList.add('genTicker1')
   tick1.style.margin='1em 0 1em 0';
   priceData1.classList.add('tkrPriceData1')
   priceDate1.classList.add('tkrPriceDate1')
   priceBOX1.classList.add('tkrPriceBOX1')
   priceData1.style.margin='1em 0 1em 0';
   priceDate1.style.margin='1em 0 1em 0';
   athData1.classList.add('tkrATHData1') //todo remove genATH1 and rename
   athDate1.classList.add('tkrATHDate1') //todo remove genATH1 and rename
   athBOX1.classList.add('tkrATHBOX1')
   athData1.style.margin='1em 0 1em 0';
   athDate1.style.margin='1em 0 1em 0';
   saveBtn2.innerHTML = 'save🌟'
   saveBtn2.classList.add('saveBtn2')
   saveBtn2.addEventListener("click",(e)=>{
      saveTickerClick() });
   athData1.addEventListener("keyup",(e)=>{
      saveTickBtn1.style.display = 'block'; });
   athDate1.addEventListener("keyup",(e)=>{
      saveTickBtn1.style.display = 'block'; });
   priceData1.addEventListener("keyup",(e)=>{
      saveTickBtn1.style.display = 'block'; });
   priceDate1.addEventListener("keyup",(e)=>{
      saveTickBtn1.style.display = 'block'; });
   encodeRow.classList.add('genRow1')
   encodeRow.appendChild(tick1)
   priceBOX1.appendChild(priceData1)
   priceBOX1.appendChild(priceDate1)
   encodeRow.appendChild(priceBOX1)
   athBOX1.appendChild(athData1)
   athBOX1.appendChild(athDate1)
   encodeRow.appendChild(athBOX1)
   encodeRow.appendChild(saveBtn2)
   // encodeRow.appendChild(del1)
   encodeDATA.appendChild(encodeRow)         
}
const saveTickerClick = ()=>{//loop elements, add data, localstorage
      saveTickBtn1.style.display = 'none';
      let items = encodeDATA.children,row,kids,kid;
      let tkr,price,ath,item=null;
      ai_ledger.ticks = []; //CLEAR LEDGER.
      for(var i=0; i<items.length;i++){ //LOOP DOM ROWS
      item = items[i];
      if(item.classList.contains('genRow1')){ //todo FORM remove btns
         kids = item.children;
         tkr = '';price='',ath='';//blank row.
         for(var j=0; j<kids.length;j++){ //LOOP ROW ITEMS
            kid = kids[j];
            if(kid.classList.contains('genTicker1')){
               kid.value = kid.value.toUpperCase();
               tkr = kid.value;
               continue;
            } if(kid.classList.contains('tkrPriceBOX1')){
               price = kid.children[0].value;
               // price_label = kid.innerHTML;
               price_ymd = kid.children[1].value;
               continue;
            } if(kid.classList.contains('tkrATHBOX1')){
               ath = kid.children[0].value;
               ath_ymd = kid.children[1].value;
               continue;                  
            }
         }
      }
      if(tkr){
         let tickObj = new Object();
         tickObj.tick = tkr;
         if(price){tickObj.price = price}
         if(ath){tickObj.ath = ath}
         if(ath_ymd){tickObj.ath_ymd = ath_ymd}
         if(price_ymd){tickObj.price_ymd = price_ymd}
         ai_ledger.ticks.push(tickObj)
      }
      }
      //SAVE to LOCAL STORAGE
      localStorage.ai_ledger = JSON.stringify(ai_ledger)  
      initEncode(); //RELOAD VIEW.         
   }
const saveSpotClick = ()=>{
      saveSpotBtn1.style.display = 'none';
      let items = decodeSPOTZ.children,row,kids,kid;
      let tkr,amount1,date1,role1,item,spot_at;
      ai_ledger.spots = []; //CLEAR LEDGER.  
      for(var i=0; i<items.length;i++){
      item = items[i];
      if(item.classList.contains('decodeRow1')){
         kids = item.children;
         tkr = '',amount1='',date1='',ath='';//blank row.
         for(var j=0; j<kids.length;j++){
            kid = kids[j];
            if(kid.classList.contains('decodeTick1')){
               kid.value = kid.value.toUpperCase();                     
               tkr = kid.value;
            } if(kid.classList.contains('decodeDate1')){
               date1 = kid.value;
            } if(kid.classList.contains('spotAtBOX1')){
               spot_at = kid.lastChild.value;
            } if(kid.classList.contains('spotamountBOX1')){
               amount1 = kid.lastChild.value;
            } if(kid.classList.contains('roleBOX1')){
               role1 = kid.lastChild.value;
            } 
         }
      }
      if(tkr){
         let spotObj = new Object();
         spotObj.tick = tkr;
         if(amount1){spotObj.amount = amount1}
         if(spot_at){spotObj.spot_at = spot_at}
         if(date1){spotObj.ymd = date1}
         if(role1){spotObj.role = role1}
         ai_ledger.spots.push(spotObj)
      } else { console.log('unsaved record',i) }
      } 
      //SAVE to LOCAL STORAGE
      localStorage.ai_ledger = JSON.stringify(ai_ledger) 
      initDecode(); //RELOAD VIEW.                      
   }
   const addSpotClick = ()=>{
      ai_ledger.spot_expanded = true;
      // saveSpotBtn1.style.display = 'block';
      let decodeRow1,date1,tick1,amountData1;
      let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11,role12;
      let saveBtn3,roleBOX,roleData,atBOX1,atData1;
      decodeRow1 = document.createElement('article')
      decodeRow1.classList.add('decodeRow1')
      atBOX1 = document.createElement('aside')
      atBOX1.innerHTML="@&nbsp;"
      roleBOX = document.createElement('aside')
      roleBOX.innerHTML="role&nbsp;"
      roleData = document.createElement('select')
      role1 = document.createElement('option')
      role2 = document.createElement('option')
      role3 = document.createElement('option')
      role4 = document.createElement('option')
      role5 = document.createElement('option')
      role6 = document.createElement('option')
      role7 = document.createElement('option')
      role8 = document.createElement('option')
      role9 = document.createElement('option')
      role10 = document.createElement('option')
      role11 = document.createElement('option')
      role12 = document.createElement('option')
      role1.value = "...";
      role2.value = "HOLD";
      role3.value = "WATCH";
      role4.value = "CUTLOSS";
      role5.value = "LONG";
      role6.value = "TRIM";
      role7.value = "SAFE";
      role8.value = "RISK_ON";
      role9.value = "EXIT";
      role10.value = "PAD";
      role11.value = "HIrHI";
      role12.value = "LOrLO";
      role1.innerHTML = "...";
      role2.innerHTML = "HOLD";
      role3.innerHTML = "WATCH";
      role4.innerHTML = "CUTLOSS";
      role5.innerHTML = "LONG";
      role6.innerHTML = "TRIM";
      role7.innerHTML = "SAFE";
      role8.innerHTML = "RISK_ON";
      role9.innerHTML = "EXIT";
      role10.innerHTML = "PAD";
      role11.innerHTML = "HIrHI";
      role12.innerHTML = "LOrLO";            
      roleData.appendChild(role1);
      roleData.appendChild(role2);
      roleData.appendChild(role3);
      roleData.appendChild(role4);
      roleData.appendChild(role5);
      roleData.appendChild(role6);
      roleData.appendChild(role7);
      roleData.appendChild(role8);
      roleData.appendChild(role9);            
      roleData.appendChild(role10);            
      roleData.appendChild(role11);            
      roleData.appendChild(role12);            
      roleBOX.appendChild(roleData)
      roleBOX.classList.add('roleBOX1')
      roleData.classList.add('roleData1')
      atData1 = document.createElement('input')
      atData1.placeholder = "$0";
      saveBtn3 = document.createElement('button')
      date1 = document.createElement('input')
      date1.value = current_ymd.split('YMD_')[1];//user display
      date1.classList.add('decodeDate1')
      tick1 = document.createElement('input')
      amountData1 = document.createElement('input')
      amountBOX1 = document.createElement('aside')
      athBOX1 = document.createElement('aside')
      amountBOX1.innerHTML = "$&nbsp;"
      athBOX1.innerHTML = "ath&nbsp;"
      athData1 = document.createElement('input')
      tick1.value = "";
      tick1.readOnly = false;
      tick1.placeholder="ticker"
      amountData1.placeholder = "0.00";
      athData1.placeholder = "+-:%";
      tick1.addEventListener("keyup",(e)=>{
         saveSpotBtn1.style.display = 'block'; });
      athData1.addEventListener("keyup",(e)=>{
         saveSpotBtn1.style.display = 'block'; });
      amountData1.addEventListener("keyup",(e)=>{
         saveSpotBtn1.style.display = 'block'; });                         
      tick1.classList.add('decodeTick1')
      saveBtn3.innerHTML = 'save🌟'
      saveBtn3.classList.add('saveBtn2')
      saveBtn3.addEventListener("click",(e)=>{
         saveSpotClick() });
      amountData1.classList.add('spotamountData1')
      amountBOX1.classList.add('spotamountBOX1')
      athData1.classList.add('spotATHData1')
      athBOX1.classList.add('spotATHBOX1')
      decodeRow1.appendChild(date1)
      decodeRow1.appendChild(tick1)
      amountBOX1.appendChild(amountData1)
      decodeRow1.appendChild(amountBOX1)
      // athBOX1.appendChild(athData1)
      atData1.classList.add('spotAtData1')
      atBOX1.classList.add('spotAtBOX1')
      atBOX1.appendChild(atData1)            
      decodeRow1.appendChild(atBOX1)
      decodeRow1.appendChild(roleBOX)
      decodeRow1.appendChild(saveBtn3)
      decodeSPOTZ.appendChild(decodeRow1)   
   }
   const deleteTickerClick = (idx)=>{
      if(idx>-1){
         ai_ledger.ticks.splice(idx,1); //remove item
         localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
         initEncode(); //RELOAD VIEW.                 
      }
   }
   const deleteSpotClick = (idx)=>{ //remove ledger item, save, refresh
   if(idx>-1){
         ai_ledger.spots.splice(idx,1); //remove item
         localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
         initDecode(); //RELOAD VIEW.                 
      }
   }

   const openBtnClick = ()=>{
      if(instructionText.style.display==='block'){
         instructionText.style.display='none'
      } else {
         instructionText.style.display='block'
      }
}

const deleteSelectedTicker = ()=>{
   let selected = [],temp=[];
   let items = document.getElementsByClassName('tkr_checkmark');
   for(let i=0; i<items.length;i++){
      if(items[i].checked){
         selected.push(i)
         items[i].checked = false;
      }
   }
   if(!selected.length){showErrorMSG(' Nothing selected 😵') 
      return;}         
   for(let idx=0; idx<ai_ledger.ticks.length;idx++){
      if(!selected.includes(idx)){ //not removed
         temp.push(ai_ledger.ticks[idx])
      } else {console.log('removed',idx)}
      // temp.ticks.splice(selected[idx],1); //remove item
   }
   ai_ledger.ticks = temp;
   localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
   initEncode(); //RELOAD VIEW.                 

}
const deleteSelectedSpot = ()=>{
   let selected = [], temp = [];
   let items = document.getElementsByClassName('spot_checkmark');
   for(let i=0; i<items.length;i++){
      if(items[i].checked){
         selected.push(i)
         items[i].checked = false;
      }
   }
   if(!selected.length){showErrorMSG(' Nothing selected 😵'); return;}         
   for(let idx=0; idx<ai_ledger.spots.length;idx++){
      if(!selected.includes(idx)){ //not removed
         temp.push(ai_ledger.spots[idx])
      } else {console.log('removed',idx)}
   }
   ai_ledger.spots = temp;         
   localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
   initDecode(); //RELOAD VIEW.                
}

const deleteSelectedSchedule = (event)=>{ //remove ledger item, save, refresh
   let capSelected = [], detSelected=[], temp = [], removeChildRow=false;
   // let items = document.getElementsByClassName('spot_checkmark');
   let capChecks = document.getElementsByName("scheduleCapsRadio");
   let detChecks = document.getElementsByName("scheduleDetailsRadio");
   for(let i=0; i<capChecks.length;i++){
      if(capChecks[i].checked){ //SORT THROUGH ai_schedule to delete data and reload
         capSelected.push(capChecks[i])
         let ymdt = capChecks[i].ymdt;
         let zArr = capChecks[i].ymdt.split('_')
         let tickCAP = zArr.pop();
         let ymd = zArr.join('_')
         let qtrCaps = ai_schedule.quarters[ymd].caps;
         let monthData = ai_schedule.quarters[ymd].monthData;
         for(var j=0; j<qtrCaps.length;j++){ //DELETE CAP DATA
            if( tickCAP === qtrCaps[j].tkr ){
               qtrCaps.splice(j,1) //remove data
               break;
            }
         }
         for(var k=0; k<monthData.length;k++){ //DELETE MONTH DATA
            if( tickCAP === monthData[k].tick ){
               monthData.splice(k,1) //remove data
               // break;
            }
         }
         //SAVE & RELOAD VIEW
         showErrorMSG('💗 Saved. ');
         localStorage.ai_schedule = JSON.stringify(ai_schedule) //SAVE to LOCAL STORAGE
         generateScheduleClick(); //RELOAD VIEW. 
         break;
      }
   }
   if(!capSelected.length && detChecks.length){ // DETAIL ROW SELECTION
      for(let j=0; j<detChecks.length;j++){
         if(detChecks[j].checked){
            detSelected.push(detChecks[j])
            let ymdtn = detChecks[j].ymdtn
            let zArr = detChecks[j].ymdtn.split('_')
            let itemNUM = zArr.pop();
            let tickCAP = zArr.pop();
            let ymd = zArr.join('_')
            let monthData = ai_schedule.quarters[ymd].monthData;
            // for(var k=0; k<monthData.length;k++){ //DELETE MONTH DATA
            if(monthData[itemNUM]){

               if( tickCAP === monthData[itemNUM].tick ){
                  monthData.splice(itemNUM,1) //remove data
               }
            }
            //SAVE & RELOAD VIEW
            showErrorMSG(' Saved💗 ');
            localStorage.ai_schedule = JSON.stringify(ai_schedule) //SAVE to LOCAL STORAGE
            generateScheduleClick(); //RELOAD VIEW. 
            break;
         }
      }
   } 
   if(!capSelected.length && !detSelected.length){showErrorMSG(' Nothing selected 😵'); return;}
} //end delete CAP fn

const generateProfitLossClick = ()=>{ // GENERATE PROFIT AND LOSS DISPLAY
   //PROFIT and LOSS View
   let keyz = Object.keys(ai_MetaData_TickMap);
   let bookValue = 0, bankValue=0,itm;
   let totMargin=0,totMarginPct,totMarginSum,totMarginBOX,totMarginPctBOX;
   generatedProfitsBOX.innerHTML=""
   if(ai_ledger.totalz_expanded){
      expandCollapseBtn7.innerHTML = '💨'      
      for(let idx=0; idx<keyz.length;idx++){
         itm=ai_MetaData_TickMap[keyz[idx]];
         bookValue += itm.total_val;
         bankValue += 3; //TODO sum SOLD PROFITS.

         if(itm.margin){ //CALCULATE TOTAL MARGIN
            totMargin += itm.margin;
         }
         totMarginSum += itm.margin_pct;
      }
      totMarginPct = totMarginSum/keyz.length;
      let totalsRow1,totBookValue1,totBankValue1;
      totBookValue1 = document.createElement('aside')
      totBookValue1.classList.add('totBookValue1')
      totBookValue1.innerHTML = 'book_value: '+bookValue;
      totMarginBOX = document.createElement('aside')
      totMarginBOX.classList.add('totMarginBOX')
      totMarginBOX.innerHTML = 'total margin: '+totMargin;
      totMarginPctBOX = document.createElement('aside')
      totMarginPctBOX.classList.add('totMarginPctBOX')
      totMarginPctBOX.innerHTML = 'total pct: '+totMarginPct;
      totBankValue1 = document.createElement('aside')
      totBankValue1.classList.add('totBankValue1')
      totBankValue1.innerHTML = 'bank_value: '+bankValue;//+ai_MetaData_TickMap[ticker.tick].sum_spot_amt || 0;                        
      totalsRow1 = document.createElement('footer')
      totalsRow1.innerHTML = "Totals:"         
      totalsRow1.classList.add('totalsRow1') 
      totalsRow1.appendChild(totBookValue1)         
      totalsRow1.appendChild(totMarginBOX)         
      totalsRow1.appendChild(totBankValue1)         
      generatedProfitsBOX.appendChild(totalsRow1) 
   }//end if collapsed
} 

      /*****************************************\
       * - end UI fns
      \****************************************/



      /*****************************************\
       * - ai_BANK functions
      \*****************************************/
      let ai_BANK = {
         "Q4_2023_OCT": {trxns:{pads:[],trims:[]}}
      }
  

//EVENTZ***********************************************
const addEVTZClick = (evtzID) =>{
   // saveEVTZClick();//FIX: save first for bug on double create row, keeps first row tickr.
   //go to parent quarter and add a unique row
   let newEVT = {}
   let evt = ai_eventz[parseInt(evtzID)-1];
   if(!evt){return}
   if(!evt.evtz){evt.evtz=[]}
      evt.expanded = true;
      newEVT.eID = evt.evtz.length+1;
      newEVT.qID = evt.qID;
      newEVT.title = evt.title;
      newEVT.ymd = evt.ymd;
      newEVT.type = evt.type;
      newEVT.tkr = evt.tkr;
      evt.evtz.push(newEVT)
         //SAVE to LOCAL STORAGE
         localStorage.ai_eventz = JSON.stringify(ai_eventz) 
      generateEVTZClick(); //RELOAD VIEW.  
      showErrorMSG('⛏ SAVED ⛏');     
}  

const saveNewMilestoneClick = (e)=>{ 
         //GET input value
         let qID = e.target.getAttribute('data-arg7')
         let tkr = e.target.parentElement.children[0].value
         let type = e.target.parentElement.children[1].children[0].value
         let ymd = e.target.parentElement.children[2].value
         if( !qID || !tkr || !type || !ymd){
            showErrorMSG('⚔️ ERR ⚔️');  
            return
         }
         let newMileStone = {}
         newMileStone.qID = qID
         newMileStone.tkr = tkr.toUpperCase();
         newMileStone.type = type
         newMileStone.ymd = ymd
         newMileStone.title = `${newMileStone.tkr}_${newMileStone.type}_${newMileStone.ymd}`
         ai_eventz.push(newMileStone)

         //SAVE to LOCAL STORAGE
         localStorage.ai_eventz = JSON.stringify(ai_eventz) 
         generateEVTZClick(); //RELOAD VIEW.  
         showErrorMSG('⚔️ ADDED ⚔️');          
      }

const setEVTZSaveClick = ()=>{ // SAVE EVENTZ
   evtzSaveBtn5.style.display = 'none'; 
   let evtzBoxes = document.getElementById('eventzFRAME').children
   let rowItem,kids,kid;
   let saveTGT;
   let evtTXT;
   let save_eventz = [], save_evt={};
   try{     
      for(var i=0; i<evtzBoxes.length;i++){ //LOOP QUARTER BOX
         evtBOX = evtzBoxes[i];
      if(evtBOX.classList.contains('eventzBOX')){
         kids = evtBOX.children;
         for(var j=0;j<kids.length;j++){ //ROW of EVENTZ LOOP
            kid = kids[j];
            save_evt = {}; //new object
            if(kid.classList.contains('eventzHeader')){ 
               evtTXT = kid.children[1].value.toUpperCase();
               saveTGT = {title:evtTXT}
               expand1 = (kid.children[2].innerHTML === '💨')? true : false;
               saveTGT.expanded = expand1;
               //GET EVENT
               for(let aa=0; aa<ai_eventz.length; aa++){
                  if(evtTXT===ai_eventz[aa].title){
                     saveTGT.qID = aa+1; //ai_eventz[aa].qID ||
                     saveTGT.tkr = ai_eventz[aa].tkr;
                     saveTGT.type = ai_eventz[aa].type;
                     saveTGT.ymd = ai_eventz[aa].ymd;
                     saveTGT.evtz = (expand1)? [] : ai_eventz[aa].evtz || [];
                     break;
                  }
               }
            } // END HEADER
            else if(kid.classList.contains('eventzROW')){
               // if(kid.children.length===0){ // NO MONTHBOX data, COLLAPSED.
//                   save_schedule.quarters[qtrTXT] = ai_schedule.quarters[qtrTXT]
//                   continue; //DO NOT SAVE, use saved data, since it is collapsed.
               // } 

               for(var k=0; k<kid.children.length;k++){ //POPULATE DATA from VIEW.
                  rowItem = kid.children[k]
                  if(rowItem.classList.contains('capsNUMBOX3')){
                     save_evt.eID = rowItem.children[1].innerHTML;
                  }
                  else if(rowItem.classList.contains('eventzTitle')){
                     save_evt.title = rowItem.value;
                  }
                  else if(rowItem.classList.contains('eventzTypeBOX1')){
                     save_evt.type =  rowItem.children[0].value
                  }
                  else if(rowItem.classList.contains('eventzTypeBOX2')){
                     save_evt.range = rowItem.children[0].value
                  }
                  else if(rowItem.classList.contains('eventzTypeBOX3')){
                     save_evt.spot_amt = rowItem.children[0].value
                     save_evt.spot_POS = rowItem.children[2].value;
                  }
                  else if(rowItem.classList.contains('detailDate2')){
                     save_evt.ymd = rowItem.value;
                  }
               } //END ROW DATA
               // if(saveTGT && saveTGT.evtz){
                  saveTGT.evtz.push(save_evt)
               // }else{
               // }

            } //end EVENTz ROW
          } // ROW of EVENTZ LOOP
         //  if(saveTGT && saveTGT.evtz){
             save_eventz.push( saveTGT )
         //  }

//          if(!show_schedule_details_view){   //could move out of loop, below.
//                      CAPMonth.monthData = ai_schedule.quarters[qtrTXT].monthData
//                   }  
         } // IF eventzBOX
      } //END EVENTZ BOX LOOP
   } //end TRY
   catch(e){
      console.log('err in save',e)
      showErrorMSG('⚔️ ERR ⚔️'); 
      return;
   }
   if(save_eventz){
      //SAVE to LOCAL STORAGE
      ai_eventz = save_eventz;
      localStorage.ai_eventz = JSON.stringify(ai_eventz) 
      generateEVTZClick(); //RELOAD VIEW.  
      showErrorMSG('⚔️ SAVED ⚔️');
   }
}     //end save EVENTZ click  

   /************************************************\
    * - AI_EVENTZ_MATRIX
    *  - ability to save quarterly data in localstorage
   \************************************************/

   let ai_eventz=null;
   const ai_eventz_LOAD_MOCK_DATA=()=>{ //READ from OBJ
      // ai_eventz = [
      //    {qID:1,tkr:'NVDA',title:'NVDA_DIP_2023',ymd:'2023_12_10',type:'DIP',txt:'10yr 5%',expanded:true,
      //       evtz:[
      //       {eID:0,title:'10%OFFTOP',ymd:'2023_12_02',type:'WARN',range:'100-200',spot_amt:0,spot_POS:0},
      //       {eID:1,title:'20%OFFTOP',ymd:'2023_12_01',type:'PAD1',range:'100-200',spot_amt:100,spot_POS:150}]},
      //    {qID:2,tkr:'NVDA',title:'NVDA_CRASH_2023',ymd:'2023_12_10',type:'CRASH',txt:'10yr 4.44%',
      //       evtz:[{eID:0,title:'50%OFFTOP',ymd:'2023_12_02',type:'DIP'},{eID:1,title:'b',ymd:'2023_12_01',type:'warn'}]},
      //    {qID:3,tkr:'NVDA',title:'AAA',ymd:'2023_12_10',type:'BLACKSWAN',txt:'super-semia',
      //       evtz:[{eID:0,title:'LIQUID_TOP',ymd:'2023_12_02',type:'DIP'},{eID:1,title:'b',ymd:'2023_12_01',type:'warn'}]},
      //    {qID:4,tkr:'NVDA',title:'BBB',ymd:'2023_12_10',type:'BREAKOUT',txt:'super-semib',
      //       evtz:[{eID:0,title:'vent1',ymd:'2023_12_02',type:'DIP'},{eID:1,title:'b',ymd:'2023_12_01',type:'warn'}]},
      //    {qID:5,tkr:'NVDA',title:'',ymd:'2023_12_10',type:'BULLFLAG',txt:'celebrate good things.',
      //       evtz:[{eID:0,title:'event2',ymd:'2023_12_02',type:'DIP'},{eID:1,title:'b',ymd:'2023_12_01',type:'warn'}]}
      // ];
      ai_eventz = [{"title":"NVDA_DIP_2023","expanded":true,"qID":1,"tkr":"NVDA","type":"DIP","ymd":"2023_12_10","evtz":[{"eID":1,"title":"10%OFFTOP","type":"WARN","range":"100-200","spot_amt":"0","spot_POS":"0","ymd":"2023_12_02"},{"eID":2,"title":"20%OFFTOP","type":"PAD1","range":"100-200","spot_amt":"100","spot_POS":"150","ymd":"2023_12_01"}]},{"title":"NVDA_TOP_2023","expanded":false,"qID":2}]
   }

   const ai_eventz_init=()=>{ //READ from LOCAL STORAGE
      ai_eventz = (localStorage.ai_eventz)?
         JSON.parse( localStorage.ai_eventz ):null;
      // ai_eventz = null; //test mock data
      if(!ai_eventz){
         ai_eventz_LOAD_MOCK_DATA();
      }
   }; ai_eventz_init();

      /************************************************\
    * -  END AI_EVENTZ_MATRIX
   \************************************************/

   const addEVTZMilestoneClick=()=>{
      ai_ledger.eventz_expanded = true;
      evtzRow1 = document.createElement('article')
      evtzRow1.classList.add('addEVTZRow1')

      //EVENT_TYPE
      typeBOX = document.createElement('aside')
         typeBOX.innerHTML="type&nbsp;"
         typeData = document.createElement('select')
         type1 = document.createElement('option')
         type2 = document.createElement('option')
         type3 = document.createElement('option')
         type4 = document.createElement('option')
         type5 = document.createElement('option')
         type6 = document.createElement('option')
         type7 = document.createElement('option')
         type8 = document.createElement('option')
         type9 = document.createElement('option')
         type10 = document.createElement('option')
         type11 = document.createElement('option')
         type12 = document.createElement('option')
         type1.value = "...";
         type2.value = "WARN";
         type3.value = "CRASH";
         type4.value = "DIP";
         type5.value = "CALLTOP";
         type6.value = "CALLBTM";
         type7.value = "PAD5";
         type8.value = "BLKSWAN";
         type9.value = "BREAK";
         type10.value = "LOrLO";
         type11.value = "HIrHI";
         type12.value = "LiQD8";
         type1.innerHTML = "...";
         type2.innerHTML = "WARN";
         type3.innerHTML = "CRASH";
         type4.innerHTML = "DIP";
         type5.innerHTML = "CALLTOP";
         type6.innerHTML = "CALLBTM";
         type7.innerHTML = "PAD5";
         type8.innerHTML = "BLKSWAN";
         type9.innerHTML = "BREAK";
         type10.innerHTML = "LOrLO";
         type11.innerHTML = "HIrHI";
         type12.innerHTML = "LiQD8";
         typeData.appendChild(type1);
         typeData.appendChild(type2);
         typeData.appendChild(type3);
         typeData.appendChild(type4);
         typeData.appendChild(type5);
         typeData.appendChild(type6);
         typeData.appendChild(type7);
         typeData.appendChild(type8);
         typeData.appendChild(type9);
         typeData.appendChild(type10);
         typeData.appendChild(type11);
         typeData.appendChild(type12);
         typeData.value =  '...';
         typeBOX.appendChild(typeData)
         typeBOX.classList.add('eventzTypeBOX1')
      
         // if(monthData.type==='trim'){
         //    typeData.classList.add('typeTRIMColor')
         // } else if (monthData.type==='pad'){
         //    typeData.classList.add('typePADColor')
         // }
         typeData.classList.add('eventzTypeData1')


      date1 = document.createElement('input')
      date1.value = current_ymd.split('YMD_')[1];//user display
      date1.classList.add('detailDate2')

      tick1 = document.createElement('input')
      tick1.value = "";
      tick1.classList.add('quarterTXT')
      tick1.placeholder="ticker"
                        
      saveBtn3 = document.createElement('button')
      saveBtn3.innerHTML = 'save🌟'
      saveBtn3.classList.add('saveBtn2')
      saveBtn3.setAttribute('data-arg7',ai_eventz.length+1)
      saveBtn3.addEventListener("click",(e)=>{
         saveNewMilestoneClick(e) 
      });

      evtzRow1.appendChild(tick1)
      evtzRow1.appendChild(typeBOX)
      evtzRow1.appendChild(date1)
      evtzRow1.appendChild(saveBtn3)
      eventzFRAME.appendChild(evtzRow1)

    } //end add milestone


    const setEVTZDeleteClick=(event)=>{
      // const deleteSelectedSchedule = (event)=>{ //remove ledger item, save, refresh
      let evtSelected = [], detSelected=[], temp = [], removeChildRow=false;
      let evtChecks = document.getElementsByName("eventzMasterRadio");
      let detChecks = document.getElementsByName("eventzDetailsRadio");
      for(let i=0; i<evtChecks.length;i++){
         if(evtChecks[i].checked){ //SORT THROUGH ai_eventz to delete data and reload
            let qID = evtChecks[i].qID;
            evtSelected.push(evtChecks[i])
            for(var j=0; j<ai_eventz.length;j++){ //DELETE evt DATA
               if( qID.toString() === ai_eventz[j].qID.toString() ){
                  ai_eventz.splice(j,1) //remove data
                  break;
               }
            }
            //SAVE & RELOAD VIEW
            showErrorMSG('🦕 Saved. ');
            localStorage.ai_eventz = JSON.stringify(ai_eventz) //SAVE to LOCAL STORAGE
            generateEVTZClick(); //RELOAD VIEW. 
            break;
         }
      }
      if(!evtSelected.length && detChecks.length){ // DETAIL ROW SELECTION
         for(let j=0; j<detChecks.length;j++){
            if(detChecks[j].checked){
               detSelected.push(detChecks[j])
               let eID = detChecks[j].eID
               let qID = detChecks[j].parentElement.parentElement.parentElement.parentElement.qID;
               for(var k=0; k<ai_eventz.length;k++){ //DELETE MONTH DATA
                  if(ai_eventz[k].qID===qID){
                     for(var m=0; m<ai_eventz[k].evtz.length;m++){ //DELETE MONTH DATA
                        if( eID === ai_eventz[k].evtz[m].eID ){       
                           ai_eventz[k].evtz.splice(m,1) //remove data
                           break;
                        }
                     }
                  }
               }
               //SAVE & RELOAD VIEW
               showErrorMSG(' Saved🦖 ');
               localStorage.ai_eventz = JSON.stringify(ai_eventz) //SAVE to LOCAL STORAGE
               generateEVTZClick(); //RELOAD VIEW. 
               
               break;
            }
         }
      } 
      if(!evtSelected.length && !detSelected.length){showErrorMSG(' Nothing selected 😵'); return;}
   } //end delete EVENTZ fn


//END EVENTZ***********************************************


//BEGIN SCHEDULE*******************************************
   /************************************************\
    * - AI_SCHEDULE_MATRIX
    *  - ability to save quarterly data in localstorage
   \************************************************/

   let ai_schedule=null;
   const ai_schedule_LOAD_MOCK_DATA=()=>{ //READ from OBJ
      ai_schedule = {"quarters":{"Q4_2023_OCT":{"qID":"Q4_2023_OCT","expanded":false,"caps":[{"tkr":"NVDA","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"50","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_27","tick":"NVDA","type":"pad","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"pad","amt":"100","role":"EXIT"},{"ymd":"2023_11_27","tick":"COST","type":"pad","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"MSFT","type":"trim","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"QQQ","type":"trim","amt":"50","role":"WATCH"}]},"Q4_2023_NOV":{"qID":"Q4_2023_NOV","expanded":false,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"META","cap":"100","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_30","tick":"COIN","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_30","tick":"META","type":"pad","amt":"100","role":"SAFE"},{"ymd":"2023_11_30","tick":"ETH","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_30","tick":"ETH","type":"pad","amt":"100","role":"HIGHrHIGH"}]},"Q4_2023_DEC":{"qID":"Q4_2023_DEC","expanded":true,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"META","cap":"100","trim_at":"10","pad_at":"10","padlvl":"1","crashlvl":"2"},{"tkr":"TSLA","cap":"100","trim_at":"10","pad_at":"10","padlvl":"2","crashlvl":"2"}],"monthData":[{"ymd":"2023_12_01","tick":"BTC","type":"trim","amt":"25","role":"RISKOFF"},{"tick":"AAA","type":"pad","amt":"100","at":"","ymd":"2023_12_02"}]},"Q1_2024_JAN":{"qID":"Q1_2024_JAN","expanded":false,"caps":[],"monthData":[]}}}
   }

   const ai_schedule_init=()=>{ //READ from LOCAL STORAGE
      ai_schedule = (localStorage.ai_schedule)?
         JSON.parse( localStorage.ai_schedule ):null;
      // ai_schedule = null; //test mock data
      if(!ai_schedule){
         ai_schedule_LOAD_MOCK_DATA();
      }
   }; ai_schedule_init();

   /*************************************\
    * SCHEDULE_MATRIX functions
   \*************************************/

const generateScheduleClick = ()=>{ //GENERATE SCHEDULE DISPLAY
   let trimBOX1,quarter,quarterSets=[];
   let quarterBOX,monthBOX,quarterTXT,capROW;//trimBtnROW;
   let capsData, trimTick,trimCap,trim_at,pad_at,pad_limit,lvl_limit;
   let trimBtn1,padBtn1,lvlUpBtn1,expandBtn1;
   let capBOX1, capData1, trim_atBOX1,trim_atData1,pad_atBOX1,pad_atData1;
   let padlvlBOX1,padlvlData1,crashlvlBOX1,crashlvlData1;
   let monthData1=[], addBtn4, quarterHeader;
   let capsNUMBOX1, capsCHECKBOX1, capsSelect1, capsCheckMark1; 
   let capsNUMBOX2, capsCHECKBOX2, capsSelect2, capsCheckMark2;
   generatedScheduleBOX.innerHTML = ""
   quarterSets = Object.keys(ai_schedule.quarters);//ai_ledger.ticks;
   if(!quarterSets){ console.log('no data'); return}
   if(ai_ledger.caps_expanded){
      expandCollapseBtn4.innerHTML = '💨'   
      for(let i=0;i<quarterSets.length;i++){  //BEGIN QUARTERLY LOOP
         quarter= ai_schedule.quarters[quarterSets[i]];
         quarterBOX = document.createElement('section')
         quarterBOX.classList.add('quarterBOX')

         quarterHeader = document.createElement('aside')
         quarterHeader.classList.add('quarterHeader')

         quarterTXT = document.createElement('input')
         quarterTXT.classList.add('quarterTXT')
         quarterTXT.value = quarter.qID;//.quarterID.toUpperCase();
         quarterTXT.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
            }); 

         expandBtn1 = document.createElement('button')
         expandBtn1.innerHTML = '🕸️'
         expandBtn1.classList.add('addBtn4')
         expandBtn1.setAttribute('data-arg3',quarter.qID)
         expandBtn1.addEventListener("click",(e)=>{
               expandCAPClick(e.target.getAttribute('data-arg3')) });
         addBtn4 = document.createElement('button')
         addBtn4.innerHTML = 'addCAP🗺️'
         addBtn4.classList.add('addBtn4')
         addBtn4.setAttribute('data-arg2',quarter.qID)
         addBtn4.addEventListener("click",(e)=>{
               addCapClick(e.target.getAttribute('data-arg2')) });

         quarterHeader.appendChild(quarterTXT)
         quarterHeader.appendChild(expandBtn1)
         quarterHeader.appendChild(addBtn4)
         // quarterBOX.appendChild(addBtn4)
         quarterBOX.appendChild(quarterHeader)

         monthBOX = document.createElement('article')
         monthBOX.classList.add('monthBOX')

         if(quarter.expanded){
            expandBtn1.innerHTML = '💨'
            for(let j=0;j<quarter.caps.length;j++){  //MONTHLY CAP LOOP .
               capsData = quarter.caps[j];
               capROW = document.createElement('aside')
               capROW.classList.add('capROW')
               //**********************************************selector
               capsNUMBOX1 = document.createElement('aside')
               capsNUMBOX1.classList.add('capsNUMBOX1')//encodeNUMBOX1
               capsCHECKBOX1 = document.createElement('label')
               capsCHECKBOX1.classList.add('checkboxFrame') 
               capsNUMBOX1.innerHTML=j+1;            
               capsSelect1 = document.createElement('input');
               capsSelect1.ymdt = quarter.qID+'_'+capsData.tkr.toUpperCase() || '';
               capsSelect1.type = "radio";
               capsSelect1.name = "scheduleCapsRadio";
               capsSelect1.classList.add('cap_checkmark')
               capsCHECKBOX1.appendChild(capsSelect1)
               capsCheckMark1 = document.createElement('span')
               capsCheckMark1.classList.add('checkmark')
               capsCHECKBOX1.appendChild(capsCheckMark1)
               capsNUMBOX1.appendChild(capsCHECKBOX1)
               capROW.appendChild(capsNUMBOX1)
               // end ************************************** selector
               trimTick = document.createElement('input')
               trimTick.classList.add('trimTick')
               trimTick.value = capsData.tkr.toUpperCase() || 0;
               trimTick.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });             
               capBOX1 = document.createElement('aside')
               capBOX1.innerHTML="CAP&nbsp";
               capBOX1.classList.add('inputDATABOX1')
               capData1 = document.createElement('input')
               capData1.classList.add('inputDATA1')
               capData1.placeholder = "$0";
               capData1.value = capsData.cap || '';          
               capData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });  
               capBOX1.appendChild(capData1)

               trim_atBOX1 = document.createElement('aside')
               trim_atBOX1.innerHTML="trim&nbsp";
               trim_atBOX1.classList.add('inputDATABOX2')
               trim_atData1 = document.createElement('input')
               trim_atData1.classList.add('inputDATA2')
               trim_atData1.placeholder = "$0";
               trim_atData1.value = capsData.trim_at || '';          
               trim_atData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block';  
               });  
               trim_atBOX1.appendChild(trim_atData1)

               pad_atBOX1 = document.createElement('aside')
               pad_atBOX1.innerHTML="pad&nbsp";
               pad_atBOX1.classList.add('inputDATABOX3')
               pad_atData1 = document.createElement('input')
               pad_atData1.classList.add('inputDATA2')
               pad_atData1.placeholder = "$0";
               pad_atData1.value = capsData.pad_at || '';          
               pad_atData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });  
               pad_atBOX1.appendChild(pad_atData1)

               padlvlBOX1 = document.createElement('aside')
               padlvlBOX1.innerHTML="padlvl&nbsp";
               padlvlBOX1.classList.add('inputDATABOX4')
               padlvlData1 = document.createElement('input')
               padlvlData1.classList.add('inputDATA3')
               padlvlData1.placeholder = "0";
               padlvlData1.value = capsData.padlvl || '';          
               padlvlData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });  
               padlvlBOX1.appendChild(padlvlData1)

               crashlvlBOX1 = document.createElement('aside')
               crashlvlBOX1.innerHTML="crashPOS&nbsp";
               crashlvlBOX1.classList.add('inputDATABOX5')
               crashlvlData1 = document.createElement('input')
               crashlvlData1.classList.add('inputDATA3')
               crashlvlData1.placeholder = "0";
               crashlvlData1.value = capsData.crashlvl || 0;          
               crashlvlData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });  
               crashlvlBOX1.appendChild(crashlvlData1)

               capROW.appendChild(trimTick)         
               capROW.appendChild(capBOX1)         
               capROW.appendChild(trim_atBOX1)         
               capROW.appendChild(pad_atBOX1)         
               capROW.appendChild(padlvlBOX1)         
               capROW.appendChild(crashlvlBOX1)
               monthBOX.appendChild(capROW)

               if(show_schedule_details_view){   //BEGIN DETAILS VIEW
                  let detailRow2,date1,detAmt,detType,detRole,detNote;
                  let monthData = null;
                  let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11;
                  let type1,type2,type3,type4;
                  let roleBOX,roleData;
                  let typeBOX,typeData,atBOX1;
                  let atData1,amtData1;
                  for(let k=0;k<quarter.monthData.length;k++){  //CAP DETAILS LOOP.
                     monthData = quarter.monthData[k];
                     if(monthData.tick.toUpperCase()!=capsData.tkr.toUpperCase()){continue;}
                     detailRow2 = document.createElement('section')
                     detailRow2.classList.add('detailRow2')
                     //DETAILS ROW
               //**********************************************selector
               capsNUMBOX2 = document.createElement('aside')
               capsNUMBOX2.classList.add('capsNUMBOX2')//encodeNUMBOX1
               capsCHECKBOX2 = document.createElement('label')
               capsCHECKBOX2.classList.add('checkboxFrame') 
               capsNUMBOX2.innerHTML=k+1;            
               capsSelect2 = document.createElement('input');
               capsSelect2.ymdtn = quarter.qID+'_'+capsData.tkr.toUpperCase()+'_'+k || '';
               // capsSelect2.ymdt = quarter.qID+'_'+capsData.tkr.toUpperCase() || '';
               capsSelect2.type = "radio";
               capsSelect2.name = "scheduleDetailsRadio";
               capsSelect2.classList.add('cap_checkmark')
               capsCHECKBOX2.appendChild(capsSelect2)
               capsCheckMark2 = document.createElement('span')
               capsCheckMark2.classList.add('checkmark')
               capsCHECKBOX2.appendChild(capsCheckMark2)
               capsNUMBOX2.appendChild(capsCHECKBOX2)
               detailRow2.appendChild(capsNUMBOX2)
               // end ************************************** selector
                        date1 = document.createElement('input')
                        date1.value = ''+monthData.ymd;
                        date1.classList.add('detailDate1')
                        date1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
                        });  
                        amtBOX1 = document.createElement('aside')
                        amtBOX1.innerHTML="amt&nbsp;"
                        roleBOX = document.createElement('aside')
                        roleBOX.innerHTML="role&nbsp;"
                        typeBOX = document.createElement('aside')
                        typeBOX.innerHTML="type&nbsp;"
                        roleData = document.createElement('select')
                        typeData = document.createElement('input')
                        role1 = document.createElement('option')
                        role2 = document.createElement('option')
                        role3 = document.createElement('option')
                        role4 = document.createElement('option')
                        role5 = document.createElement('option')
                        role6 = document.createElement('option')
                        role7 = document.createElement('option')
                        role8 = document.createElement('option')
                        role9 = document.createElement('option')
                        role10 = document.createElement('option')
                        role11 = document.createElement('option')
                        role1.value = "...";
                        role2.value = "HOLD";
                        role3.value = "WATCH";
                        role4.value = "RISKOFF";
                        role5.value = "LONG";
                        role6.value = "TRIM";
                        role7.value = "SAFE";
                        role8.value = "RISKON";
                        role9.value = "EXIT";
                        role10.value = "LOrLO";
                        role11.value = "HIGHrHIGH";
                        role1.innerHTML = "...";
                        role2.innerHTML = "HOLD";
                        role3.innerHTML = "WATCH";
                        role4.innerHTML = "RISKOFF";
                        role5.innerHTML = "LONG";
                        role6.innerHTML = "TRIM";
                        role7.innerHTML = "SAFE";
                        role8.innerHTML = "RISKON";
                        role9.innerHTML = "EXIT";
                        role10.innerHTML = "LOrLO";
                        role11.innerHTML = "HIrHI";
                        roleData.appendChild(role1);
                        roleData.appendChild(role2);
                        roleData.appendChild(role3);
                        roleData.appendChild(role4);
                        roleData.appendChild(role5);
                        roleData.appendChild(role6);
                        roleData.appendChild(role7);
                        roleData.appendChild(role8);
                        roleData.appendChild(role9);
                        roleData.appendChild(role10);
                        roleData.appendChild(role11);
                        roleData.value = monthData.role || '';
                        roleBOX.appendChild(roleData)
                        
                        roleData.addEventListener("change",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
                        });  
                        typeData.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
                        });  

                        typeData.value= monthData.type || '';
                        roleBOX.classList.add('roleBOX1')
                        
                        typeBOX.appendChild(typeData)
                        typeBOX.classList.add('typeBOX1')
                        
                        if(monthData.type==='trim'){
                           typeData.classList.add('typeTRIMColor')
                        } else if (monthData.type==='pad'){
                           typeData.classList.add('typePADColor')
                        }

                        roleData.classList.add('roleData1')
                        typeData.classList.add('typeData1')
                        amtData1 = document.createElement('input')
                        amtData1.placeholder = "$0";
                        amtData1.value = monthData.amt;
                        amtData1.classList.add('spotAtData1')

                        amtData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
                        });  

                        amtBOX1.classList.add('amtBOX1')
                        amtBOX1.appendChild(amtData1)            
                        detailRow2.appendChild(date1)
                        detailRow2.appendChild(typeBOX)
                        detailRow2.appendChild(amtBOX1)
                        detailRow2.appendChild(roleBOX)

                     //END DETAILS ROW
                     monthBOX.appendChild(detailRow2) 

                  } //END DETAILS LOOP
               }  //END DETAILS VIEW
            } //END MONTHLY LOOP
         } else {quarter.expanded = false;}//END EXPANDED
         quarterBOX.appendChild(monthBOX)
         generatedScheduleBOX.appendChild(quarterBOX)
      } //END QUARTERLY LOOP
   }//END if collapsed view
} //end generate schedule 2


   let show_schedule_details_view = null;
      const setScheduleDetailsClick = (e)=>{ 
         if(e.target.id==='detailsBtn2'){
            totalsBtn2.style.display='block'
            detailsBtn2.style.display='none'
            show_schedule_details_view = true;
         }else{
            totalsBtn2.style.display='none'               
            detailsBtn2.style.display='block'               
            show_schedule_details_view = false;
         }
         // scheduleBOX.scrollIntoView({
         //    behavior: 'smooth',
         //    block: 'start'
         // })
         generateScheduleClick();
      }

      /*****************************************\
       * - SCHEDULE functions
      \****************************************/
      const trimScheduleClick = ()=>{ 
         //selection trim ai_bank{"tick":{balance}}  //increment trim_count.
         let selected=null, quarterID,transObj;
         let items = document.getElementsByClassName('cap_checkmark');
         for(let i=0; i<items.length;i++){
            if(items[i].checked){
               selected = items[i]
               selected.checked = false;
               break;
            }
         }
         if(!selected){ showErrorMSG(' Nothing selected 😵'); return; }            
         quarterSet = selected.ymdt.toUpperCase().split('_');
         quarterTick = quarterSet.pop()
         quarterID = quarterSet.join('_')
         if(!ai_BANK[quarterID]){ //INIT
            ai_BANK[quarterID] = {id:quarterID}
            ai_BANK[quarterID].trxns = {pads:[],trims:[]}
         } 
         transObj = {}
         transObj.tick = ''
         transObj.type = ''
         transObj.amt = ''
         transObj.at = ''
         transObj.ymd = ''
         //FIND UI DATA
         quarterSets = Object.keys(ai_schedule.quarters);
         for(var x = 0; x<quarterSets.length;x++){ //UI QUARTER DATA LOOKUP.
            quarter= ai_schedule.quarters[quarterSets[x]];            
            if(quarter.qID===quarterID){
               for(var y=0; y<quarter.caps.length;y++){ // LOOK UP CAPS
                  if(quarter.caps[y].tkr.toUpperCase()===quarterTick){
                     transObj.tick = quarterTick;
                     transObj.type = 'trim';
                     transObj.amt =  quarter.caps[y].trim_at || '';
                     transObj.ymd = formatYMD();
                     break;             
                  }
               }
               ai_schedule.quarters[quarterID].monthData.push(transObj)
               break
            }
         }
         if(!transObj || !transObj.tick){return}
         ai_BANK[quarterID].trxns.trims.push(transObj)
         show_schedule_details_view = true; //SHOW DETAILS
         totalsBtn2.style.display='block'
         detailsBtn2.style.display='none'  
         generateScheduleClick();       
         //UPDATE LOCALSTORAGE with ai_schedule. SAVE
         localStorage.ai_schedule = JSON.stringify(ai_schedule)  
      }
      const padScheduleClick = ()=>{ 
         let selected=null, quarterID,transObj;
         let items = document.getElementsByClassName('cap_checkmark');
         for(let i=0; i<items.length;i++){
            if(items[i].checked){
               selected = items[i]
               selected.checked = false;
               break;
            }
         }
         if(!selected){ showErrorMSG(' Nothing selected 😵'); return; }            
         show_schedule_details_view = true; //SHOW DETAILS
         quarterSet = selected.ymdt.toUpperCase().split('_');
         quarterTick = quarterSet.pop()
         quarterID = quarterSet.join('_')
         if(!ai_BANK[quarterID]){ //INIT
            ai_BANK[quarterID] = {id:quarterID}
            ai_BANK[quarterID].trxns = {pads:[],trims:[]}
         } 
         transObj = {}
         transObj.tick = ''
         transObj.type = ''
         transObj.amt = ''
         transObj.at = ''
         transObj.ymd = ''
         //FIND UI DATA
         quarterSets = Object.keys(ai_schedule.quarters);
         for(var x = 0; x<quarterSets.length;x++){ //UI QUARTER DATA LOOKUP.
            quarter= ai_schedule.quarters[quarterSets[x]];  
            if(quarter.qID===quarterID){
               for(var y=0; y<quarter.caps.length;y++){ // LOOK UP CAPS
                  if(quarter.caps[y].tkr.toUpperCase()===quarterTick){
                     transObj.tick = quarterTick;
                     transObj.type = 'pad';
                     transObj.amt =  quarter.caps[y].trim_at || '';
                     transObj.ymd = formatYMD();
                     break;             
                  }
               }
               ai_schedule.quarters[quarterID].monthData.push(transObj)
               break
            }
         }
         if(!transObj && transObj.tick){return}
         ai_BANK[quarterID].trxns.pads.push(transObj)
         show_schedule_details_view = true; //SHOW DETAILS
         totalsBtn2.style.display='block'
         detailsBtn2.style.display='none'
         generateScheduleClick();
         //UPDATE LOCALSTORAGE with ai_schedule. SAVE
         localStorage.ai_schedule = JSON.stringify(ai_schedule)  
      }
      const addScheduleClick = ()=>{ 
         let scheduleRow1,date1,tick1,amountData1;
         let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11;
         let saveBtn3,roleBOX,roleData,atBOX1,atData1;
         scheduleRow1 = document.createElement('article')
         scheduleRow1.classList.add('scheduleRow1')
         saveBtn3 = document.createElement('button')
         tick1 = document.createElement('input')
         tick1.value = "";
         tick1.placeholder="Q#_YYYY_JAN"
         tick1.classList.add('quarterTXT')
         saveBtn3.innerHTML = 'save🌟'
         saveBtn3.classList.add('saveBtn2')
         saveBtn3.addEventListener("click",(e)=>{
            saveQuarterClick(e) 
         });

         scheduleRow1.appendChild(tick1)
         scheduleRow1.appendChild(saveBtn3)
         generatedScheduleBOX.appendChild(scheduleRow1)
   
      } //end add schedule click

      const addCapClick = (quarterID) =>{
         saveScheduleClick();//FIX: save first for bug on double create row, keeps first row tickr.
         //go to parent quarter and add a unique row
         let newCap = {}
         let qtr = ai_schedule.quarters[quarterID]; //lookup
         if(!qtr){return}
            qtr.expanded = true;
            newCap.cap = "1000";
            newCap.crashlvl = "2";
            newCap.pad_at = "100";
            newCap.padlvl = "1";
            newCap.tkr = "NEW";
            newCap.trim_at = "100";
         qtr.caps.push(newCap)
           //SAVE to LOCAL STORAGE
           localStorage.ai_schedule = JSON.stringify(ai_schedule) 
           generateScheduleClick(); //RELOAD VIEW.  
           showErrorMSG('⚔️ SAVED ⚔️');    
      }

     /************************************************
      * Add Quarters 
     /************************************************/
     const capzAddQtrClick = (quarterID) =>{
         //go to parent quarter and add a unique row
         // let newCap = {}
         // let qtr = ai_schedule.quarters[quarterID]; //lookup
         // if(!qtr){return}
         //    qtr.expanded = true;
         //    newCap.cap = "1000";
         //    newCap.crashlvl = "2";
         //    newCap.pad_at = "100";
         //    newCap.padlvl = "1";
         //    newCap.tkr = "NEW";
         //    newCap.trim_at = "100";
         // qtr.caps.push(newCap)
         //   //SAVE to LOCAL STORAGE
         //   localStorage.ai_schedule = JSON.stringify(ai_schedule) 
         //   generateScheduleClick(); //RELOAD VIEW.  
           showErrorMSG('⚔️ SAVED ⚔️');    
      }

     /************************************************
      * END Add Quarters 
     /************************************************/

      const saveQuarterClick = (e)=>{ 
         //GET input value
         let keyInput = e.target.parentElement.children[0].value;
         if(!keyInput){ showErrorMSG('🎀No data🎀'); return; }
         keyInput = keyInput.toUpperCase();
         if(ai_schedule[keyInput]){ showErrorMSG('🖖duplicate🤙'); return; }
         
         ai_schedule.quarters[keyInput] = {}
         ai_schedule.quarters[keyInput].qID = keyInput;
         ai_schedule.quarters[keyInput].caps = [];
         ai_schedule.quarters[keyInput].monthData = [];

         //SAVE to LOCAL STORAGE
         localStorage.ai_schedule = JSON.stringify(ai_schedule) 
         generateScheduleClick(); //RELOAD VIEW.  

         showErrorMSG('⚔️ ADDED ⚔️');          
      }

   const saveScheduleClick = ()=>{ // GENERATE PROFIT AND LOSS DISPLAY
      saveScheduleBtn1.style.display = 'none'; 
         let quarterBoxes = generatedScheduleBOX.children,row,kids,kid;
         let tkr,cap,trim_at,pad_at,padlvl,crashlvl;
         let date3,type3,amt3,role3;
         let capData,trimDetail, expand1;
         let qtrTXT,dataBox1,dataBox2,qtrBOX, CAPMonth;
         let save_schedule = {quarters:{}};
      try{     
           for(var i=0; i<quarterBoxes.length;i++){ //LOOP QUARTER BOX
            qtrBOX = quarterBoxes[i];
            if(qtrBOX.classList.contains('quarterBOX')){
               kids = qtrBOX.children;
               for(var j=0;j<kids.length;j++){ //MONTH LOOP
                  kid = kids[j];
                  if(kid.classList.contains('quarterHeader')){ 
                     qtrTXT = kid.children[0].value;
                     save_schedule.quarters[qtrTXT] = {qID:qtrTXT}
                     expand1 = (kid.children[2].innerHTML==='v')? true : false;
                     save_schedule.quarters[qtrTXT].expanded = expand1;
                     CAPMonth = save_schedule.quarters[qtrTXT]
                     CAPMonth.caps = [];
                     CAPMonth.monthData = []
                  }
                  if(kid.classList.contains('monthBOX')){
                     if(kid.children.length===0){ // NO MONTHBOX data, COLLAPSED.
                        save_schedule.quarters[qtrTXT] = ai_schedule.quarters[qtrTXT]
                        continue; //DO NOT SAVE, use saved data, since it is collapsed.
                     } 
                     for(var k=0; k<kid.children.length;k++){ //POPULATE DATA from VIEW.
                       row = kid.children[k]
                       if(row.classList.contains('capROW')){ 
                           capData = {};//, trimData = {};
                           for(var mm = 0; mm<row.children.length;mm++){
                              dataBox1 = row.children[mm]
                              if(dataBox1.classList.contains('trimTick')){
                                 dataBox1.value = dataBox1.value.toUpperCase();                     
                                 capData.tkr = dataBox1.value;
                                 tkr = capData.tkr;
                              }
                              else if(dataBox1.classList.contains('inputDATABOX1')){
                                 capData.cap = dataBox1.children[0].value
                              }
                              else if(dataBox1.classList.contains('inputDATABOX2')){
                                 capData.trim_at = dataBox1.children[0].value
                              }
                              else if(dataBox1.classList.contains('inputDATABOX3')){
                                 capData.pad_at = dataBox1.children[0].value
                              }
                              else if(dataBox1.classList.contains('inputDATABOX4')){
                                 capData.padlvl = dataBox1.children[0].value
                              }
                              else if(dataBox1.classList.contains('inputDATABOX5')){
                                 capData.crashlvl = dataBox1.children[0].value
                              }
                           }
                        } //end cap row
                  
                        else if(row.classList.contains('detailRow2')){  
                           trimData = {}; 
                           for(var mm = 0; mm<row.children.length;mm++){
                              dataBox2 = row.children[mm];
                              if(dataBox2.classList.contains('detailDate1')){
                                 trimData.ymd = dataBox2.value
                                 trimData.tick = tkr //important load.
                              }
                              if(dataBox2.classList.contains('typeBOX1')){
                                 trimData.type = dataBox2.children[0].value.toLowerCase()
                              }
                              if(dataBox2.classList.contains('amtBOX1')){
                                 trimData.amt = dataBox2.children[0].value
                              }
                              if(dataBox2.classList.contains('roleBOX1')){
                                 trimData.role = dataBox2.children[0].value
                              }
                           }
                        } // end details row
           
                        // if(capData.tkr && CAPMonth && CAPMonth.caps){
                        if(capData.tkr){
                           CAPMonth.caps.push(capData);
                           capData = {}
                        }
                        // if (trimData.type && CAPMonth && CAPMonth.monthData){
                        // if(!show_schedule_details_view){   //could move out of loop, below.
                        //    CAPMonth.monthData = ai_schedule.quarters[qtrTXT].monthData
                        // }                            
                        else if (trimData.type){
                           CAPMonth.monthData.push(trimData)
                           trimData = {}
                        }

                     } //END CAPS ROW.
                  } //END EXPANDED MONTHBOX
               } //MONTH LOOP
               if(!show_schedule_details_view){   //could move out of loop, below.
                           CAPMonth.monthData = ai_schedule.quarters[qtrTXT].monthData
                        }  
             } // IF QUARTER 
           } //END QUARTER BOX LOOP
         } //end TRY
         catch(e){
            console.log('err in save')
            showErrorMSG('⚔️ ERR ⚔️'); 
            return;
         }
         if(save_schedule){
           //SAVE to LOCAL STORAGE
           ai_schedule = save_schedule;
           localStorage.ai_schedule = JSON.stringify(ai_schedule) 
           generateScheduleClick(); //RELOAD VIEW.  
           showErrorMSG('⚔️ SAVED ⚔️');
         }
      }     //end save schedule click        
        
//END SCHEDULE_MATRIX-METHODS**********************************************
/************************************************\
 * - AI_MAIN_MATRIX
 *  - ability to save trimz and padz with NOTES in localstorage
\************************************************/
let ai_main=null;
const ai_main_LOAD_MOCK_DATA=()=>{ //READ
   // ai_main = {"qrtrz":{"Q4_2023_OCT":{"qID":"Q4_2023_OCT","expanded":true,"tickrz":[
   //    {"tkr":"NVDA","cap":"1000","expanded":true,
   //    "trimz":[
   //       {"ymd":"2023_11_21","amt":"50","role":"HIrHI"},
   //       {"ymd":"2023_11_22","amt":"101","role":"HIrHI"},
   //       {"ymd":"2023_11_23","amt":"102","role":"HIrHI"},
   //       {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
   //       {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
   //       {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
   //       {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
   //       {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
   //       {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
   //       {"ymd":"2023_11_25","amt":"104","role":"HIrHI"}],
   //    "padz":[
   //       {"ymd":"2023_11_27","amt":"50","role":"LOrLO"}
   //       ,{"ymd":"2023_13_24","amt":"101","role":"LOrLO"}
   //       ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
   //       ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
   //       ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
   //       ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
   //       ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
   //       ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
   //    ],"netAMT":"20","notez":"2","notez_expanded":false,"trimTOT":300,"padTOT":60},{"tkr":"MDB","cap":"1000","trimz":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"COST","cap":"1000","trimz":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"MSFT","cap":"1000","trimz":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"QQQ","cap":"500","trims":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"BTC","cap":"1000","trimz":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60}]},"Q4_2023_NOV":{"qID":"Q4_2023_NOV","expanded":false,"tickrz":[{"tkr":"NVDA","cap":"4500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"MDB","cap":"1500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"COST","cap":"2000","trimz":[],"padz":[],"netAMT":"1","notez":"1"},{"tkr":"GOOG","cap":"5000","trimz":[],"padz":[],"netAMT":"2","notez":"3"},{"tkr":"MSFT","cap":"1000","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"QQQ","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"XLK","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"AMD","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"V","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"COIN","cap":"200","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"META","cap":"100","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"ETH","cap":"1000","trimz":[],"padz":[],"netAMT":"1","notez":"2"}]},"Q4_2023_DEC":{"qID":"Q4_2023_DEC","expanded":true,"tickrz":[{"tkr":"NVDA","cap":"4500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"MDB","cap":"1500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"COST","cap":"2000","trimz":[],"padz":[],"netAMT":"20%","notez":"1","trimTOT":300,"padTOT":60},{"tkr":"GOOG","cap":"5000","trimz":[],"padz":[],"netAMT":"20%","notez":"3","trimTOT":300,"padTOT":60},{"tkr":"MSFT","cap":"1000","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"QQQ","cap":"500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"XLK","cap":"500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"AMD","cap":"500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"V","cap":"500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"COIN","cap":"200","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"BTC","cap":"2000","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"ETH","cap":"1000","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"META","cap":"100","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"TSLA","cap":"100","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60}]},"Q1_2024_JAN":{"qID":"Q1_2024_JAN","expanded":false,"tickrz":[]}}}
   ai_main = {"qrtrz":{"Q4_2023_OCT":{"qID":"Q4_2023_OCT","expanded":true,"tickrz":[
      {"tkr":"NVDA","cap":"1000","expanded":true,
      "trimz":[
         {"ymd":"2023_11_21","amt":"50","role":"HIrHI"},
         {"ymd":"2023_11_22","amt":"101","role":"HIrHI"},
         {"ymd":"2023_11_23","amt":"102","role":"HIrHI"},
         {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
         {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
         {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
         {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
         {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
         {"ymd":"2023_11_24","amt":"103","role":"HIrHI"},
         {"ymd":"2023_11_25","amt":"104","role":"HIrHI"}],
      "padz":[
         {"ymd":"2023_11_27","amt":"50","role":"LOrLO"}
         ,{"ymd":"2023_13_24","amt":"101","role":"LOrLO"}
         ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
         ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
         ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
         ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
         ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
         ,{"ymd":"2023_13_24","amt":"102","role":"LOrLO"}
      ],"netAMT":"20","notez":"2","notez_expanded":false,"trimTOT":300,"padTOT":60},{"tkr":"MDB","cap":"1000","trimz":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"COST","cap":"1000","trimz":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"MSFT","cap":"1000","trimz":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"QQQ","cap":"500","trims":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"BTC","cap":"1000","trimz":[],"padz":[],"netAMT":"20","notez":"2","trimTOT":300,"padTOT":60}]},"Q4_2023_NOV":{"qID":"Q4_2023_NOV","expanded":false,"tickrz":[{"tkr":"NVDA","cap":"4500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"MDB","cap":"1500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"COST","cap":"2000","trimz":[],"padz":[],"netAMT":"1","notez":"1"},{"tkr":"GOOG","cap":"5000","trimz":[],"padz":[],"netAMT":"2","notez":"3"},{"tkr":"MSFT","cap":"1000","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"QQQ","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"XLK","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"AMD","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"V","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"COIN","cap":"200","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"META","cap":"100","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"ETH","cap":"1000","trimz":[],"padz":[],"netAMT":"1","notez":"2"}]},"Q4_2023_DEC":{"qID":"Q4_2023_DEC","expanded":true,"tickrz":[{"tkr":"NVDA","cap":"4500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"MDB","cap":"1500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"COST","cap":"2000","trimz":[],"padz":[],"netAMT":"20%","notez":"1","trimTOT":300,"padTOT":60},{"tkr":"GOOG","cap":"5000","trimz":[],"padz":[],"netAMT":"20%","notez":"3","trimTOT":300,"padTOT":60},{"tkr":"MSFT","cap":"1000","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"QQQ","cap":"500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"XLK","cap":"500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"AMD","cap":"500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"V","cap":"500","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"COIN","cap":"200","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"BTC","cap":"2000","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"ETH","cap":"1000","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"META","cap":"100","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60},{"tkr":"TSLA","cap":"100","trimz":[],"padz":[],"netAMT":"20%","notez":"2","trimTOT":300,"padTOT":60}]},"Q1_2024_JAN":{"qID":"Q1_2024_JAN","expanded":false,"tickrz":[]}}}
}

const ai_main_init=()=>{ //READ from LOCAL STORAGE
   ai_main = (localStorage.ai_main)?
      JSON.parse( localStorage.ai_main ):null;
   // ai_main = null; //test mock data
   if(!ai_main){
      ai_main_LOAD_MOCK_DATA();
   }
}; ai_main_init();

//    // "monthData":[
//    //    {"ymd":"2023_11_27","tick":"NVDA","type":"pad","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"pad","amt":"100","role":"EXIT"},{"ymd":"2023_11_27","tick":"COST","type":"pad","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"MSFT","type":"trim","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"QQQ","type":"trim","amt":"50","role":"WATCH"}
//    // ]
// },
// "Q4_2023_NOV":{"qID":"Q4_2023_NOV","expanded":false,"tickrz":[{"tkr":"NVDA","cap":"4500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"MDB","cap":"1500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"COST","cap":"2000","trimz":[],"padz":[],"netAMT":"1","notez":"1"},{"tkr":"GOOG","cap":"5000","trimz":[],"padz":[],"netAMT":"2","notez":"3"},{"tkr":"MSFT","cap":"1000","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"QQQ","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"XLK","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"AMD","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"V","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"COIN","cap":"200","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"META","cap":"100","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"ETH","cap":"1000","trimz":[],"padz":[],"netAMT":"1","notez":"2"}]
// // ,"monthData":[
// //    {"ymd":"2023_11_30","tick":"COIN","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_30","tick":"META","type":"pad","amt":"100","role":"SAFE"},{"ymd":"2023_11_30","tick":"ETH","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_30","tick":"ETH","type":"pad","amt":"100","role":"HIGHrHIGH"}
// // ]
// },
// "Q4_2023_DEC":{"qID":"Q4_2023_DEC","expanded":true,"tickrz":[{"tkr":"NVDA","cap":"4500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"MDB","cap":"1500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"COST","cap":"2000","trimz":[],"padz":[],"netAMT":"1","notez":"1"},{"tkr":"GOOG","cap":"5000","trimz":[],"padz":[],"netAMT":"2","notez":"3"},{"tkr":"MSFT","cap":"1000","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"QQQ","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"XLK","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"AMD","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"V","cap":"500","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"COIN","cap":"200","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"BTC","cap":"2000","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"ETH","cap":"1000","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"META","cap":"100","trimz":[],"padz":[],"netAMT":"1","notez":"2"},{"tkr":"TSLA","cap":"100","trimz":[],"padz":[],"netAMT":"2","notez":"2"}]
// // ,"monthData":[
// //    {"ymd":"2023_12_01","tick":"BTC","type":"trim","amt":"25","role":"RISKOFF"},{"tick":"AAA","type":"pad","amt":"100","at":"","ymd":"2023_12_02"}
// // ]
// },
// "Q1_2024_JAN":{"qID":"Q1_2024_JAN","expanded":false,"tickrz":[]
// // ,"monthData":[]
// }
// }}

const generateQuickClick = ()=>{ //GENERATE Quick DISPLAY
   generatedQuickBOX.innerHTML = "" //clear view
   qrtrSetz = Object.keys(ai_main.qrtrz);//ai_ledger.ticks;
   let QRTR = null;
   if(!qrtrSetz){ console.log('no data'); return}
   if(ai_ledger.quick_expanded){
      expandCollapseBtn0.innerHTML = '💨'   
      for(let i=0;i<qrtrSetz.length;i++){  //BEGIN QUARTERLY LOOP
         QRTR= ai_main.qrtrz[qrtrSetz[i]];
         quarterBOX = document.createElement('section')
         quarterBOX.classList.add('QuickQuarterBOX')
         quarterHeader = document.createElement('aside')
         quarterHeader.classList.add('quarterHeader')
         //**********************************************selector
         QuicksNUMBOX0 = document.createElement('span')
         QuicksNUMBOX0.classList.add('quickNUMBOX0')
         QuicksCHECKBOX0 = document.createElement('label')
         QuicksCHECKBOX0.classList.add('checkboxFrame2') 
         // QuicksNUMBOX0.innerHTML=i+1;            
         QuicksSelect0 = document.createElement('input');
         // QuicksSelect0.TKR = tickrData.tkr.toUpperCase() || '';
         QuicksSelect0.qID = QRTR.qID || '';
         QuicksSelect0.type = "radio";
         QuicksSelect0.name = "QuickCapsRadio";
         QuicksSelect0.classList.add('quick_checkmark')
         QuicksCHECKBOX0.appendChild(QuicksSelect0)
         QuicksCheckMark0 = document.createElement('span')
         QuicksCheckMark0.classList.add('checkmark')
         QuicksCHECKBOX0.appendChild(QuicksCheckMark0)
         QuicksNUMBOX0.appendChild(QuicksCHECKBOX0)
         quarterHeader.appendChild(QuicksNUMBOX0)
         // end ************************************** selector         
         quarterTITLE = document.createElement('input')
         quarterTITLE.classList.add('quarterTitle')
         quarterTITLE.value = QRTR.qID;
         // quarterTITLE.value = quarter.qID;
         quarterTITLE.addEventListener("keyup",(e)=>{ 
               saveBtn0.style.display = 'flex'; 
            }); 
         expandBtn0 = document.createElement('button')
         expandBtn0.innerHTML = '🕸️'
         expandBtn0.classList.add('addBtn5')
         // expandBtn0.setAttribute('data-arg3',quarter.qID)
         expandBtn0.setAttribute('data-arg3',QRTR.qID)
         expandBtn0.addEventListener("click",(e)=>{ //EXPAND TICK MAIN.
               expandQuickTickerClick(e.target.getAttribute('data-arg3')) 
            });
         addBtn4 = document.createElement('button')
         addBtn4.innerHTML = 'add Ticker🧭'
         addBtn4.classList.add('addBtn5')
         addBtn4.setAttribute('data-arg2',QRTR.qID)
         addBtn4.addEventListener("click",(e)=>{
               addQuickTickerClick(e.target.getAttribute('data-arg2')) 
            });
         quarterHeader.appendChild(quarterTITLE)
         quarterHeader.appendChild(expandBtn0)
         quarterHeader.appendChild(addBtn4)
         quarterBOX.appendChild(quarterHeader)
         tickerRowBOX = document.createElement('article')
         tickerRowBOX.classList.add('monthBOX')
         if(QRTR.expanded){
            expandBtn0.innerHTML = '💨'
            if(!QRTR.tickrz){QRTR.tickrz = []}
            for(let j=0;j<QRTR.tickrz.length;j++){  //MONTHLY CAP LOOP .
               tickrData = QRTR.tickrz[j];
               // if(!tickrData){debugger;}
               //CALCULATE TRIM PAD TOTALS (overwrite) **************
               tickrData.trimTOT = 0
               tickrData.padTOT  = 0
               tickrData.netAMT = 0     
               if(!tickrData.trimz){tickrData.trimz=[]}          
               if(!tickrData.padz){tickrData.padz=[]}          
               for(var a=0; a<tickrData.trimz.length;a++){
                  tickrData.trimTOT += parseFloat(tickrData.trimz[a].amt);
               }
               for(var b=0; b<tickrData.padz.length;b++){
                  tickrData.padTOT += parseFloat(tickrData.padz[b].amt);
               }
               tickrData.netAMT = tickrData.trimTOT - tickrData.padTOT;
               if(tickrData.netAMT > 0){
                  tickrData.netAMT = '+' + tickrData.netAMT;
               } else {
                  tickrData.netAMT = tickrData.netAMT;
               }
               // if(tickrData.trimTOT && tickrData.padTOT){
               //    if(tickrData.trimTOT > tickrData.padTOT){
               //       tickrData.netAMT = tickrData.trimTOT/tickrData.padTOT;
               //       tickrData.netAMT = tickrData.netAMT * 100;
               //       tickrData.netAMT = '+' + Math.round(tickrData.netAMT) + '%';
               //    } else {
               //       tickrData.netAMT = tickrData.padTOT/tickrData.trimTOT;
               //       tickrData.netAMT = tickrData.netAMT * 100;
               //       tickrData.netAMT = '-' + Math.round(tickrData.netAMT) + '%';
               //    }
               // }

               //END CALCULATE TRIM PAD TOTALS **************

               QuickROW = document.createElement('aside')
               QuickROW.classList.add('QuickROW')
               //**********************************************selector
               QuicksNUMBOX1 = document.createElement('aside')
               QuicksNUMBOX1.classList.add('quickNUMBOX1')//encodeNUMBOX1
               QuicksCHECKBOX1 = document.createElement('label')
               QuicksCHECKBOX1.classList.add('checkboxFrame') 
               QuicksNUMBOX1.innerHTML=j+1;            
               QuicksSelect1 = document.createElement('input');
               // QuicksSelect1.ymdt = QRTR.qID+'_'+tickrData.tkr.toUpperCase() || '';
               QuicksSelect1.type = "radio";
               QuicksSelect1.name = "QuickCapsRadio";
               QuicksSelect1.TKR = tickrData.tkr.toUpperCase() || '';
               QuicksSelect1.qID = QRTR.qID || '';
               QuicksSelect1.classList.add('quick_checkmark')
               QuicksCHECKBOX1.appendChild(QuicksSelect1)
               QuicksCheckMark1 = document.createElement('span')
               QuicksCheckMark1.classList.add('checkmark')
               QuicksCHECKBOX1.appendChild(QuicksCheckMark1)
               QuicksNUMBOX1.appendChild(QuicksCHECKBOX1)
               QuickROW.appendChild(QuicksNUMBOX1)
               // end ************************************** selector
               trimTick = document.createElement('input')
               trimTick.classList.add('trimTick')
               trimTick.value = tickrData.tkr.toUpperCase() || 0;
               trimTick.setAttribute('data-arg6',QRTR.qID)
               trimTick.setAttribute('data-arg7',tickrData.tkr.toUpperCase()) 
               trimTick.addEventListener("focus",(e)=>{ 
                  // if not expanded expand, reload.
                  let qID2 = e.target.getAttribute('data-arg6');
                  let tkr2 = e.target.getAttribute('data-arg7');
                  let qtr = ai_main.qrtrz[qID2];
                  for(let i=0; i< qtr.tickrz.length;i++){
                     if(qtr.tickrz[i].tkr===tkr2){
                        if(!qtr.tickrz[i].expanded){
                           qtr.tickrz[i].expanded = true;
                           //SAVE to LOCAL STORAGE
                           localStorage.ai_main = JSON.stringify(ai_main) 
                           generateQuickClick(); //RELOAD VIEW.  
                           showErrorMSG('⚔️ SAVED ⚔️');                             
                        }
                        break;
                     }
                  }
 
               });
               trimTick.addEventListener("keyup",(e)=>{ 
                  let localSaveBtn = e.target.parentElement.nextSibling.children[3].children[0]
                  localSaveBtn.style.display = 'flex';
                  // saveBtn0.style.display = 'flex';
               });             
               capBOX1 = document.createElement('aside')
               capBOX1.innerHTML="CAP&nbsp";
               capBOX1.classList.add('inputDATABOX1')
               capData1 = document.createElement('input')
               capData1.classList.add('inputDATA0')
               capData1.placeholder = "$0";
               // capData1.readOnly = true;
               capData1.value = tickrData.cap || '';    
               capData1.setAttribute('data-arg6',QRTR.qID)
               capData1.setAttribute('data-arg7',tickrData.tkr.toUpperCase())                     
               capData1.addEventListener("focus",(e)=>{ 
                  // if not expanded expand, reload.
                  let qID2 = e.target.getAttribute('data-arg6');
                  let tkr2 = e.target.getAttribute('data-arg7');
                  let qtr = ai_main.qrtrz[qID2];
                  for(let i=0; i< qtr.tickrz.length;i++){
                     if(qtr.tickrz[i].tkr===tkr2){
                        if(!qtr.tickrz[i].expanded){
                           qtr.tickrz[i].expanded = true;
                           //SAVE to LOCAL STORAGE
                           localStorage.ai_main = JSON.stringify(ai_main) 
                           generateQuickClick(); //RELOAD VIEW.  
                           showErrorMSG('⚔️ SAVED ⚔️');                            
                        }
                        break;
                     }
                  }
               });

               capData1.addEventListener("keyup",(e)=>{ 
                  let localSaveBtn = e.target.parentElement.parentElement.nextSibling.children[3].children[0]
                  localSaveBtn.style.display = 'flex';                 
               });  

               // expandBtn1.addEventListener("click",(e)=>{
               //    expandQuickTicksClick( //EXPAND TICK SUB DETAILS.
               //       e.target.getAttribute('data-arg6'),
               //       e.target.getAttribute('data-arg7'))                
               capBOX1.appendChild(capData1)
               
               trimTOTBOX1 = document.createElement('aside')
               trimTOTBOX1.innerHTML="trims&nbsp";
               trimTOTBOX1.classList.add('inputDATABOX2')
               trimTOTBOX1.classList.add('greenTXT')
               trimTOTData1 = document.createElement('input')
               trimTOTData1.classList.add('inputDATA0')
               trimTOTData1.placeholder = "$0";
               trimTOTData1.readOnly = true;
               trimTOTData1.value = tickrData.trimTOT || '';          
               trimTOTBOX1.appendChild(trimTOTData1)
               padTOTBOX1 = document.createElement('aside')
               padTOTBOX1.innerHTML="pads&nbsp";
               padTOTBOX1.classList.add('inputDATABOX3')
               padTOTBOX1.classList.add('redTXT')
               padTOTData1 = document.createElement('input')
               padTOTData1.classList.add('inputDATA0')
               padTOTData1.placeholder = "$0";
               padTOTData1.readOnly = true;
               padTOTData1.value = tickrData.padTOT || '';          
               padTOTBOX1.appendChild(padTOTData1)
               netAMTBOX1 = document.createElement('aside')
               netAMTBOX1.innerHTML="NET&nbsp";
               netAMTBOX1.classList.add('inputDATABOX4')
               netAMTData1 = document.createElement('input')
               netAMTData1.classList.add('inputDATA0')
               netAMTData1.placeholder = "0";
               netAMTData1.readOnly = true;
               netAMTData1.value = tickrData.netAMT || '';          
               netAMTBOX1.appendChild(netAMTData1)

               expandBtn1 = document.createElement('button')
               expandBtn1.innerHTML = '🕸️'
               expandBtn1.classList.add('addBtn6')
               expandBtn1.setAttribute('data-arg6',QRTR.qID)
               expandBtn1.setAttribute('data-arg7',tickrData.tkr.toUpperCase())
               expandBtn1.addEventListener("click",(e)=>{
                  expandQuickTicksClick( //EXPAND TICK SUB DETAILS.
                     e.target.getAttribute('data-arg6'),
                     e.target.getAttribute('data-arg7')) 
                  });

               QuickROW.appendChild(trimTick)         
               QuickROW.appendChild(capBOX1)         
               QuickROW.appendChild(trimTOTBOX1)         
               QuickROW.appendChild(padTOTBOX1)         
               QuickROW.appendChild(netAMTBOX1)         
               QuickROW.appendChild(expandBtn1)
               tickerRowBOX.appendChild(QuickROW)

               if(tickrData.expanded){ //BEGIN DETAILS VIEW
                  expandBtn1.innerHTML = '💨'
                  //BEGIN btnz ROW ***********************************
                  btnzROW = document.createElement('section')
                  btnzROW.classList.add('btnzROW')
                     editTitle = document.createElement('input')
                     editTitle.value = 'TRADE';
                     editTitle.readOnly = true;
                     editTitle.classList.add('detailDate1')
                     btnzROW.appendChild(editTitle)
                     quickTrimBtn0 = document.createElement('button')
                     quickTrimBtn0.innerHTML = 'trim🐇'
                     quickTrimBtn0.classList.add('editBtn01')
                     quickTrimBtn0.addEventListener("click",(e)=>{
                        //show save row and set edit type
                        let saveROW = e.target.parentElement.nextSibling;
                        saveROW.editType = 'trim' 
                        saveROW.style.display = 'flex';
                        e.target.style.border = '3px solid lime'     
                        e.target.nextSibling.style.border = 'none'     
                     });
                     btnzROW.appendChild(quickTrimBtn0)
                     quickPadBtn0 = document.createElement('button')
                     quickPadBtn0.innerHTML = 'pad🐒'
                     quickPadBtn0.classList.add('editBtn02')
                     quickPadBtn0.addEventListener("click",(e)=>{
                        let saveROW = e.target.parentElement.nextSibling;
                        saveROW.editType = 'pad'  
                        saveROW.style.display = 'flex';
                        e.target.style.border = '3px solid crimson' 
                        e.target.previousSibling.style.border = 'none'
                     });
                     btnzROW.appendChild(quickPadBtn0)
                     saveBOX1 = document.createElement('aside')
                     saveBOX1.innerHTML="&nbsp";
                     saveBOX1.classList.add('saveBOX1')
                     saveBtn0 = document.createElement('button')
                     saveBtn0.id = 'saveBtn0'
                     saveBtn0.innerHTML = 'save🌟'
                     saveBtn0.classList.add('saveBtn0')
                     saveBtn0.setAttribute('data-arg6',QRTR.qID)
                     saveBtn0.setAttribute('data-arg7',tickrData.tkr.toUpperCase())
                     saveBtn0.addEventListener("click",(e)=>{
                        saveBtn0.style.display = 'none'; 
                        //SAVE LOGIC
                        let qID1 = e.target.getAttribute('data-arg6');
                        let tkr1 = e.target.getAttribute('data-arg7'); 
                        let qtr = ai_main.qrtrz[qID1];
                        let titleROW = e.target.parentElement.parentElement.previousSibling
                        let tkr2 = titleROW.children[1].value;
                        let cap2 = titleROW.children[2].children[0].value;
                        let notez2 = e.target.parentElement.parentElement.nextSibling.nextSibling.nextSibling.children[2]
                        // let qtr = ai_main.qrtrz[qID1];
                        for(let x=0; i< qtr.tickrz.length;x++){
                           if(qtr.tickrz[x].tkr===tkr1){
                              qtr.tickrz[x].tkr = tkr2.toUpperCase();
                              qtr.tickrz[x].cap = cap2;
                              if(notez2){ //collapsed / expanded
                                 qtr.tickrz[x].notez = notez2.value;
                              }
                             break;
                           }
                        }
                        // //SAVE to LOCAL STORAGE
                        localStorage.ai_main = JSON.stringify(ai_main) 
                        generateQuickClick(); //RELOAD VIEW.  
                        showErrorMSG('⚔️ SAVED ⚔️');   
                     });
                     saveBOX1.appendChild(saveBtn0)
                     btnzROW.appendChild(saveBOX1)

                     
                  tickerRowBOX.appendChild(btnzROW) 
                  //END btnz ROW *******************************************
                  //BEGIN inputSAVE ROW
                  inputSAVEROW = document.createElement('section')
                  inputSAVEROW.classList.add('inputSAVEROW')
                     saveTitle = document.createElement('input')
                     saveTitle.value = 'SAVE';
                     saveTitle.readOnly = true;
                     saveTitle.classList.add('detailDate1')
                     // saveTitle.addEventListener("keyup",(e)=>{ 
                     //    saveQuickBtn1.style.display = 'block'; 
                     // });  
                     inputSAVEROW.appendChild(saveTitle)

                     tradeAMTBOX1 = document.createElement('aside')
                     tradeAMTBOX1.innerHTML="AMT&nbsp";
                     tradeAMTBOX1.classList.add('inputDATABOX0')
                     tradeAMTData1 = document.createElement('input')
                     tradeAMTData1.classList.add('inputDATA0')
                     tradeAMTData1.placeholder = "0";
                     // tradeAMTData1.value = tickrData.AMT || '';          
                     tradeAMTData1.addEventListener("keyup",(e)=>{ 
                        saveBtn03.style.display = 'flex'; 
                     });  
                     tradeAMTBOX1.appendChild(tradeAMTData1)
                     inputSAVEROW.appendChild(tradeAMTBOX1)
                     
                     date01 = document.createElement('input')
                     date01.value = current_ymd.split('YMD_')[1] 
                     date01.classList.add('detailDate1')
                     date01.addEventListener("keyup",(e)=>{ 
                        saveBtn03.style.display = 'flex'; 
                     });  
                     inputSAVEROW.appendChild(date01)

                     saveBOX2 = document.createElement('aside')
                     saveBOX2.innerHTML="&nbsp";
                     saveBOX2.classList.add('saveBOX1')
                     saveBtn03 = document.createElement('button')
                     saveBtn03.id = 'saveBtn03'
                     saveBtn03.innerHTML = 'save🎇'
                     saveBtn03.classList.add('saveBtn0')

                     saveBtn03.setAttribute('data-arg6',QRTR.qID)
                     saveBtn03.setAttribute('data-arg7',tickrData.tkr.toUpperCase())

                     saveBtn03.addEventListener("click",(e)=>{
                        //HIDE SHOW LOGIC.
                        let saveROW = e.target.parentElement.parentElement;
                        saveROW.style.display = 'none';
                        saveBtn03.style.display = 'none';
                        saveROW.previousSibling.children[1].style.border = "none"
                        saveROW.previousSibling.children[2].style.border = "none"

                        //SAVE LOGIC
                        let qID0 = e.target.getAttribute('data-arg6');
                        let tkr0 = e.target.getAttribute('data-arg7'); 
                        let val = e.target.parentElement.previousSibling.previousSibling.children[0].value;
                        let ymd = e.target.parentElement.previousSibling.value;
                        let qtr = ai_main.qrtrz[qID0];
                        for(let x=0; i< qtr.tickrz.length;x++){
                           if(qtr.tickrz[x].tkr===tkr0){
                              if(saveROW.editType==='trim'){
                                 qtr.tickrz[x].trimz.push(
                                    {"ymd":ymd,"amt":val,"role":""}
                                 )
                              } else if(saveROW.editType==='pad'){
                                 qtr.tickrz[x].padz.push(
                                    {"ymd":ymd,"amt":val,"role":""}
                                 )
                              }                              
                              break;
                           }
                        }
                        //SAVE to LOCAL STORAGE
                        localStorage.ai_main = JSON.stringify(ai_main) 
                        generateQuickClick(); //RELOAD VIEW.  
                        showErrorMSG('⚔️ SAVED ⚔️');                           
                     });
                     saveBOX2.appendChild(saveBtn03)
                     inputSAVEROW.appendChild(saveBOX2)

                  tickerRowBOX.appendChild(inputSAVEROW) 
                  //END inputSAVE ROW **************************
                  //BEGIN FIFO GRID ROW ***********************
                  fifoGRIDROW = document.createElement('section')
                  fifoGRIDROW.classList.add('fifoGRIDROW')
                     gridTitle = document.createElement('input')
                     gridTitle.value = 'fifo trim/pad grid';
                     gridTitle.classList.add('fifoTITLE1')
                     gridTitle.addEventListener("keyup",(e)=>{ 
                        saveBtn0.style.display = 'flex';
                     });  
                     fifoGRIDROW.appendChild(gridTitle)
                     
                     fifoGRIDBOX = document.createElement('section')
                     fifoGRIDBOX.classList.add('fifoGRIDBOX')

                     fifoROW = document.createElement('section')
                     fifoROW.classList.add('fifoBOX')
                     let longLength = 0,trimNUM=0,padNUM=0,trimYMD=0,padYMD=0;
                     longLength=(tickrData.trimz.length>=tickrData.padz.length)
                        ? tickrData.trimz.length : tickrData.padz.length
                     for(var k=0; k<longLength;k++ ){
                        if(k<tickrData.trimz.length){
                           trimNUM = tickrData.trimz[k].amt || 0;
                           trimYMD = tickrData.trimz[k].ymd || 0;
                        }else{ trimNUM='-'; trimYMD='-' }
                        if(k<tickrData.padz.length){
                           padNUM = tickrData.padz[k].amt || 0;
                           padYMD = tickrData.padz[k].ymd || 0;

                        }else{ padNUM='-'; padYMD='-' }
                        
                        fifoBOX = document.createElement('section')
                        fifoBOX.classList.add('fifoData')
                        dateTrim = document.createElement('input')
                        dateTrim.value = trimYMD;
                        dateTrim.classList.add('fifoTrimYMD')
                        dateTrim.addEventListener("keyup",(e)=>{ 
                           saveBtn0.style.display = 'flex';
                        });  
                        trimAMT = document.createElement('input')
                        trimAMT.value = trimNUM;
                        trimAMT.classList.add('fifoTrimNUM')
                        trimAMT.addEventListener("keyup",(e)=>{ 
                           saveBtn0.style.display = 'flex';
                        });  
                        padAMT = document.createElement('input')
                        padAMT.value = padNUM;
                        padAMT.classList.add('fifoPadNUM')
                        padAMT.addEventListener("keyup",(e)=>{ 
                           saveBtn0.style.display = 'flex';
                        });  
                        datePad = document.createElement('input')
                        datePad.value = padYMD;
                        datePad.classList.add('fifoPadYMD')
                        datePad.addEventListener("keyup",(e)=>{ 
                           saveBtn0.style.display = 'flex';
                        });  
                        fifoBOX.appendChild(dateTrim)
                        fifoBOX.appendChild(trimAMT)
                        fifoBOX.appendChild(padAMT)
                        fifoBOX.appendChild(datePad)
                        fifoROW.appendChild(fifoBOX)
                     }
                     fifoGRIDBOX.appendChild(fifoROW)
                     fifoGRIDROW.appendChild(fifoGRIDBOX)

                  tickerRowBOX.appendChild(fifoGRIDROW) 
                  //END FIFO GRID ROW ************************                  
                  //BEGIN tickrNOTEZ ROW ***********************
                  tickrNOTEZROW = document.createElement('section')
                  tickrNOTEZROW.classList.add('tickrNOTEZROW')
                     notezTitle = document.createElement('input')
                     notezTitle.value = 'NOTES';
                     notezTitle.readOnly = true;
                     notezTitle.classList.add('detailDate1')
                     // notezTitle.addEventListener("keyup",(e)=>{ 
                     //    saveBtn0.style.display = 'block';
                     // });  
                     tickrNOTEZROW.appendChild(notezTitle)
                     expandBtn02 = document.createElement('button')
                     expandBtn02.innerHTML = '🕸️'
                     expandBtn02.classList.add('addBtn7')
                     expandBtn02.setAttribute('data-arg6',QRTR.qID)
                     expandBtn02.setAttribute('data-arg7',tickrData.tkr.toUpperCase())
                     expandBtn02.addEventListener("click",(e)=>{
                        expandQuickNotezClick(
                           e.target.getAttribute('data-arg6'),
                           e.target.getAttribute('data-arg7')) 
                     });
                     tickrNOTEZROW.appendChild(expandBtn02)
                     if(tickrData.notez_expanded){ //expand Notes VIEW 
                        expandBtn02.innerHTML = '💨'    
                        //STORY_TXT AREA
                        tickrNOTEZTXT = document.createElement('textarea')
                        tickrNOTEZTXT.id = 'notezTXTArea'
                        tickrNOTEZTXT.classList.add('scrollBarV')
                        tickrNOTEZTXT.classList.add('textareaBOX2')
                        tickrNOTEZTXT.spellcheck = false;
                        tickrNOTEZTXT.value = tickrData.notez || '';
                        tickrNOTEZTXT.addEventListener("keyup",(e)=>{ 
                           saveBtn0.style.display = 'flex';
                           // e.target.parentElement.children[4].classList.remove('hiddenBtn1')
                        }); 
                        
                        tickrNOTEZROW.appendChild(tickrNOTEZTXT)
                     }
                  tickerRowBOX.appendChild(tickrNOTEZROW) 
                  //END tickrNOTEZ ROW *******************************
               }  //END DETAILS VIEW
            } //END MONTHLY LOOP
         } else {QRTR.expanded = false;}//END EXPANDED
         quarterBOX.appendChild(tickerRowBOX)
         generatedQuickBOX.appendChild(quarterBOX)
      } //END QUARTERLY LOOP
   }else{
      expandCollapseBtn0.innerHTML = '🕸️'   
   }//END if collapsed view
} //end generate Quick 2
generateQuickClick();

const copyQuickQrtrClick = ()=>{ 
   let last_qtr = '',temp_ticks=[];
   let ai_name = 'Q' + qtrNUM + '_' + yearNUM + '_' + monthSHORT;
   //GET input value
   if(!ai_name){ showErrorMSG('🎀No data🎀'); return; }
   ai_name = ai_name.toUpperCase();
   if(ai_main.qrtrz[ai_name]){ 
      showErrorMSG('🖖duplicate🤙'); return; 
   }

   last_qtr = Object.keys(ai_main.qrtrz).reverse()[0]
   temp_ticks = ai_main.qrtrz[last_qtr].tickrz;

   ai_main.qrtrz[ai_name] = {}
   ai_main.qrtrz[ai_name].qID = ai_name;
   ai_main.qrtrz[ai_name].tickrz = temp_ticks;
   ai_main.qrtrz[ai_name].expanded = false;

   //SAVE to LOCAL STORAGE
   localStorage.ai_main = JSON.stringify(ai_main) 
   generateQuickClick(); //RELOAD VIEW.  

   showErrorMSG('⚔️ ADDED ⚔️'); 

}

const addQuickSectionClick = ()=>{ 
   let QuickRow1,date1,tick1,amountData1;
   let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11;
   let saveBtn3,roleBOX,roleData,atBOX1,atData1;
   QuickRow1 = document.createElement('article')
   QuickRow1.classList.add('QuickRow1')
   saveBtn3 = document.createElement('button')
   tick1 = document.createElement('input')
   // tick1.value = "";
   tick1.value = 'Q'+qtrNUM + '_' + yearNUM + '_' + monthSHORT;//"Q#_YYYY_JAN"
   tick1.classList.add('quarterTXT')
   saveBtn3.innerHTML = 'save🌟'
   saveBtn3.classList.add('saveBtn2')
   saveBtn3.addEventListener("click",(e)=>{
      saveNewQuickQuarterClick(e) 
   });

   QuickRow1.appendChild(tick1)
   QuickRow1.appendChild(saveBtn3)
   generatedQuickBOX.appendChild(QuickRow1)

} //end add Quick click

const addQuickTickerClick = (qID) =>{
   // saveQuickClick();//FIX: save first for bug on double create row, keeps first row tickr.
   //go to parent quarter and add a unique row
   let newQuickTick = {}
   let qtr = ai_main.qrtrz[qID]; //lookup
   if(!qtr){return}
   qtr.expanded = true;
   newQuickTick.tkr = "NEW";
   newQuickTick.cap = "1000";
   newQuickTick.expanded = true;
   newQuickTick.notez = "replace...";
   newQuickTick.trimz = [];
   newQuickTick.padz = [];

   ai_main.qrtrz[qID].tickrz.push(newQuickTick)

   // encodeBOX.scrollIntoView({
   // behavior: 'smooth',
   // block: 'start'})
   //SAVE to LOCAL STORAGE
   // localStorage.ai_main = JSON.stringify(ai_main) 
   generateQuickClick(); //RELOAD VIEW.  
   showErrorMSG('⚔️ SAVED ⚔️');    
}

/************************************************
* Add Quarters 
/************************************************/
const addQuickQtrClick = (quarterID) =>{
   debugger;
   //go to parent quarter and add a unique row
   // let newCap = {}
   // let qtr = ai_schedule.quarters[quarterID]; //lookup
   // if(!qtr){return}
   //    qtr.expanded = true;
   //    newCap.cap = "1000";
   //    newCap.crashlvl = "2";
   //    newCap.pad_at = "100";
   //    newCap.padlvl = "1";
   //    newCap.tkr = "NEW";
   //    newCap.trim_at = "100";
   // qtr.caps.push(newCap)
   //   //SAVE to LOCAL STORAGE
   //   localStorage.ai_schedule = JSON.stringify(ai_schedule) 
   //   generateScheduleClick(); //RELOAD VIEW.  
      showErrorMSG('⚔️ SAVED ⚔️');    
}

/************************************************
* END Add Quarters 
/************************************************/
const saveNewQuickQuarterClick = (e)=>{ 
   //GET input value
   let keyInput = e.target.parentElement.children[0].value;
   if(!keyInput){ showErrorMSG('🎀No data🎀'); return; }
   keyInput = keyInput.toUpperCase();
   if(ai_main.qrtrz[keyInput]){ 
      e.target.parentElement.style.display = 'none'
      showErrorMSG('🖖duplicate🤙'); return; }
   
   ai_main.qrtrz[keyInput] = {}
   ai_main.qrtrz[keyInput].qID = keyInput;
   ai_main.qrtrz[keyInput].tickrz = [];
   ai_main.qrtrz[keyInput].expanded = false;

   //SAVE to LOCAL STORAGE
   localStorage.ai_main = JSON.stringify(ai_main) 
   generateQuickClick(); //RELOAD VIEW.  

   showErrorMSG('⚔️ ADDED ⚔️');          
}

const saveQuickQtrClick = (e)=>{ 
   debugger;
   //GET input value
   let keyInput = e.target.parentElement.children[0].value;
   if(!keyInput){ showErrorMSG('🎀No data🎀'); return; }
   keyInput = keyInput.toUpperCase();
   if(ai_schedule[keyInput]){ showErrorMSG('🖖duplicate🤙'); return; }
   
   ai_schedule.quarters[keyInput] = {}
   ai_schedule.quarters[keyInput].qID = keyInput;
   ai_schedule.quarters[keyInput].caps = [];
   ai_schedule.quarters[keyInput].monthData = [];

   //SAVE to LOCAL STORAGE
   localStorage.ai_schedule = JSON.stringify(ai_schedule) 
   generateQuickClick(); //RELOAD VIEW.  

   showErrorMSG('⚔️ ADDED ⚔️');          
}

const saveQuickClick = ()=>{ // GENERATE PROFIT AND LOSS DISPLAY
   debugger;
saveQuickBtn1.style.display = 'none'; 
   let quarterBoxes = generatedQuickBOX.children,row,kids,kid;
   // let tkr,cap,trim_at,pad_at,padlvl,crashlvl;
   // let date3,type3,amt3,role3;
   // let capData,trimDetail, expand1;
   // let qtrTXT,dataBox1,dataBox2,qtrBOX, CAPMonth;
   let save_Quick = {quarters:{}};
try{     
      for(var i=0; i<quarterBoxes.length;i++){ //LOOP QUARTER BOX
      qtrBOX = quarterBoxes[i];
      if(qtrBOX.classList.contains('QuickQuarterBOX')){
         kids = qtrBOX.children;
         for(var j=0;j<kids.length;j++){ //MONTH LOOP
            kid = kids[j];
            if(kid.classList.contains('quarterHeader')){ 
               qtrTXT = kid.children[0].value;
               save_Quick.quarters[qtrTXT] = {qID:qtrTXT}
               expand1 = (kid.children[2].innerHTML==='v')? true : false;
               save_Quick.quarters[qtrTXT].expanded = expand1;
               QuickMonth = save_Quick.quarters[qtrTXT]
               QuickMonth.caps = [];
               QuickMonth.monthData = []
            }
            if(kid.classList.contains('tickerRowBOX')){
               if(kid.children.length===0){ // NO tickerRowBOX data, COLLAPSED.
                  save_schedule.quarters[qtrTXT] = ai_schedule.quarters[qtrTXT]
                  continue; //DO NOT SAVE, use saved data, since it is collapsed.
               } 
               for(var k=0; k<kid.children.length;k++){ //POPULATE DATA from VIEW.
                  row = kid.children[k]
                  if(row.classList.contains('capROW')){ 
                     QuickData = {};//, trimData = {};
                     for(var mm = 0; mm<row.children.length;mm++){
                        dataBox1 = row.children[mm]
                        if(dataBox1.classList.contains('trimTick')){
                           dataBox1.value = dataBox1.value.toUpperCase();                     
                           QuickData.tkr = dataBox1.value;
                           tkr = QuickData.tkr;
                        }
                        else if(dataBox1.classList.contains('inputDATABOX1')){
                           QuickData.cap = dataBox1.children[0].value
                        }
                        else if(dataBox1.classList.contains('inputDATABOX2')){
                           // QuickData.trim_at = dataBox1.children[0].value
                        }
                        else if(dataBox1.classList.contains('inputDATABOX3')){
                           // QuickData.pad_at = dataBox1.children[0].value
                        }
                        else if(dataBox1.classList.contains('inputDATABOX4')){
                           // QuickData.padlvl = dataBox1.children[0].value
                        }
                        // else if(dataBox1.classList.contains('inputDATABOX5')){
                        //    QuickData.crashlvl = dataBox1.children[0].value
                        // }
                     }
                  } //end Quick row
            
                  else if(row.classList.contains('detailRow2')){  
                     trimData = {}; 
                     for(var mm = 0; mm<row.children.length;mm++){
                        dataBox2 = row.children[mm];
                        if(dataBox2.classList.contains('detailDate1')){
                           trimData.ymd = dataBox2.value
                           trimData.tick = tkr //important load.
                        }
                        if(dataBox2.classList.contains('typeBOX1')){
                           trimData.type = dataBox2.children[0].value.toLowerCase()
                        }
                        if(dataBox2.classList.contains('amtBOX1')){
                           trimData.amt = dataBox2.children[0].value
                        }
                        if(dataBox2.classList.contains('roleBOX1')){
                           trimData.role = dataBox2.children[0].value
                        }
                     }
                  } // end details row
      
                  // if(capData.tkr && CAPMonth && CAPMonth.caps){
                  if(QuickData.tkr){
                     QuickMonth.caps.push(QuickData);
                     QuickData = {}
                  }
                  // if (trimData.type && CAPMonth && CAPMonth.monthData){
                  // if(!show_Quick_details_view){   //could move out of loop, below.
                  if(true){ //todo
                     CAPMonth.monthData = ai_schedule.quarters[qtrTXT].monthData
                  }                            
                  else if (trimData.type){
                     QuickMonth.monthData.push(trimData)
                     trimData = {}
                  }

               } //END QuickS ROW.
            } //END EXPANDED tickerRowBOX
         } //MONTH LOOP
         // if(!show_Quick_details_view){   //could move out of loop, below.
         //             QuickMonth.monthData = ai_schedule.quarters[qtrTXT].monthData
         //          }  
         } // IF QUARTER 
      } //END QUARTER BOX LOOP
   } catch(e){
      console.log('err in save')
      showErrorMSG('⚔️ ERR ⚔️'); 
      return;
   }
   if(save_Quick){
      //SAVE to LOCAL STORAGE
      ai_schedule = save_Quick;
      localStorage.ai_schedule = JSON.stringify(ai_schedule) 
      generateQuickClick(); //RELOAD VIEW.  
      showErrorMSG('⚔️ SAVED ⚔️');
   }
}     //end save Quick click        

const ExpandCollapseQuickClick = ()=>{
   ai_ledger.quick_expanded = !ai_ledger.quick_expanded;
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   generateQuickClick(); //RELOAD VIEW. 
   showErrorMSG('⚔️ SAVED ⚔️');     
}

const expandQuickTickerClick = (qID)=>{ //expand or collapse section
   ai_main.qrtrz[qID].expanded = !ai_main.qrtrz[qID].expanded;
      //SAVE to LOCAL STORAGE
   localStorage.ai_main = JSON.stringify(ai_main) 
   generateQuickClick(); //RELOAD VIEW.  
   showErrorMSG('⚔️ SAVED ⚔️');   
}
const expandQuickTicksClick = (qID,tkr)=>{ //expand or collapse section
   let qtr = ai_main.qrtrz[qID];
   for(let i=0; i< qtr.tickrz.length;i++){
      if(qtr.tickrz[i].tkr===tkr){
         qtr.tickrz[i].expanded = !qtr.tickrz[i].expanded
         break;
      }
   }
   //SAVE to LOCAL STORAGE
   localStorage.ai_main = JSON.stringify(ai_main) 
   generateQuickClick(); //RELOAD VIEW.  
   showErrorMSG('⚔️ SAVED ⚔️');   
}
const expandQuickNotezClick = (qID,tkr)=>{ //expand or collapse section
   let qtr = ai_main.qrtrz[qID];
   for(let i=0; i< qtr.tickrz.length;i++){
      if(qtr.tickrz[i].tkr===tkr){
         qtr.tickrz[i].notez_expanded = !qtr.tickrz[i].notez_expanded
         break;
      }
   }
   //SAVE to LOCAL STORAGE
   localStorage.ai_main = JSON.stringify(ai_main) 
   generateQuickClick(); //RELOAD VIEW.  
   showErrorMSG('⚔️ SAVED ⚔️');   
}

const deleteSelectedQuick = (e)=>{
   let qtr_selected = null,qtr=null,temp=[],TKR='';
   let items = document.getElementsByClassName('quick_checkmark');
   for(let i=0; i<items.length;i++){
      if(items[i].checked){
         items[i].checked = false;
         qtr_selected = items[i]
         TKR = qtr_selected.TKR;
         if(qtr_selected && !TKR && ai_main.qrtrz[qtr_selected.qID]){
            delete ai_main.qrtrz[qtr_selected.qID];
            break;
         } else if (TKR){ //delete sub item
            for(let idx=0; idx<ai_main.qrtrz[qtr_selected.qID].tickrz.length;idx++){
               if(ai_main.qrtrz[qtr_selected.qID].tickrz[idx].tkr != TKR){ //do not delete
                  temp.push(ai_main.qrtrz[qtr_selected.qID].tickrz[idx]);
               } 
            }  
            ai_main.qrtrz[qtr_selected.qID].tickrz = temp; //skip delete item       
         }
         break;
      }
   }
   if(!qtr_selected){showErrorMSG(' Nothing selected 😵') 
      return;}   
   localStorage.ai_main = JSON.stringify(ai_main) //SAVE to LOCAL STORAGE
   generateQuickClick(); //RELOAD VIEW. 
}
/***************************************
 * END: QUICKFUNCTIONS
 * **************************************/
      
/***************************************
 * MARGINS
 * **************************************/
let show_margin_details_view = false;
const setMarginDetailsClick = (e)=>{
   ai_ledger.margin_expanded = true;
   if(e.target.id==='detailsBtn1'){
      totalsBtn1.style.display='block'
      show_margin_details_view = true;
   }else{
      totalsBtn1.style.display='none'               
      show_margin_details_view = false;
   }
   allMarginsBOX.scrollIntoView({
   behavior: 'smooth',
   block: 'start'})
   generateMarginsClick();
}

// const initMarginsClick = ()=>{
//    ai_ledger.margin_expanded = true; 
//    generateMarginsClick();
// }

let ai_MetaData_TickMap={}; //todo rename ai_MetaData_TickMap also separate generation into marginGeneration.
const generateMarginsClick = ()=>{ // GENERATE Margin DISPLAY
   let ticker,spot_ticker,tickerBOX1,tickerSet=[],spotSet=[],numSPOTS=0;
   let numSPOT1, marginsRow1, profitRow1,curPrice1;
   generatedMarginsBOX.innerHTML = ""; //reset view
   generatedProfitsBOX.innerHTML = ""; //reset view //todo refactor
   if(show_margin_details_view){
      detailsBtn1.style.display = 'none'; //hide details
   }else{
      detailsBtn1.style.display='block' //show details btn
   }
   tickerSet = ai_ledger.ticks;
   spotSet = ai_ledger.spots;
   //TICKER INIT - iterator METADATA factory (generator)
   for(let i=0;i<tickerSet.length;i++){
      ticker= tickerSet[i];
      if(ticker.tick ){ // INIT META DATA obj
         ai_MetaData_TickMap[ticker.tick] = {};
         ai_MetaData_TickMap[ticker.tick].num = 0;
         ai_MetaData_TickMap[ticker.tick].curr_price = (ticker.price || 0);
         ai_MetaData_TickMap[ticker.tick].sum_spot_amt = 0;
         ai_MetaData_TickMap[ticker.tick].total_val = 0;
      }
   }
   //SPOT - iterator - calculate - METADATA generator
   for(let i=0;i<spotSet.length;i++){
      spot_ticker= spotSet[i];
      if(!ai_MetaData_TickMap[spot_ticker.tick]){ continue }
      ai_MetaData_TickMap[spot_ticker.tick].num++;
      ai_MetaData_TickMap[spot_ticker.tick].sum_spot_amt =
         parseInt(ai_MetaData_TickMap[spot_ticker.tick].sum_spot_amt) + parseInt(spot_ticker.amount || 0);               
      ai_MetaData_TickMap[spot_ticker.tick].total_val += parseInt(spot_ticker.spot_at || 0);               
   }
   //SPOT - CALCULATE SPOT MARGIN
   let curr_price, total_val,sum_spot_amt, spot_num, spot_margin, margin_pct, avg_price;
   for(let i=0;i<tickerSet.length;i++){
      ticker= tickerSet[i];
      if(!ai_MetaData_TickMap[ticker.tick]){ continue }
      spot_num = ai_MetaData_TickMap[ticker.tick].num;
      curr_price = ai_MetaData_TickMap[ticker.tick].curr_price;
      sum_spot_amt = ai_MetaData_TickMap[ticker.tick].sum_spot_amt;
      total_val = ai_MetaData_TickMap[ticker.tick].total_val;
      margin_pct = 0;
      if(curr_price && spot_num && total_val){
         avg_price = total_val / spot_num;
         avg_price = avg_price.toFixed(0);//round number 
         spot_margin = curr_price - avg_price; //CALCULATE SPOT MARGIN
         ai_MetaData_TickMap[ticker.tick].margin = spot_margin || 0;
         ai_MetaData_TickMap[ticker.tick].avg_price = avg_price || 0;
      }
      if(spot_margin){
         margin_pct = spot_margin / avg_price * 100;
         ai_MetaData_TickMap[ticker.tick].margin_pct = margin_pct;
      }
   }

   let avgPrice1,detailRow1;
   //DISPLAY - iterator
   if(ai_ledger.margin_expanded){
      expandCollapseBtn3.innerHTML = '💨'      
      for(let i=0;i<tickerSet.length;i++){
         ticker= tickerSet[i];
         
         if(!ai_MetaData_TickMap[ticker.tick]){continue;}
         if(!ai_MetaData_TickMap[ticker.tick].num){continue;}
         marginsRow1 = document.createElement('section')
         marginsRow1.classList.add('marginsRow1')
         profitRow1 = document.createElement('section')
         profitRow1.classList.add('profitRow1')
         tickerBOX1 = document.createElement('aside')
         tickerBOX1.classList.add('proTick1')
         tickerBOX1.innerHTML = ticker.tick;
         numSPOT1 = document.createElement('aside')
         numSPOT1.classList.add('proSpots1')
         curPrice1 = document.createElement('aside')
         curPrice1.classList.add('curPrice1')
         curPrice1.innerHTML =  'last: '+ai_MetaData_TickMap[ticker.tick].curr_price || 0;
         avgPrice1 = document.createElement('aside')
         avgPrice1.classList.add('avgPrice1')
         avgPrice1.innerHTML =  'avg: '+ai_MetaData_TickMap[ticker.tick].avg_price || 0;
         numMargin1 = document.createElement('aside')
         numMargin1.classList.add('proMargin1')
         numPCT1 = document.createElement('aside')
         numPCT1.classList.add('proPCT1')
         numTotalAmt1 = document.createElement('aside')
         numTotalAmt1.classList.add('proTotalAmt1')
         numTotalAmt1.innerHTML = 'sum: '+ai_MetaData_TickMap[ticker.tick].sum_spot_amt || 0;
         numSPOTS = (ai_MetaData_TickMap[ticker.tick] && ai_MetaData_TickMap[ticker.tick].num)?
            ai_MetaData_TickMap[ticker.tick].num:0;
         numSPOT1.innerHTML = 'spots: '+ numSPOTS;
         numMargin1.innerHTML = `margin: 
            ${( ai_MetaData_TickMap[ticker.tick].margin>0 )?'+':''}
            ${ai_MetaData_TickMap[ticker.tick].margin}`
         numPCT1.innerHTML = `pct: 
            ${( ai_MetaData_TickMap[ticker.tick].margin>0 )?'+':''}
            ${ai_MetaData_TickMap[ticker.tick].margin_pct.toFixed(0)}%`;

         marginsRow1.appendChild(tickerBOX1)         
         marginsRow1.appendChild(numSPOT1)         
         marginsRow1.appendChild(numTotalAmt1)         
         marginsRow1.appendChild(avgPrice1)         
         marginsRow1.appendChild(curPrice1)         
         marginsRow1.appendChild(numMargin1)         
         marginsRow1.appendChild(numPCT1)         
         generatedMarginsBOX.appendChild(marginsRow1)         

         if(show_margin_details_view){ //BEGIN DETAILS VIEW
            //loop over spots of and display detailRow.
            let spotObj,spotDate1,spotAmt1,spotPrice1;
            let spotMargin2=0,spotPCT2=0,curr_price2;
            for(var j=0; j<ai_ledger.spots.length;j++){
               spotObj = ai_ledger.spots[j];
               if(spotObj.tick != ticker.tick){continue}
               detailRow1 = document.createElement('section')
               detailRow1.classList.add('detailRow1')

               //CALCULATE individual SPOT MARGIN
               curr_price2 = ai_MetaData_TickMap[ticker.tick].curr_price;
               spotMargin2 = curr_price2 - spotObj.spot_at
               spotPCT2 = (spotMargin2/spotObj.spot_at) * 100 
               // spotPCT2 = spotPCT2.toFixed(0);

               spotDate1 = document.createElement('aside')
               spotDate1.classList.add('spotDate1')
               spotDate1.innerHTML = spotObj.ymd || 0;

               spotAmt1 = document.createElement('aside')
               spotAmt1.classList.add('spotAmt1')
               spotAmt1.innerHTML =  'amt '+spotObj.amount || 0;

               spotPrice1 = document.createElement('aside')
               spotPrice1.classList.add('spotPrice1')
               spotPrice1.innerHTML =  'price '+spotObj.spot_at || 0;

               spotMargin1 = document.createElement('aside')
               spotMargin1.classList.add('spotMargin1')
               // spotMargin1.innerHTML =  'margin '+spotMargin2 || 0;
               spotMargin1.innerHTML = `margin: 
                  ${(spotMargin2>0 )?'+':''}${spotMargin2}`                  

               spotPCT1 = document.createElement('aside')
               spotPCT1.classList.add('spotPCT1')
               // spotPCT1.innerHTML =  'pct '+ spotPCT2 || 0;
               spotPCT1.innerHTML = `pct: 
                  ${(spotPCT2>0 )?'+':''}
                  ${spotPCT2.toFixed(0)}%`;                  

               detailRow1.appendChild(spotDate1)         
               detailRow1.appendChild(spotAmt1)         
               detailRow1.appendChild(spotPrice1)         
               detailRow1.appendChild(spotMargin1)         
               detailRow1.appendChild(spotPCT1)

               generatedMarginsBOX.appendChild(detailRow1)   
            }
         } //END DETAILS VIEW
      }//END DISPLAY LOOP
   }//END if collapsed
} //END generate margins click

const assetsExpandCollapseClick = ()=>{
   ai_ledger.asset_expanded = !ai_ledger.asset_expanded;
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   initEncode(); //RELOAD VIEW.   
   showErrorMSG('⚔️ SAVED ⚔️');     
}
const spotsExpandCollapseClick = ()=>{
   ai_ledger.spot_expanded = !ai_ledger.spot_expanded;
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   initDecode(); //RELOAD VIEW.   
   showErrorMSG('⚔️ SAVED ⚔️');     
}
const marginsExpandCollapseClick = ()=>{
   ai_ledger.margin_expanded = !ai_ledger.margin_expanded;
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   generateMarginsClick(); //RELOAD VIEW. 
   showErrorMSG('⚔️ SAVED ⚔️');     
}
const capsExpandCollapseClick = ()=>{
   ai_ledger.caps_expanded = !ai_ledger.caps_expanded;
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   generateScheduleClick(); //RELOAD VIEW. 
   showErrorMSG('⚔️ SAVED ⚔️');     
}
const eventzExpandCollapseClick = ()=>{
   ai_ledger.eventz_expanded = !ai_ledger.eventz_expanded;
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   generateEVTZClick(); //RELOAD VIEW. 
   showErrorMSG('⚔️ SAVED ⚔️');     
}
const storyzExpandCollapseClick = ()=>{
   ai_ledger.storyz_expanded = !ai_ledger.storyz_expanded;
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   generateStoryClick(); //RELOAD VIEW. 
   showErrorMSG('⚔️ SAVED ⚔️');     
}
const totalzExpandCollapseClick = ()=>{
   ai_ledger.totalz_expanded = !ai_ledger.totalz_expanded;
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   generateProfitLossClick(); //RELOAD VIEW. 
   showErrorMSG('⚔️ SAVED ⚔️');     
}

const expandCAPClick = (qID)=>{ //expand or collapse section
   let qtr = ai_schedule.quarters[qID];
   qtr.expanded = !qtr.expanded;
      //SAVE to LOCAL STORAGE
   localStorage.ai_schedule = JSON.stringify(ai_schedule) 
   generateScheduleClick(); //RELOAD VIEW.  
   showErrorMSG('⚔️ SAVED ⚔️');   
}

const expandEventzClick = (qID)=>{ //expand or collapse section
   let evtz;// = ai_eventz//.quarters[qID];
   for(var i=0;i<ai_eventz.length;i++){
      evtz = ai_eventz[i];
      if(evtz && evtz.qID && qID===evtz.qID.toString()){
         evtz.expanded = !evtz.expanded;
      }
   }
      //SAVE to LOCAL STORAGE
   localStorage.ai_eventz = JSON.stringify(ai_eventz) 
   generateEVTZClick(); //RELOAD VIEW.  
   showErrorMSG('🌠 SAVED 🌠');   
}


const generateEVTZClick = ()=>{
   eventzFRAME.innerHTML="";//blank out
   let eventzSet = ai_eventz, eventz;
   if(ai_ledger.eventz_expanded){
      expandCollapseBtn5.innerHTML = '💨'   
      for(var i=0; i<eventzSet.length;i++){
         eventz = eventzSet[i];
         eventz.qID = i+1;
         eventzBOX = document.createElement('section')
         eventzBOX.classList.add('eventzBOX')
         eventzBOX.qID = i+1;

         eventzHeader = document.createElement('aside')
         eventzHeader.classList.add('eventzHeader')

         //**********************************************selector
         eventzNUM0 = document.createElement('div');
         eventzNUM0.classList.add('eventzNUM1')
         eventzNUM0.innerHTML = "m"+(i+1);
         eventzNUMBOX0 = document.createElement('span')
         eventzNUMBOX0.classList.add('eventzNUMBOX0');
         eventzCHECKBOX0 = document.createElement('label')
         eventzCHECKBOX0.classList.add('checkboxFrame') 
         eventzSelect0 = document.createElement('input');
         eventzSelect0.qID = i+1;//eventz.qID || '';
         eventzSelect0.type = "radio";
         eventzSelect0.name = "eventzMasterRadio";
         eventzSelect0.classList.add('cap_checkmark') //todo
         eventzCHECKBOX0.appendChild(eventzSelect0)
         eventzCheckMark0 = document.createElement('span')
         eventzCheckMark0.classList.add('checkmark')
         eventzCHECKBOX0.appendChild(eventzCheckMark0)
         eventzNUMBOX0.appendChild(eventzCHECKBOX0)
         eventzNUMBOX0.appendChild(eventzNUM0)
         // end ************************************** selector

         eventzTXT = document.createElement('input')
         eventzTXT.classList.add('eventzTXT')
         eventzTXT.value = eventz.title;
         // eventzTXT.value = eventz.tkr.toUpperCase() +"_"+eventz.type.toUpperCase()+"_"+ yearNUM;//.eventzID.toUpperCase();
         eventzTXT.addEventListener("keyup",(e)=>{ evtzSaveBtn5.style.display = 'block'; 
            }); 

         expandBtn1 = document.createElement('button')
         expandBtn1.innerHTML = '🕸️'
         expandBtn1.classList.add('addBtn4')
         expandBtn1.setAttribute('data-arg3',i+1);//eventz.qID)
         expandBtn1.addEventListener("click",(e)=>{
               expandEventzClick(e.target.getAttribute('data-arg3')) });
         addBtn4 = document.createElement('button')
         addBtn4.innerHTML = 'addEventz📅';
         addBtn4.classList.add('addBtn4')
         addBtn4.setAttribute('data-arg2',i+1);//eventz.qID)
         addBtn4.addEventListener("click",(e)=>{
               addEVTZClick(e.target.getAttribute('data-arg2')) });

               eventzHeader.appendChild(eventzNUMBOX0)
            eventzHeader.appendChild(eventzTXT)
            eventzHeader.appendChild(expandBtn1)
            eventzHeader.appendChild(addBtn4)
         eventzBOX.appendChild(eventzHeader)
         if(eventz.expanded){
            expandBtn1.innerHTML = '💨'
            if(!eventz.evtz){eventz.evtz=[]}
            for(let j=0;j<eventz.evtz.length;j++){  //SUBLIST LOOP .
               eventzData = eventz.evtz[j];
               eventzData.eID = j+1;
               eventzROW = document.createElement('aside')
               eventzROW.classList.add('eventzROW')
               //**********************************************selector
               eventzNUM1 = document.createElement('div');
               eventzNUM1.classList.add('eventzNUM1')
               eventzNUM1.innerHTML = "e"+(j+1);
               eventzNUMBOX1 = document.createElement('aside')
               eventzNUMBOX1.classList.add('capsNUMBOX3');
               eventzCHECKBOX1 = document.createElement('label')
               eventzCHECKBOX1.classList.add('checkboxFrame') 
               // eventzNUMBOX1.innerHTML=i+1;            
               eventzSelect1 = document.createElement('input');
               eventzSelect1.eID = j+1;//eventzData.eID || '';
               eventzSelect1.type = "radio";
               eventzSelect1.name = "eventzDetailsRadio";
               eventzSelect1.classList.add('cap_checkmark') //todo
               eventzCHECKBOX1.appendChild(eventzSelect1)
               eventzCheckMark1 = document.createElement('span')
               eventzCheckMark1.classList.add('checkmark')
               eventzCHECKBOX1.appendChild(eventzCheckMark1)
               eventzNUMBOX1.appendChild(eventzCHECKBOX1)
               eventzNUMBOX1.appendChild(eventzNUM1)
               eventzROW.appendChild(eventzNUMBOX1)
               // end ************************************** selector
               //EVENT_TITLE
               eventzTitle = document.createElement('input')
               eventzTitle.classList.add('eventzTitle')
               eventzTitle.value = eventzData.title || 0;
               eventzTitle.addEventListener("keyup",(e)=>{ evtzSaveBtn5.style.display = 'block'; 
               });                
               //EVENT_TYPE
               typeBOX = document.createElement('aside')
               typeBOX.innerHTML="type&nbsp;"
               // typeBOX = document.createElement('aside')
               // typeBOX.innerHTML="type&nbsp;"
               typeData = document.createElement('select')
               // typeData = document.createElement('input')
               type1 = document.createElement('option')
               type2 = document.createElement('option')
               type3 = document.createElement('option')
               type4 = document.createElement('option')
               type5 = document.createElement('option')
               type6 = document.createElement('option')
               type7 = document.createElement('option')
               type8 = document.createElement('option')
               type9 = document.createElement('option')
               type10 = document.createElement('option')
               type11 = document.createElement('option')
               type12 = document.createElement('option')
               type1.value = "...";
               type2.value = "WARN";
               type3.value = "PAD1";
               type4.value = "PAD2";
               type5.value = "PAD3";
               type6.value = "PAD4";
               type7.value = "PAD5";
               type8.value = "BLKSWAN";
               type9.value = "BREAK";
               type10.value = "LOrLO";
               type11.value = "HIrHI";
               type12.value = "LiQD8";
               type1.innerHTML = "...";
               type2.innerHTML = "WARN";
               type3.innerHTML = "PAD1";
               type4.innerHTML = "PAD2";
               type5.innerHTML = "PAD3";
               type6.innerHTML = "PAD4";
               type7.innerHTML = "PAD5";
               type8.innerHTML = "BLKSWAN";
               type9.innerHTML = "BREAK";
               type10.innerHTML = "LOrLO";
               type11.innerHTML = "HIrHI";
               type12.innerHTML = "LiQD8";
               typeData.appendChild(type1);
               typeData.appendChild(type2);
               typeData.appendChild(type3);
               typeData.appendChild(type4);
               typeData.appendChild(type5);
               typeData.appendChild(type6);
               typeData.appendChild(type7);
               typeData.appendChild(type8);
               typeData.appendChild(type9);
               typeData.appendChild(type10);
               typeData.appendChild(type11);
               typeData.appendChild(type12);
               typeData.value = eventzData.type || '...';
               typeBOX.appendChild(typeData)
               
               typeData.addEventListener("change",(e)=>{ evtzSaveBtn5.style.display = 'block'; 
               });  
               typeBOX.classList.add('eventzTypeBOX1')
            
               // if(monthData.type==='trim'){
               //    typeData.classList.add('typeTRIMColor')
               // } else if (monthData.type==='pad'){
               //    typeData.classList.add('typePADColor')
               // }
               typeData.classList.add('eventzTypeData1')

               //EVENT_RANGE
               rangeData = document.createElement('input')
               rangeData.value = eventzData.range || '';
               rangeData.classList.add('eventzTypeData1')
               rangeData.addEventListener("keyup",(e)=>{ evtzSaveBtn5.style.display = 'block'; 
            });                 
            rangeBOX = document.createElement('aside')
            rangeBOX.innerHTML="range&nbsp;"
            rangeBOX.classList.add('eventzTypeBOX2')
            rangeBOX.style.width = '10em'
            rangeBOX.appendChild(rangeData)
            //EVENT_SPOT
            spotTxt = document.createElement('span')
            spotTxt.innerHTML="&nbsp;@&nbsp;"
            spotAmt = document.createElement('input')
            spotAmt.value = eventzData.spot_amt || '0';
            spotAmt.classList.add('eventzTypeData2')
            spotAmt.addEventListener("keyup",(e)=>{ evtzSaveBtn5.style.display = 'block'; 
            });                 
            spotPOS = document.createElement('input')
            spotPOS.value = eventzData.spot_POS || '0';
            spotPOS.classList.add('eventzTypeData2')
            spotPOS.addEventListener("keyup",(e)=>{ evtzSaveBtn5.style.display = 'block'; 
            });                 
            spotBOX = document.createElement('aside')
            spotBOX.innerHTML="$&nbsp;"
            spotBOX.appendChild(spotAmt)
            spotBOX.appendChild(spotTxt)
            spotBOX.appendChild(spotPOS)
            spotBOX.style.width = '12em'
            spotBOX.classList.add('eventzTypeBOX3')
            //EVENT_DATE
            date1 = document.createElement('input')
            date1.value = eventzData.ymd;
            date1.classList.add('detailDate2')
            date1.addEventListener("keyup",(e)=>{ evtzSaveBtn5.style.display = 'block'; 
            });  

            eventzROW.appendChild(eventzTitle)
            eventzROW.appendChild(typeBOX)
            eventzROW.appendChild(rangeBOX)
            eventzROW.appendChild(spotBOX)
            eventzROW.appendChild(date1)
            eventzBOX.appendChild(eventzROW)

            } //END DETAILS LOOP
         } else {eventz.expanded = false;}//END EXPANDED
         eventzFRAME.appendChild(eventzBOX)
      }//END eventz loop
   }//END if collapsed view
}//end generate EVENTZ

/************************************************\
 * - AI_STORYZ_MATRIX
 *  - ability to save quarterly NOTES in localstorage
\************************************************/
let ai_storyz=null;
const ai_storyz_LOAD_MOCK_DATA=()=>{ //READ
   // ai_storyz = [{"sID":1,"title":"Q4_2023_OCT","expanded":true,"txtz":[{"tID":1,"title":"Review OCT","type":"Review","txt":"nx1","ymd":"2023_12_13"},{"tID":2,"title":"222","txt":"nx2","ymd":"2023_12_13"},{"sID":"1","tID":3,"title":"new story","type":"...","txt":"tell story here","ymd":"2023_12_18"},{"sID":"1","tID":4,"title":"new story","type":"...","txt":"tell story here","ymd":"2023_12_18"}]},{"sID":2,"title":"Q4_2023_NOV","txtz":[{"tID":1,"title":"Review NOV","type":"Review","txt":"nx3","ymd":"2023_12_13"},{"tID":2,"title":"333","txt":"nx4","ymd":"2023_12_13"}],"expanded":false},{"sID":3,"title":"Q4_2023_DEC","txtz":[{"tID":1,"title":"Preview DEC","type":"Preview","txt":"nx5","ymd":"2023_12_13"},{"tID":2,"title":"444","txt":"nx6","ymd":"2023_12_13"}],"expanded":false},{"expanded":true,"sID":4,"title":"Q#_YEAR_JAN","type":"...","txtz":[{"tID":1,"title":"new","txt":"describe...","ymd":"2023_12_18"}]}]
   ai_storyz = [{"title":"Q4_2023_OCT","expanded":false,"sID":1,"txtz":[{"tID":1,"title":"Review OCT","ymd":"2023_12_13","txt":"OCT Dreary MOOD. Bears rule roost shouting about 5% 10yr.\nChanting recession - that never comes. Because 5% is TOP.\nOCT 27th was BOTTOM for NVDA. BTC predicts Rally.\n\"Soft landing\" uncertain. \n // RSI, MOM, VOL, BOLL, VIX, DIXY, 10yr, 2yr.","eID":1}]},{"title":"Q4_2023_NOV","expanded":false,"sID":2,"txtz":[{"tID":1,"title":"Review NOV","ymd":"2023_12_13","txt":"2023_NOV_END: flipflop fear to greed. 32 to 66. \n  \"Highly Schitzophrenic breaks fever to bullish\" \n   As soft landing is confirmed and false narrative silenced.\n   SEASONAL: RISK_OFF OCT to RISK_ON NOV. \n   Market Focus on \"Magnificent 7\".\n   CPI shows low inflation. 9.1 to 3.2.\n   Upside surprise to pros, best month of year, \n10 yr from 5.5 to 4.4.\n   TAILWIND: Priced in Inflation as tamed. Must stay low.\n   HEADWIND: It can change on geo political events.\n   Avoided Headwinds: gov shutdown 2x. labor disputes 2x.  War contagen 2x. \n   PROBABLE SOFT LANDING. Market driver 10yr not earning.\n   RESISTANCE lvls at: S&P 4,600, GOOG 337, NVDA 500.\n   F/G:Fear back to pre covid levels. Oil down. VIX low. Goldilocks.\n   Winners: Mag7 & ai. \n   Losers Housing and energy, ISM.\n   Tailwinds: Bears in Bond market, get record return to end nov.\n   consumers give record black friday.\n   NOTE: SHORTSQUEEZE on COIN and MDB. Maybe others.\n   NOTE: Earning POPS for ... AMD.\n   ORDERS:\n   TRIMMED AGGRESSIVELY. GOAL: 20% cash. SUCCESS!\n   MILESTONES: \n   - multiple 52 week highs.\n   - after adding MARGINS to all spots.\n   - added CAPz for TICKerz to trim and pad. \n   - With TRIM SCHEDULE.\n   - Fed debates RATE_CUT!!! Goldilocks.  Exhuberance in air.\n   Q/A: Friday selloff done? ISM recovery? Housing recovery? \n   Energy recovery? Healthcare recovery?","eID":1}]},{"title":"Q4_2023_DEC","expanded":true,"sID":3,"txtz":[{"tID":1,"title":"MID_DEC","ymd":"2023_12_13","txt":"   NOTE: mid dec 2023 \"as goldilocks as you can get\"\n   bear thesis destroyed. no recession. massive pivot 15th\n   holiday rally. 2 weeks to go before new year.\n  VIX all time lows. Markets all time highs. Trim aggressively.\n   Cashing tops consistently/automatically. \n   Greed to excessive greed. Then pullback.\n   8 straight positive weeks. 9 day win streak ends on 2% air pocket DEC_20: Flash Crash -2% in 1hr. Trim SUCCESS at TOP!\nNext Day Rebound.\nBITCOIN predicts S&P 3 times - 2wks to 8 days. Both run and crash.\nFLASHPOINTS - COINBASE and BITCOIN:\n1 ShortSqueeze for christmas. Padding COIN.\n2 BTC EFT for NEWYEAR. Padding BTC.\n3 Halvening for BTC 2nd Qtr APRIL.\nBOTH ACCOUNTS FINALLY TRANSFER from SCHWAB to ROBINHOOD 35,000BAL.","eID":1}]},{"title":"Q1_2024_JAN","expanded":false,"sID":4,"txtz":[{"tID":1,"title":"new","ymd":"2023_12_21","txt":"describe...","eID":1}]}]
}

const ai_storyz_init=()=>{ //READ from LOCAL STORAGE
   ai_storyz = (localStorage.ai_storyz)?
      JSON.parse( localStorage.ai_storyz ):null;
   // ai_storyz = null; //test mock data
   if(!ai_storyz){
      ai_storyz_LOAD_MOCK_DATA();
   }
}; ai_storyz_init();

   const expandStoryzClick = (sID)=>{ //expand or collapse section
      let stryz;// = ai_eventz//.quarters[qID];
      for(var i=0;i<ai_storyz.length;i++){
         stryz = ai_storyz[i];
         if(sID===stryz.sID.toString()){
            stryz.expanded = !stryz.expanded;
         }
      }
         //SAVE to LOCAL STORAGE
      localStorage.ai_storyz = JSON.stringify(ai_storyz) 
      generateStoryClick(); //RELOAD VIEW.  
      showErrorMSG('📓 SAVED 📓');   
   }

   const addStoryBOXClick = (storyBOXID) =>{
         // saveScheduleClick();//FIX: save first for bug on double create row, keeps first row tickr.
         ai_ledger.storyz_expanded = true;
         let newStory = {}
            newStory.expanded = true;
            newStory.sID = ai_storyz.length+1;
            newStory.title = "Q#_YEAR_JAN";
            newStory.type = "...";
            newStory.txtz = [
               {tID:1,title:'new',
               txt:'describe...',
               ymd: current_ymd.split('YMD_')[1] 
            }]
            ai_storyz.push(newStory)
           //SAVE to LOCAL STORAGE
           localStorage.ai_storyz = JSON.stringify(ai_storyz) 
           generateStoryClick(); //RELOAD VIEW.  
           showErrorMSG('⚔️ SAVED ⚔️');    
   }

   const addStoryzClick = (storyBOXID) =>{
   // saveEVTZClick();//FIX: save first for bug on double create row, keeps first row tickr.
   let newStory = {}
   let aStory = ai_storyz[storyBOXID-1];
   if(!aStory){return} //get existing to add SUB TXT 
      newStory.sID = storyBOXID;
      newStory.tID = aStory.txtz.length+1;
      newStory.title = "new story";
      newStory.type = "...";
      newStory.txt = "tell story here";
      newStory.ymd =  current_ymd.split('YMD_')[1];//user display
      aStory.txtz.push(newStory)
      //SAVE to LOCAL STORAGE
      localStorage.ai_storyz = JSON.stringify(ai_storyz) 
      generateStoryClick(); //RELOAD VIEW.  
      showErrorMSG('⛏ SAVED ⛏');     
}  

const storyzDeleteClick = (storyBOXID) =>{
   let storyzSelected = [], detSelected=[], temp = [], removeChildRow=false;
   let storyzChecks = document.getElementsByName("storyzMasterRadio");
   let detChecks = document.getElementsByName("storyzDetailsRadio");
   for(let i=0; i<storyzChecks.length;i++){
      if(storyzChecks[i].checked){ //SORT THROUGH ai_storyz to delete data and reload
         let sID = storyzChecks[i].sID;
         storyzSelected.push(storyzChecks[i])
         for(var j=0; j<ai_storyz.length;j++){ //DELETE storyz DATA
            if( sID.toString() === ai_storyz[j].sID.toString() ){
               ai_storyz.splice(j,1) //remove data
               break;
            }
         }
         //SAVE & RELOAD VIEW
         showErrorMSG('🦕 Saved. ');
         localStorage.ai_storyz = JSON.stringify(ai_storyz) //SAVE to LOCAL STORAGE
         generateStoryClick(); //RELOAD VIEW. 
         break;
      }
   }
   if(!storyzSelected.length && detChecks.length){ // DETAIL ROW SELECTION
      for(let j=0; j<detChecks.length;j++){
         if(detChecks[j].checked){
            detSelected.push(detChecks[j])
            let tID = detChecks[j].tID
            let sID = detChecks[j].parentElement.parentElement.parentElement.parentElement.sID;
            for(var k=0; k<ai_storyz.length;k++){ //DELETE MONTH DATA
               if(ai_storyz[k].sID===sID){
                  for(var m=0; m<ai_storyz[k].txtz.length;m++){ //DELETE MONTH DATA
                     if( tID === ai_storyz[k].txtz[m].tID ){       
                        ai_storyz[k].txtz.splice(m,1) //remove data
                        break;
                     }
                  }
               }
            }
            //SAVE & RELOAD VIEW
            showErrorMSG(' Saved🦖 ');
            localStorage.ai_storyz = JSON.stringify(ai_storyz) //SAVE to LOCAL STORAGE
            generateStoryClick(); //RELOAD VIEW. 
            break;
         }
      }
   } 
   if(!storyzSelected.length && !detSelected.length){showErrorMSG(' Nothing selected 😵'); return;}
} //end storyz delete

const storyzSaveClick = () => {
   let storyzBoxes = document.getElementById('storyzFRAME').children
   let rowItem,kids,kid;
   let saveTGT;
   let storyTXT;
   let save_storyz = [], save_story={};
   try{     
      for(var i=0; i<storyzBoxes.length;i++){ //LOOP QUARTER BOX
         storyBOX = storyzBoxes[i];
      if(storyBOX.classList.contains('storyzBOX')){
         kids = storyBOX.children;
         for(var j=0;j<kids.length;j++){ //ROW of storyz LOOP
            kid = kids[j];
            save_story = {}; //new object
            if(kid.classList.contains('storyzHeader')){ 
               storyTXT = kid.children[1].value.toUpperCase();
               storyREF = kid.children[1].uID;
               saveTGT = {title:storyTXT}
               expand1 = (kid.children[2].innerHTML === '💨')? true : false;
               saveTGT.expanded = expand1;
               //GET EVENT
               for(let aa=0; aa<ai_storyz.length; aa++){
                  if(storyREF===ai_storyz[aa].title){
                     saveTGT.sID = aa+1; //ai_storyz[aa].qID ||
                     saveTGT.title = storyTXT;
                     if(saveTGT.expanded){
                        saveTGT.txtz = [];
                     } else {
                        saveTGT.txtz = ai_storyz[aa].txtz;
                     }
                     break;
                  }
               }
            } // END HEADER
            else if(kid.id==='storyzROW'){
               for(var k=0; k<kid.children.length;k++){ //POPULATE DATA from VIEW.
                  rowItem = kid.children[k]
                  if(rowItem.id==='storyzNUMBOX1'){
                     save_story.tID = rowItem.children[0].children[0].tID
                  }
                  else if(rowItem.id==='storyzTitle'){
                     save_story.title = rowItem.value;
                  }
                  else if(rowItem.id=== 'storyzDate1'){
                     save_story.ymd = rowItem.value;
                  }
                  else if(rowItem.id === 'storyzTXTArea'){
                     save_story.txt = rowItem.value
                  }
               } //END ROW DATA
               saveTGT.txtz.push(save_story)
            } //end storyz ROW
         } // ROW of storyz LOOP
         save_storyz.push( saveTGT )
         } // IF storyzBOX
      } //END storyz BOX LOOP
   } //end TRY
   catch(e){
      console.log('err in save',e)
      showErrorMSG('⚔️ ERR ⚔️'); 
      return;
   }
   if(save_storyz){
      //SAVE to LOCAL STORAGE
      ai_storyz = save_storyz;
      localStorage.ai_storyz = JSON.stringify(ai_storyz) 
      generateStoryClick(); //RELOAD VIEW.  
      showErrorMSG('⚔️ SAVED ⚔️');
   }  
} //end storyz save click

const generateStoryClick = () =>{
   storyzFRAME.innerHTML="";//blank out
   let storyzSet = ai_storyz, storyz;
   if(ai_ledger.storyz_expanded){
      expandCollapseBtn6.innerHTML = '💨'   
      for(var i=0; i<storyzSet.length;i++){
         storyz = storyzSet[i];

         storyzBOX = document.createElement('section')
         storyzBOX.sID = i+1;
         storyz.sID = i+1;
         storyzBOX.classList.add('storyzBOX')

         storyzHeader = document.createElement('aside')
         storyzHeader.classList.add('storyzHeader')

         //**********************************************selector
         storyzNUM0 = document.createElement('div');
         storyzNUM0.classList.add('eventzNUM1')
         storyzNUM0.innerHTML = "s"+(i+1);
         storyzNUMBOX0 = document.createElement('aside')
         storyzNUMBOX0.classList.add('capsNUMBOX0');
         storyzCHECKBOX0 = document.createElement('label')
         storyzCHECKBOX0.classList.add('checkboxFrame') 
         storyzSelect0 = document.createElement('input');
         storyzSelect0.type = "radio";
         storyzSelect0.name = "storyzMasterRadio";
         storyzSelect0.sID = i+1;
         storyzSelect0.classList.add('storyz_checkmark')
         storyzCHECKBOX0.appendChild(storyzSelect0)
         storyzCheckMark0 = document.createElement('span')
         storyzCheckMark0.classList.add('checkmark')
         storyzCHECKBOX0.appendChild(storyzCheckMark0)
         storyzNUMBOX0.appendChild(storyzCHECKBOX0)
         storyzNUMBOX0.appendChild(storyzNUM0)
         // storyzHeader.appendChild(storyzNUMBOX0)
         // end ************************************** selector

         storyzTITLE = document.createElement('input')
         storyzTITLE.classList.add('storyzTITLE')
         storyzTITLE.placeholder="Q#_YYYY_JAN"
         storyzTITLE.value = storyz.title.toUpperCase();//.storyzID.toUpperCase();
         storyzTITLE.uID = storyzTITLE.value;//for unique ref.
         storyzTITLE.addEventListener("keyup",(e)=>{ 
            e.target.parentElement.children[4].classList.remove('hiddenBtn1')
         }); 

         expandBtn1 = document.createElement('button')
         expandBtn1.innerHTML = '🕸️'
         expandBtn1.classList.add('addBtn4')
         expandBtn1.setAttribute('data-arg3',storyz.sID)
         expandBtn1.addEventListener("click",(e)=>{
               expandStoryzClick(e.target.getAttribute('data-arg3')) });

         addBtn5 = document.createElement('button')
         addBtn5.innerHTML = 'addTXTz🍿';
         addBtn5.classList.add('addBtn4')
         addBtn5.setAttribute('data-arg5',storyz.sID)
         addBtn5.addEventListener("click",(e)=>{
               addStoryzClick(e.target.getAttribute('data-arg5')) 
            });

         //STORY_HEADER_SAVE_BTNs
         storyzHeaderSaveBTN = document.createElement('button')
         storyzHeaderSaveBTN.classList.add('storyzHeaderSaveBtn1')
         storyzHeaderSaveBTN.classList.add('hiddenBtn1')
         storyzHeaderSaveBTN.innerHTML = 'save🎁';//storyzData.title || 0;
         storyzHeaderSaveBTN.addEventListener("click",(e)=>{ 
            storyzSaveClick(e); 
         });          
               
         storyzHeader.appendChild(storyzNUMBOX0)
         storyzHeader.appendChild(storyzTITLE)
         storyzHeader.appendChild(expandBtn1)
         storyzHeader.appendChild(addBtn5)               
         storyzHeader.appendChild(storyzHeaderSaveBTN)               
         storyzBOX.appendChild(storyzHeader)

         if(storyz.expanded){
            expandBtn1.innerHTML = '💨'
            if(storyz.txtz){
               for(let j=0;j<storyz.txtz.length;j++){  //SUBLIST LOOP .
               storyzData = storyz.txtz[j];
               storyzData.eID = j+1;
               storyzROW = document.createElement('aside')
               storyzROW.id = 'storyzROW';
               storyzROW.classList.add('eventzROW')
               //**********************************************selector
               storyzNUM1 = document.createElement('div');
               storyzNUM1.classList.add('eventzNUM1')
               // storyzNUM1.eID = 
               storyzNUM1.innerHTML = "e"+(j+1);
               storyzNUMBOX1 = document.createElement('aside')
               storyzNUMBOX1.classList.add('capsNUMBOX3');
               storyzNUMBOX1.id = 'storyzNUMBOX1';
               storyzCHECKBOX1 = document.createElement('label')
               storyzCHECKBOX1.classList.add('checkboxFrame') 
               storyzSelect1 = document.createElement('input');
               storyzSelect1.id = 'storyzSelect1';
               storyzSelect1.tID = j+1;
               storyzSelect1.type = "radio";
               storyzSelect1.name = "storyzDetailsRadio";
               storyzSelect1.classList.add('storyz_checkmark')
               storyzCHECKBOX1.appendChild(storyzSelect1)
               storyzCheckMark1 = document.createElement('span')
               storyzCheckMark1.classList.add('checkmark')
               storyzCHECKBOX1.appendChild(storyzCheckMark1)
               storyzNUMBOX1.appendChild(storyzCHECKBOX1)
               storyzNUMBOX1.appendChild(storyzNUM1)
               storyzROW.appendChild(storyzNUMBOX1)
               // end ************************************** selector
               //STORY_SUB_TITLE
               storyzTitle = document.createElement('input')
               storyzTitle.id = 'storyzTitle';
               storyzTitle.classList.add('eventzTitle')
               storyzTitle.value = storyzData.title || 0;
               storyzTitle.addEventListener("keyup",(e)=>{ 
                  e.target.parentElement.children[4].classList.remove('hiddenBtn1')
               });     
               
               //STORY_TXT AREA
               storyzTXTBOX = document.createElement('textarea')
               storyzTXTBOX.id = 'storyzTXTArea'
               storyzTXTBOX.classList.add('scrollBarV')
               storyzTXTBOX.classList.add('textareaBOX')
               storyzTXTBOX.spellcheck = false;
               storyzTXTBOX.value = storyz.txtz[j].txt;//'abc';//storyzData.title || 0;
               storyzTXTBOX.addEventListener("keyup",(e)=>{ 
                  e.target.parentElement.children[4].classList.remove('hiddenBtn1')
               }); 
               
               //EVENT_DATE
               date1 = document.createElement('input')
               date1.id = 'storyzDate1'
               date1.value = storyzData.ymd;
               date1.classList.add('detailDate2')
               date1.addEventListener("keyup",(e)=>{ 
                  e.target.parentElement.children[4].classList.remove('hiddenBtn1')
               });                 

               //STORY_SAVE_BTNs
               storyzSaveBTN = document.createElement('button')
               storyzSaveBTN.classList.add('genReportBtn1')
               storyzSaveBTN.classList.add('hiddenBtn1')
               storyzSaveBTN.innerHTML = 'save🎁';//storyzData.title || 0;
               storyzSaveBTN.addEventListener("click",(e)=>{ 
                  storyzSaveClick(e); 
               });                

            storyzROW.appendChild(storyzTitle)
            storyzROW.appendChild(date1)
            storyzROW.appendChild(storyzTXTBOX)
            storyzROW.appendChild(storyzSaveBTN)
            storyzBOX.appendChild(storyzROW)

            }} //END ROW LOOP DETAILS and if
         } else {storyz.expanded = false;}//END EXPANDED
         storyzFRAME.appendChild(storyzBOX)
      // } //END QUARTERLY LOOP
      }//END storyz loop
   }//END if collapsed view
}//END generate Preview of STORYz click

const getLatestTickerClick = ()=>{ //loop all for last close.
   let item,urls=[];
   for(let i=0;i<ai_ledger.ticks.length;i++){
      // if(i>=1){continue;}//DEV_limiter stay below 20
      item = ai_ledger.ticks[i];
      // item.tick = 'NVDA';//DEV_specifier 
      urls.push(`https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${item.tick}&interval=5min&apikey=${stock_api_key}`)
   }
   getData_Quotes(urls)
   showErrorMSG('🌼DATA UPDATED🌼') //todo error. need show message not error.

}

/**************************************************************\
 * MSGS : interface
 * \***********************************************************/
   let stateErrorBox = document.getElementById('errorBox');
   let stateSavedBox = document.getElementById('savedBox');
   let stateCopiedBox = document.getElementById('copiedBox');


/**************************************************************\
 * API : interface
 * \***********************************************************/
const getData_Quotes = async (quotes)=>{
   if(!stock_api_key){ showErrorMSG('🛠️ connect api'); return;}
   if(!quotes.length){return;}
   try{
      for(let i=0; i<quotes.length;i++){
         fetch(quotes[i]).then((data)=>{
            if(data.ok){
               return data.json();
            }
         }).then((tickData)=>{
            let responseTick = tickData["Meta Data"]["2. Symbol"];
            if(!responseTick){return;}
            let latestClose = tickData["Time Series (5min)"][Object.keys(tickData["Time Series (5min)"])[0]]["4. close"];
            if(!latestClose){return;}
            console.log(responseTick,"last close",latestClose)
            updateLatestTickPrice(responseTick,latestClose);
            //SHOW CONNNECTED and CAP, hide disconnected and key input
            stateConnectedBox.style.display = "inline";
            stateNotConnectedBox.style.display = "none";   
            keyBOX.style.display = "none"; 
            latestBtn1.style.display = "none"; //do not call twice. because of limit
            localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
            initEncode(); //RELOAD VIEW. 

         }).catch((error)=>{
            showErrorMSG('🛠️ api daily limit')
            console.log(error)
         })
      }
   } catch(error) {
         showErrorMSG('🛠️ api down')
   }           
}
const getData_TestConnection = ()=>{
   if(!stock_api_key){
      showErrorMSG('🛠️ connect api')
      return;}
      //SHOW CONNNECTED and CAP, hide disconnected and key input
      stateConnectedBox.style.display = "inline";
      stateNotConnectedBox.style.display = "none";   
      keyBOX.style.display = "none"; 
      latestBtn1.style.display = "inline";
}

const getData_Intraday = ()=>{
   if(!stock_api_key){return;}
      const symbol = 'NVDA';
      const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${symbol}&interval=5min&apikey=${stock_api_key}`;
      fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
            //SHOW CONNNECTED and CAP, hide disconnected and key input
            stateConnectedBox.style.display = "inline";
            stateNotConnectedBox.style.display = "none";   
            symbolBOX.style.display = "inline";
            keyBOX.style.display = "none"; 
            // Process the data here (e.g., extract the latest stock price)
            const latestPrice = data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]]['1. open'];
         //data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]]['1. open'];
         // data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]];
         // {1. open: '175.3700', 2. high: '175.3700', 3. low: '175.0000', 4. close: '175.0000', 5. volume: '24782'}
            console.log(`Latest price for ${symbol}: ${latestPrice}`);
      })
      .catch(error => {
            console.error('Error fetching data:', error);
      });         
}

function updateLatestTickPrice(responseTick,latestClose){
   //loop ai_ledger, update price and latest label.
   let tickr='',item=null;
   for(let i=0; i<ai_ledger.ticks.length;i++){
      tickr=ai_ledger.ticks[i];
      if(tickr.tick===responseTick){ //FOUND ticker record
         ai_ledger.ticks[i].price = latestClose.split('.')[0];
         ai_ledger.ticks[i].price_ymd = formatYMD();
         update_History_matrix(
            {tick:tickr.tick,
               ymd:ai_ledger.ticks[i].price_ymd,
               price: ai_ledger.ticks[i].price
            })
         break;
      }
   }
}

/************************************************\
 * - AI_HISTORY_MATRIX
 *  - ability to save in localstorage
\************************************************/
let ai_history_matrix=null;

const ai_history_LOAD_MOCK_DATA=()=>{ //READ from OBJ
   // ai_history_matrix = {'NVDA':{ymd_price:{'2023_11_01':'428'}}}
   // ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464"}}}
   // ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464","2023_11_11":"483"}},"V":{"ymd_price":{"2023_11_11":"245"}},"MSFT":{"ymd_price":{"2023_11_11":"369"}},"MDB":{"ymd_price":{"2023_11_11":"375"}},"XLK":{"ymd_price":{"2023_11_11":"179"}},"NDAQ":{"ymd_price":{"2023_11_11":"52"}},"AMD":{"ymd_price":{"2023_11_11":"118"}},"COST":{"ymd_price":{"2023_11_11":"576"}},"COIN":{"ymd_price":{"2023_11_11":"93"}},"QQQ":{"ymd_price":{"2023_11_11":"377"}},"GOOGL":{"ymd_price":{"2023_11_11":"132"}}}
   // ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464","2023_11_11":"483","2023_11_16":"488","2023_11_20":"493","2023_11_24":"477","2023_11_27":"477"}},"V":{"ymd_price":{"2023_11_11":"245","2023_11_16":"248","2023_11_20":"249","2023_11_24":"254","2023_11_27":"254"}},"MSFT":{"ymd_price":{"2023_11_11":"369","2023_11_16":"371","2023_11_20":"366","2023_11_24":"377","2023_11_27":"377"}},"MDB":{"ymd_price":{"2023_11_11":"375","2023_11_16":"391","2023_11_20":"392","2023_11_24":"407","2023_11_27":"407"}},"XLK":{"ymd_price":{"2023_11_11":"179","2023_11_16":"182","2023_11_20":"182","2023_11_24":"184","2023_11_27":"184"}},"NDAQ":{"ymd_price":{"2023_11_11":"52","2023_11_16":"52","2023_11_20":"53","2023_11_24":"55","2023_11_27":"55"}},"AMD":{"ymd_price":{"2023_11_11":"118","2023_11_16":"117","2023_11_20":"120","2023_11_24":"122","2023_11_27":"122"}},"COST":{"ymd_price":{"2023_11_11":"576","2023_11_16":"596","2023_11_20":"576","2023_11_24":"592","2023_11_27":"592"}},"COIN":{"ymd_price":{"2023_11_11":"93","2023_11_16":"99","2023_11_20":"98","2023_11_24":"115","2023_11_27":"115"}},"QQQ":{"ymd_price":{"2023_11_11":"377","2023_11_16":"385","2023_11_20":"385","2023_11_24":"389","2023_11_27":"389"}},"GOOGL":{"ymd_price":{"2023_11_11":"132","2023_11_16":"135","2023_11_20":"135","2023_11_24":"136","2023_11_27":"136"}}}
   // ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464","2023_11_11":"483","2023_11_16":"488","2023_11_20":"493","2023_11_24":"477","2023_11_27":"477","2023_11_28":"477","2023_11_30":"481","2023_12_01":"467"}},"V":{"ymd_price":{"2023_11_11":"245","2023_11_16":"248","2023_11_20":"249","2023_11_24":"254","2023_11_27":"254","2023_11_28":"253","2023_11_30":"254","2023_12_01":"256"}},"MSFT":{"ymd_price":{"2023_11_11":"369","2023_11_16":"371","2023_11_20":"366","2023_11_24":"377","2023_11_27":"377","2023_11_28":"382","2023_11_30":"379","2023_12_01":"374"}},"MDB":{"ymd_price":{"2023_11_11":"375","2023_11_16":"391","2023_11_20":"392","2023_11_24":"407","2023_11_27":"407","2023_11_28":"408","2023_11_30":"432","2023_12_01":"438"}},"XLK":{"ymd_price":{"2023_11_11":"179","2023_11_16":"182","2023_11_20":"182","2023_11_24":"184","2023_11_27":"184","2023_11_28":"184","2023_11_30":"184","2023_12_01":"185"}},"NDAQ":{"ymd_price":{"2023_11_11":"52","2023_11_16":"52","2023_11_20":"53","2023_11_24":"55","2023_11_27":"55","2023_11_28":"55","2023_11_30":"55"}},"AMD":{"ymd_price":{"2023_11_11":"118","2023_11_16":"117","2023_11_20":"120","2023_11_24":"122","2023_11_27":"122","2023_11_28":"122","2023_11_30":"124","2023_12_01":"121"}},"COST":{"ymd_price":{"2023_11_11":"576","2023_11_16":"596","2023_11_20":"576","2023_11_24":"592","2023_11_27":"592","2023_11_28":"594","2023_11_30":"587","2023_12_01":"596"}},"COIN":{"ymd_price":{"2023_11_11":"93","2023_11_16":"99","2023_11_20":"98","2023_11_24":"115","2023_11_27":"115","2023_11_28":"127","2023_11_30":"127","2023_12_01":"134"}},"QQQ":{"ymd_price":{"2023_11_11":"377","2023_11_16":"385","2023_11_20":"385","2023_11_24":"389","2023_11_27":"389","2023_11_28":"390","2023_11_30":"390","2023_12_01":"390"}},"GOOGL":{"ymd_price":{"2023_11_11":"132","2023_11_16":"135","2023_11_20":"135","2023_11_24":"136","2023_11_27":"136","2023_11_28":"137","2023_11_30":"135","2023_12_01":"131"}},"TSLA":{"ymd_price":{"2023_11_30":"245","2023_12_01":"238"}},"META":{"ymd_price":{"2023_11_30":"332","2023_12_01":"324"}}}
   // ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464","2023_11_11":"483","2023_11_16":"488","2023_11_20":"493","2023_11_24":"477","2023_11_27":"477","2023_11_28":"477","2023_11_30":"481","2023_12_01":"467","2023_12_07":"453","2023_12_08":"466","2023_12_11":"474","2023_12_14":"484","2023_12_15":"481","2023_12_20":"495","2023_12_21":"483"}},"V":{"ymd_price":{"2023_11_11":"245","2023_11_16":"248","2023_11_20":"249","2023_11_24":"254","2023_11_27":"254","2023_11_28":"253","2023_11_30":"254","2023_12_01":"256","2023_12_07":"254","2023_12_08":"255","2023_12_11":"255","2023_12_14":"262","2023_12_15":"259","2023_12_20":"259","2023_12_21":"257"}},"MSFT":{"ymd_price":{"2023_11_11":"369","2023_11_16":"371","2023_11_20":"366","2023_11_24":"377","2023_11_27":"377","2023_11_28":"382","2023_11_30":"379","2023_12_01":"374","2023_12_07":"368","2023_12_08":"370","2023_12_11":"373","2023_12_14":"375","2023_12_15":"366","2023_12_20":"373","2023_12_21":"371"}},"MDB":{"ymd_price":{"2023_11_11":"375","2023_11_16":"391","2023_11_20":"392","2023_11_24":"407","2023_11_27":"407","2023_11_28":"408","2023_11_30":"432","2023_12_01":"438","2023_12_07":"384","2023_12_08":"384","2023_12_11":"381","2023_12_14":"411","2023_12_15":"419","2023_12_20":"410","2023_12_21":"403"}},"XLK":{"ymd_price":{"2023_11_11":"179","2023_11_16":"182","2023_11_20":"182","2023_11_24":"184","2023_11_27":"184","2023_11_28":"184","2023_11_30":"184","2023_12_01":"185","2023_12_07":"182","2023_12_08":"185","2023_12_11":"186","2023_12_14":"191","2023_12_15":"190","2023_12_20":"192","2023_12_21":"189"}},"NDAQ":{"ymd_price":{"2023_11_11":"52","2023_11_16":"52","2023_11_20":"53","2023_11_24":"55","2023_11_27":"55","2023_11_28":"55","2023_11_30":"55"}},"AMD":{"ymd_price":{"2023_11_11":"118","2023_11_16":"117","2023_11_20":"120","2023_11_24":"122","2023_11_27":"122","2023_11_28":"122","2023_11_30":"124","2023_12_01":"121","2023_12_07":"118","2023_12_08":"128","2023_12_11":"129","2023_12_14":"138","2023_12_15":"137","2023_12_20":"139","2023_12_21":"135"}},"COST":{"ymd_price":{"2023_11_11":"576","2023_11_16":"596","2023_11_20":"576","2023_11_24":"592","2023_11_27":"592","2023_11_28":"594","2023_11_30":"587","2023_12_01":"596","2023_12_07":"603","2023_12_08":"610","2023_12_11":"611","2023_12_14":"642","2023_12_15":"639","2023_12_20":"677","2023_12_21":"662"}},"COIN":{"ymd_price":{"2023_11_11":"93","2023_11_16":"99","2023_11_20":"98","2023_11_24":"115","2023_11_27":"115","2023_11_28":"127","2023_11_30":"127","2023_12_01":"134","2023_12_07":"133","2023_12_08":"135","2023_12_11":"147","2023_12_14":"152","2023_12_15":"152","2023_12_20":"159","2023_12_21":"161"}},"QQQ":{"ymd_price":{"2023_11_11":"377","2023_11_16":"385","2023_11_20":"385","2023_11_24":"389","2023_11_27":"389","2023_11_28":"390","2023_11_30":"390","2023_12_01":"390","2023_12_07":"385","2023_12_08":"390","2023_12_11":"392","2023_12_14":"405","2023_12_15":"403","2023_12_20":"409","2023_12_21":"403"}},"GOOGL":{"ymd_price":{"2023_11_11":"132","2023_11_16":"135","2023_11_20":"135","2023_11_24":"136","2023_11_27":"136","2023_11_28":"137","2023_11_30":"135","2023_12_01":"131","2023_12_07":"131","2023_12_08":"137","2023_12_11":"134","2023_12_14":"133","2023_12_15":"131","2023_12_20":"136","2023_12_21":"138"}},"TSLA":{"ymd_price":{"2023_11_30":"245","2023_12_01":"238","2023_12_07":"240","2023_12_08":"242","2023_12_11":"243","2023_12_14":"239","2023_12_15":"250","2023_12_20":"257","2023_12_21":"248"}},"META":{"ymd_price":{"2023_11_30":"332","2023_12_01":"324","2023_12_07":"317","2023_12_08":"326","2023_12_11":"333","2023_12_14":"335","2023_12_15":"333","2023_12_20":"350","2023_12_21":"349"}},"PINS":{"ymd_price":{"2023_12_07":"33","2023_12_08":"34","2023_12_11":"34","2023_12_14":"36","2023_12_15":"36","2023_12_20":"38","2023_12_21":"37"}},"FVRR":{"ymd_price":{"2023_12_07":"26","2023_12_08":"26","2023_12_11":"26","2023_12_14":"27","2023_12_15":"28","2023_12_20":"28","2023_12_21":"27"}}}
   ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464","2023_11_11":"483","2023_11_16":"488","2023_11_20":"493","2023_11_24":"477","2023_11_27":"477","2023_11_28":"477","2023_11_30":"481","2023_12_01":"467","2023_12_07":"453","2023_12_08":"466","2023_12_11":"474","2023_12_14":"484","2023_12_15":"481","2023_12_20":"495","2023_12_21":"483","2023_12_22":"489","2023_12_27":"493","2024_01_06":"491"}},"V":{"ymd_price":{"2023_11_11":"245","2023_11_16":"248","2023_11_20":"249","2023_11_24":"254","2023_11_27":"254","2023_11_28":"253","2023_11_30":"254","2023_12_01":"256","2023_12_07":"254","2023_12_08":"255","2023_12_11":"255","2023_12_14":"262","2023_12_15":"259","2023_12_20":"259","2023_12_21":"257","2023_12_22":"259","2023_12_27":"259","2024_01_06":"259"}},"MSFT":{"ymd_price":{"2023_11_11":"369","2023_11_16":"371","2023_11_20":"366","2023_11_24":"377","2023_11_27":"377","2023_11_28":"382","2023_11_30":"379","2023_12_01":"374","2023_12_07":"368","2023_12_08":"370","2023_12_11":"373","2023_12_14":"375","2023_12_15":"366","2023_12_20":"373","2023_12_21":"371","2023_12_22":"373","2023_12_27":"374","2024_01_06":"367"}},"MDB":{"ymd_price":{"2023_11_11":"375","2023_11_16":"391","2023_11_20":"392","2023_11_24":"407","2023_11_27":"407","2023_11_28":"408","2023_11_30":"432","2023_12_01":"438","2023_12_07":"384","2023_12_08":"384","2023_12_11":"381","2023_12_14":"411","2023_12_15":"419","2023_12_20":"410","2023_12_21":"403","2023_12_22":"408","2023_12_27":"417","2024_01_06":"367"}},"XLK":{"ymd_price":{"2023_11_11":"179","2023_11_16":"182","2023_11_20":"182","2023_11_24":"184","2023_11_27":"184","2023_11_28":"184","2023_11_30":"184","2023_12_01":"185","2023_12_07":"182","2023_12_08":"185","2023_12_11":"186","2023_12_14":"191","2023_12_15":"190","2023_12_20":"192","2023_12_21":"189","2023_12_22":"191","2023_12_27":"192","2024_01_06":"184"}},"NDAQ":{"ymd_price":{"2023_11_11":"52","2023_11_16":"52","2023_11_20":"53","2023_11_24":"55","2023_11_27":"55","2023_11_28":"55","2023_11_30":"55"}},"AMD":{"ymd_price":{"2023_11_11":"118","2023_11_16":"117","2023_11_20":"120","2023_11_24":"122","2023_11_27":"122","2023_11_28":"122","2023_11_30":"124","2023_12_01":"121","2023_12_07":"118","2023_12_08":"128","2023_12_11":"129","2023_12_14":"138","2023_12_15":"137","2023_12_20":"139","2023_12_21":"135","2023_12_22":"139","2023_12_27":"143","2024_01_06":"138"}},"COST":{"ymd_price":{"2023_11_11":"576","2023_11_16":"596","2023_11_20":"576","2023_11_24":"592","2023_11_27":"592","2023_11_28":"594","2023_11_30":"587","2023_12_01":"596","2023_12_07":"603","2023_12_08":"610","2023_12_11":"611","2023_12_14":"642","2023_12_15":"639","2023_12_20":"677","2023_12_21":"662","2023_12_22":"664","2023_12_27":"675","2024_01_06":"656"}},"COIN":{"ymd_price":{"2023_11_11":"93","2023_11_16":"99","2023_11_20":"98","2023_11_24":"115","2023_11_27":"115","2023_11_28":"127","2023_11_30":"127","2023_12_01":"134","2023_12_07":"133","2023_12_08":"135","2023_12_11":"147","2023_12_14":"152","2023_12_15":"152","2023_12_20":"159","2023_12_21":"161","2023_12_22":"170","2023_12_27":"173","2024_01_06":"154"}},"QQQ":{"ymd_price":{"2023_11_11":"377","2023_11_16":"385","2023_11_20":"385","2023_11_24":"389","2023_11_27":"389","2023_11_28":"390","2023_11_30":"390","2023_12_01":"390","2023_12_07":"385","2023_12_08":"390","2023_12_11":"392","2023_12_14":"405","2023_12_15":"403","2023_12_20":"409","2023_12_21":"403","2023_12_22":"407","2023_12_27":"410","2024_01_06":"396"}},"GOOGL":{"ymd_price":{"2023_11_11":"132","2023_11_16":"135","2023_11_20":"135","2023_11_24":"136","2023_11_27":"136","2023_11_28":"137","2023_11_30":"135","2023_12_01":"131","2023_12_07":"131","2023_12_08":"137","2023_12_11":"134","2023_12_14":"133","2023_12_15":"131","2023_12_20":"136","2023_12_21":"138","2023_12_22":"140","2023_12_27":"141","2024_01_06":"135"}},"TSLA":{"ymd_price":{"2023_11_30":"245","2023_12_01":"238","2023_12_07":"240","2023_12_08":"242","2023_12_11":"243","2023_12_14":"239","2023_12_15":"250","2023_12_20":"257","2023_12_21":"248","2023_12_22":"255","2023_12_27":"256","2024_01_06":"237"}},"META":{"ymd_price":{"2023_11_30":"332","2023_12_01":"324","2023_12_07":"317","2023_12_08":"326","2023_12_11":"333","2023_12_14":"335","2023_12_15":"333","2023_12_20":"350","2023_12_21":"349","2023_12_22":"353","2023_12_27":"354","2024_01_06":"352"}},"PINS":{"ymd_price":{"2023_12_07":"33","2023_12_08":"34","2023_12_11":"34","2023_12_14":"36","2023_12_15":"36","2023_12_20":"38","2023_12_21":"37","2023_12_22":"37","2023_12_27":"37","2024_01_06":"36"}},"FVRR":{"ymd_price":{"2023_12_07":"26","2023_12_08":"26","2023_12_11":"26","2023_12_14":"27","2023_12_15":"28","2023_12_20":"28","2023_12_21":"27","2023_12_22":"28","2023_12_27":"28","2024_01_06":"26"}}}
}

const ai_history_init=()=>{ //READ from LOCAL STORAGE
   ai_history_matrix = (localStorage.ai_history_matrix)?
      JSON.parse( localStorage.ai_history_matrix ):null;
   if(!ai_history_matrix){
      ai_history_LOAD_MOCK_DATA();
   }
}; ai_history_init();

/*************************************\
 * HISTORY_MATRIX - store values in time
\*************************************/
const update_History_matrix = ( tickr ) => {//data updated: to not lose, push duplicate to history
   if(!tickr || !tickr.price || !tickr.ymd){return}
   if(!ai_history_matrix[tickr.tick]) { ai_history_matrix[tickr.tick]= {tick:ai_history_matrix[tickr.tick]} }
   if(!ai_history_matrix[tickr.tick]['ymd_price']) { ai_history_matrix[tickr.tick]['ymd_price'] = {} }
   ai_history_matrix[tickr.tick]['ymd_price'][tickr.ymd] = tickr.price;
   //UPDATE LOCALSTORAGE with ai_history_matrix. SAVE
   localStorage.ai_history_matrix = JSON.stringify(ai_history_matrix)  
}
/*************************************\
 * UTILITIES
\*************************************/
const formatYMD = () => {
   const currentDate = new Date();
   const year = currentDate.getFullYear();
   const month = String(currentDate.getMonth() + 1).padStart(2, '0'); // Month is zero-based, so add 1 and pad with '0'
   const day = String(currentDate.getDate()).padStart(2, '0');
   const formattedDate = `${year}_${month}_${day}`;
   return formattedDate;
}
const copyHistoryFn = () => { //
   console.log("ai_history_matrix ",ai_history_matrix)
   navigator.clipboard.writeText(JSON.stringify(ai_history_matrix) );
   stateCopiedBox.style.display = "inline";
   stateConnectedBox.style.display = "none";
   stateNotConnectedBox.style.display = "none";              
   setTimeout( ()=>{
      stateCopiedBox.style.display = "none";
      if(stock_api_key){
         stateConnectedBox.style.display = "inline";
         stateNotConnectedBox.style.display = "none";  
      }else{
         stateConnectedBox.style.display = "none";
         stateNotConnectedBox.style.display = "inline";  
      }               
   },2000)                          
};   
const copyMainFn = () => { //
   console.log("ai_main ",ai_main)
   navigator.clipboard.writeText(JSON.stringify(ai_main) );
   stateCopiedBox.style.display = "inline";
   stateConnectedBox.style.display = "none";
   stateNotConnectedBox.style.display = "none";              
   setTimeout( ()=>{
      stateCopiedBox.style.display = "none";
      if(stock_api_key){
         stateConnectedBox.style.display = "inline";
         stateNotConnectedBox.style.display = "none";  
      }else{
         stateConnectedBox.style.display = "none";
         stateNotConnectedBox.style.display = "inline";  
      }               
   },2000)                          
};   
const copyLedgerFn = () => { 
   console.log("ai_ledger = ",ai_ledger)
   navigator.clipboard.writeText(JSON.stringify(ai_ledger) );
   stateCopiedBox.style.display = "inline";
   stateConnectedBox.style.display = "none";
   stateNotConnectedBox.style.display = "none";              
   setTimeout( ()=>{
      stateCopiedBox.style.display = "none";
      if(stock_api_key){
         stateConnectedBox.style.display = "inline";
         stateNotConnectedBox.style.display = "none";  
      }else{
         stateConnectedBox.style.display = "none";
         stateNotConnectedBox.style.display = "inline";  
      }               
   },2000)               
};          
const copyScheduleFn = () => { 
   console.log("ai_schedule = ",ai_schedule)
   navigator.clipboard.writeText(JSON.stringify(ai_schedule) );
   stateCopiedBox.style.display = "inline";
   stateConnectedBox.style.display = "none";
   stateNotConnectedBox.style.display = "none";              
   setTimeout( ()=>{
      stateCopiedBox.style.display = "none";
      if(stock_api_key){
         stateConnectedBox.style.display = "inline";
         stateNotConnectedBox.style.display = "none";  
      }else{
         stateConnectedBox.style.display = "none";
         stateNotConnectedBox.style.display = "inline";  
      }               
   },2000)  
}
const copyMilestonesFn = () => { 
   console.log("ai_eventz = ",ai_eventz)
   navigator.clipboard.writeText(JSON.stringify(ai_eventz) );
   stateCopiedBox.style.display = "inline";
   stateConnectedBox.style.display = "none";
   stateNotConnectedBox.style.display = "none";              
   setTimeout( ()=>{
      stateCopiedBox.style.display = "none";
      if(stock_api_key){
         stateConnectedBox.style.display = "inline";
         stateNotConnectedBox.style.display = "none";  
      }else{
         stateConnectedBox.style.display = "none";
         stateNotConnectedBox.style.display = "inline";  
      }               
   },2000)  
}
const copyStoryzFn = () => { 
   console.log("ai_storyz = ",ai_storyz)
   navigator.clipboard.writeText(JSON.stringify(ai_storyz) );
   stateCopiedBox.style.display = "inline";
   stateConnectedBox.style.display = "none";
   stateNotConnectedBox.style.display = "none";              
   setTimeout( ()=>{
      stateCopiedBox.style.display = "none";
      if(stock_api_key){
         stateConnectedBox.style.display = "inline";
         stateNotConnectedBox.style.display = "none";  
      }else{
         stateConnectedBox.style.display = "none";
         stateNotConnectedBox.style.display = "inline";  
      }               
   },2000)  
}
const resetAllFn = () => { 
   ai_ledger_LOAD_MOCK_DATA();
   ai_history_LOAD_MOCK_DATA();
   ai_schedule_LOAD_MOCK_DATA();
   ai_eventz_LOAD_MOCK_DATA();
   //SAVE to LOCAL STORAGE
   localStorage.ai_ledger = JSON.stringify(ai_ledger)  
   localStorage.ai_history_matrix=JSON.stringify(ai_history_matrix)  
   localStorage.ai_schedule=JSON.stringify(ai_schedule)  
   localStorage.ai_eventz=JSON.stringify(ai_eventz)  
   initEncode(); //RELOAD VIEW.             
   initDecode(); //RELOAD VIEW.             
};            
let primeFn = () => {
   selectedTXT = textareaBOX.value.substring(textareaBOX.selectionStart, textareaBOX.selectionEnd);
   if(selectedTXT){
      function formatPrimeKey() {// Replace spaces with underscores
         let addEndSpace = false;
         if(selectedTXT.charAt(selectedTXT.length-1)===' '){addEndSpace=true;}
         transcript = selectedTXT.replace(/[ ]/g, '_');
         transcript = transcript.replace(/[^a-zA-Z_]+/g, '');
         transcript = `_${transcript}_`; //Wrap in _
         transcript = transcript.replace(/__/g, '_');
         transcript = (addEndSpace)?transcript+' ':transcript;
      }; formatPrimeKey();
      textareaBOX.value = textareaBOX.value.substring(0, textareaBOX.selectionStart) +
         transcript +
         textareaBOX.value.substring(textareaBOX.selectionEnd);
      textareaBOX.focus();
   }else{ showErrorMSG('⚠️ double click select...') }
}
let omniFn = () => { 
   selectedTXT = textareaBOX.value.substring(textareaBOX.selectionStart, textareaBOX.selectionEnd);
   if(selectedTXT && selectedTXT.indexOf(' ')>-1){
      let addEndSpace = false;
      if(selectedTXT.charAt(selectedTXT.length-1)===' '){addEndSpace=true;}
      transcript = selectedTXT.replace(/ /g,'_')
      transcript = transcript.replace(/[,.!?<>;:|'"-]/g, '');
      transcript = (addEndSpace)?transcript+' ':transcript;
      textareaBOX.value = textareaBOX.value.substring(0, textareaBOX.selectionStart) +
         transcript +
         textareaBOX.value.substring(textareaBOX.selectionEnd);
      textareaBOX.focus();
   }else{ showErrorMSG('⚠️ select text with spaces...') }
   }
let alphaFn = () => { 
   selectedTXT = textareaBOX.value.substring(textareaBOX.selectionStart, textareaBOX.selectionEnd);
   if(selectedTXT){
      function formatAlphaKey() {// Replace spaces with underscores
         let addEndSpace = false;
         if(selectedTXT.charAt(selectedTXT.length-1)===' '){addEndSpace=true;}
         transcript = selectedTXT.replace(/[ ]/g, '').toUpperCase();
         transcript = transcript.replace(/[^a-zA-Z_]+/g, '');
         transcript = `a${transcript}a`; //Wrap in _
         transcript = transcript.replace(/aa/g, 'a');
         transcript = (addEndSpace)?transcript+' ':transcript;
      }; formatAlphaKey();
      textareaBOX.value = textareaBOX.value.substring(0, textareaBOX.selectionStart) +
         transcript +
         textareaBOX.value.substring(textareaBOX.selectionEnd);
      textareaBOX.focus();
   }else{ showErrorMSG('⚠️ select any word...') }
   }
let ymdFn = () => { 
   transcript = textareaBOX.value;
   textareaTXT = transcript.split('\n')             
   if(textareaTXT && textareaTXT.length>0){
      textareaTXT.push(current_ymd);
      textareaBOX.value = textareaTXT.join('\n');
   }            
   }
   let hrFn = () => {
   transcript = textareaBOX.value;
   textareaTXT = transcript.split('\n')             
   if(textareaTXT && textareaTXT.length>0){
      textareaTXT.push('<hr></hr>');
      textareaBOX.value = textareaTXT.join('\n');
   }             
}             
let undoFn = () => { 
   transcript = textareaBOX.value;
   textareaTXT = transcript.split('\n')             
   if(textareaTXT && textareaTXT.length>0){
      textareaTXT = textareaTXT.slice(0,textareaTXT.length-1)
      textareaBOX.value = textareaTXT.join('\n');
   }
};         
let titlelineFn = () => {  
   transcript = textareaBOX.value;
   textareaTXT = transcript.split('\n')
   if(textareaTXT && textareaTXT.length>0){
         txtline = textareaTXT[textareaTXT.length-1]
         if(txtline.charAt(0)==='#'){
            if(txtline.charAt(1)==='#'){
               if(txtline.charAt(2)==='#'){// back to blank
                     txtline = txtline.split(' ')
                     txtline = txtline.splice(1,txtline.length).join(' ')
               }else{ //add 3
                     txtline = '#'+txtline;
               }
            }else{ //add 2
               txtline = '#'+txtline;
            }
         }else{ //add 1
            txtline = '# '+txtline;
         }
         textareaTXT[textareaTXT.length-1] = txtline;
         textareaBOX.value = textareaTXT.join('\n');
         toggleRecordState(false);
      //  recognition.stop();
   }
};          
let numberlineFn = () => {  
   transcript = textareaBOX.value;
   textareaTXT = transcript.split('\n')
   if(textareaTXT && textareaTXT.length>0){
         txtline = textareaTXT[textareaTXT.length-1]
         function incrementNum(inputString) { //regex iteration of number lists
            return inputString.replace(/^(\d+\.)?(.*)$/, function(match, number, rest) {
               if (number === undefined) { // If no number, add "1." at the beginning
                     return "1. " + rest;
               } else {// If number, increment and add back to string
                     return (parseInt(number, 10) + 1) + "." + rest;
               }
            });
         }; 
         txtline = incrementNum(txtline);
         textareaTXT[textareaTXT.length-1] = txtline;
         textareaBOX.value = textareaTXT.join('\n');
         toggleRecordState(false);
      //  recognition.stop();
   }
}

let quotelineFn = () => { 
   transcript = textareaBOX.value;
   textareaTXT = transcript.split('\n')
   if(textareaTXT && textareaTXT.length>0){
      if(textareaTXT[textareaTXT.length-1].indexOf('> ')===0){
         txtline = textareaTXT[textareaTXT.length-1].replace('> ','')
      } else {
         txtline = '> '+textareaTXT[textareaTXT.length-1]
      }
         textareaTXT[textareaTXT.length-1] = txtline;
         textareaBOX.value = textareaTXT.join('\n');
         toggleRecordState(false);
      //  recognition.stop();
   }            
}
let endlineFn = () => {  
   transcript = textareaBOX.value;
   textareaTXT = transcript.split('\n')
   if(textareaTXT && textareaTXT.length>0){
         txtline = textareaTXT[textareaTXT.length-1]
         txtCAP = txtline.charAt(txtline.length-1)
         if(txtCAP==='.'){ txtline=setCharAt(txtline,txtline.length-1,',');
         } else if(txtCAP===','){ txtline=setCharAt(txtline,txtline.length-1,'_');
         } else if(txtCAP==='_'){ txtline=setCharAt(txtline,txtline.length-1,'?');
         } else if(txtCAP==='?'){ txtline=setCharAt(txtline,txtline.length-1,'!');
         } else if(txtCAP==='!'){ txtline=setCharAt(txtline,txtline.length-1,'.');
         } else { txtline += '.';}
         textareaTXT[textareaTXT.length-1] = txtline;
         textareaBOX.value = textareaTXT.join('\n');
         toggleRecordState(false);
   }
};   

//-END-BTN-HANDLERS-------------------------------------------------
//-HELPER_fns-------------------------------------------------------
         let getCurrentDocTitle = () => {
            // transcript = textareaBOX.value;
            // textareaTXT = transcript.split('\n')
            // if(textareaTXT && textareaTXT.length>0){            
            //    return textareaTXT[0];
            // }
            // return ''
         }
         let docLoad = () => { //reload all doc view
            //load data for view from local storage
            // all_chat_docs = (localStorage.all_chat_docs)?JSON.parse( localStorage.all_chat_docs ):[];
            // const btnContainer = document.getElementById('btnContainer');
            // btnContainer.innerHTML='';
            // // Map over the array and create buttons
            // all_chat_docs.forEach(item => {
            //    const section1 = document.createElement('section');
            //    section1.classList.add('docRowBox')
            //    const button1 = document.createElement('button');
            //    button1.textContent = item.title;
            //    button1.classList.add('docTopicBtn')
            //    button1.onclick = function() { docLookup(item.title); };
            //    section1.appendChild(button1);
            //    const button2 = document.createElement('button');
            //    button2.textContent = '🗑️';
            //    button2.classList.add('docDeleteBtn')
            //    button2.onclick = function() { docDelete(item.title); };
            //    section1.appendChild(button2);                  
            //    btnContainer.appendChild(section1);                  
            // });            
         }
         let docLookup = (text) => { //load txt, and switch to view
            // transcript = '';
            // all_chat_docs = (localStorage.all_chat_docs)?
            //    JSON.parse( localStorage.all_chat_docs ):[];
            // for(var i=0; i<all_chat_docs.length;i++){
            //    if(all_chat_docs[i].title===text){
            //       transcript = all_chat_docs[i].txt;
            //       break;
            //    }
            // }
            // textareaBOX.value = transcript;
            // textareaTXT = transcript.split('\n')
            // allchatBOX.classList.add('hiddenTab')
            // textareaBOX.classList.remove('hiddenTab') 
         } 
         let docDelete = (text) => { //lookup, remove from local storage.
            // all_chat_docs = (localStorage.all_chat_docs)?
            //    JSON.parse( localStorage.all_chat_docs ):[];
            // for(var i=0; i<all_chat_docs.length;i++){
            //    if(all_chat_docs[i].title===text){ //-----FOUND DOC
            //       // transcript = all_chat_docs[i].txt;
            //       all_chat_docs.splice(i,1)
            //       localStorage.all_chat_docs = JSON.stringify(all_chat_docs)
            //       docLoad();
            //       break; //splice object out
            //    }
            // }
            // allchatBOX.classList.add('hiddenTab')
            // textareaBOX.classList.remove('hiddenTab') 
         } 
      //    function setCharAt(str,idx,chr) {
      //       if(idx > str.length-1) return str;
      //       return str.substring(0,idx) + chr + str.substring(idx+1);
      //   }        
      //    let keyupTXT = (e) => {
      //       transcript = textareaBOX.value;
      //       textareaTXT = transcript.split('\n')
      //    }
         let showErrorMSG = (err) => {
            console.log(err)
            stateErrorBox.innerHTML = err;
            stateErrorBox.style.display = "inline";
            stateConnectedBox.style.display = "none";
            stateNotConnectedBox.style.display = "none";              
            setTimeout( ()=>{
               stateErrorBox.style.display = "none";
               if( stock_api_key   ){
                  stateConnectedBox.style.display = "inline";
                  stateNotConnectedBox.style.display = "none";  
               } else {
                  stateConnectedBox.style.display = "none";
                  stateNotConnectedBox.style.display = "inline";  
               }
               // selectedTXT = '';
            },3000)
         }
         // textareaBOX.addEventListener("select", (e) => {
         //    selectedTXT = e.target.value.substring(
         //       event.target.selectionStart,
         //       event.target.selectionEnd,
         //    );
         // });
      //    recognition.addEventListener("error", (event) => {
      //       console.error(`TRY CHROME browser: ${event.error}`);
      //       // textareaTXT.push("Try CHROME browser. ~ : )")
      //       // textareaBOX.innerHTML = textareaTXT.join('\n');
      //       // toggleRecordState(false);
      //   });          
      </script> 
   </body>
</html>
