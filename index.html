<!DOCTYPE html>
<html>
<head>
   <title>ai_ledger</title>
</head>
   <body style="display:flex;flex-direction: column;">
     <style>/* PC */
      hr{border:solid 1px cadetblue}
        html, body { height: 100%; width:100%; background:black; margin:0}
        body{padding-top:1em;display:flex;flex-direction:column;overflow:hidden;
         justify-content:space-evenly;align-items:center;    font-size: 1.222rem;}
         .topLeftBtn1{position:absolute;top:3px;left:6px;display:flex;}
         .topLeftBtn1 .txt1{ color:skyblue; font-size:0.444em;margin:3px 0 0 3px;}
         .topLeftBtn1 .icon1 {font-size:1em;padding-bottom:6px;}
         .topRightBtn2{position:absolute;top:3px;right:6px;display:flex;}
         .topRightBtn2 .txt1{ color:skyblue; font-size:0.444em;margin:3px 0 0 3px;}
         .topRightBtn2 .icon1 {font-size:1em;padding-bottom:6px;}
         .docDeleteBtn {border-radius: 100%; background: darkgrey;}
         .docTopicBtn {border-radius: 13px;margin-top: 10px;background: slategrey;
            color: skyblue; font-size: 0.666em; padding: 6px;}
         .docTopicBtn:hover{border:2px solid steelblue}
        .mainBtn{margin:1em; color:darkblue;} 
        .subMenuBtn { color:#75bdb7; border-radius: 13px;  background-image: linear-gradient(grey, steelblue, black);
                   margin:0.666em;cursor:pointer;font-size:0.888em;padding: 2px 6px 4px 6px; }
        .boxTitle{font-size:1.222em}
        .btnTXT{font-size:1em;}
        .addBtn1{border-radius:13px;background:#7bd67b;float: right;
         margin-right: 0%;cursor:pointer;
         font-size: 0.666em;margin-top: 0.888em;
      }
        .genReportBtn1{border-radius:13px;
         background:#6cd8d8;
         /* background:#bd814f; */
         float: right;
         margin-right: 2%;cursor:pointer;
         font-size: 0.666em;margin-top: 0.888em;padding:0.222em;
         padding-left: 0.666em;color:#012d56;padding-right: 0.444em;
    padding-bottom: 0.444em;
      }
        .genReportBtn2{border-radius:13px;
         background:#6cd8d8;
         /* background:#bd814f; */
         float: right;
         margin-right: 2%;cursor:pointer;
         font-size: 0.666em;margin-top: 0.888em;
         /* padding:0.222em; */
         padding-left: 0.666em;color:#012d56;padding-right: 0.444em;
    /* padding-bottom: 0.444em; */
      }
      .genBtn1{font-size:0.666em; border-radius:22px; cursor:pointer;
         background:#5fa9a9; border-radius: 10px;color:#060252;
         margin: 1em;
      }
      .saveBtn2{border-radius:13px;background:#d1d67b;
         cursor:pointer; margin:1em 0 1em 0;
         font-size: 0.666em;

      }
      .addBtn4{border-radius:13px;background:#d1d67b;
         cursor:pointer; margin:1em 0 1em 0;
         font-size: 0.666em;
         background: cadetblue;
    border-radius: 13px;
    max-width: 6em;
float:right;
margin-right: 2%;
      }
      .decBtn1{font-size:0.666em; border-radius:22px; cursor:pointer;
         background:#5fa9a9; border-radius: 10px;color:#060252;
         /* margin: 1em; */
      }
      #saveTickBtn1{border-radius:13px;background:#d1d67b;float: right;
         margin-right: 2%;cursor:pointer;display:none;
         font-size: 0.666em;margin-top: 0.888em;
      }
      #saveSpotBtn1{border-radius:13px;background:#d1d67b;float: right;
         margin-right: 2%;cursor:pointer;display:none;
         font-size: 0.666em;margin-top: 0.888em;
      }
      .yellowBtn1{border-radius:13px;background:#d1d67b;float: right;
         margin-right: 2%;cursor:pointer;display:none;
         font-size: 0.666em;margin-top: 0.888em;
      }
      .delBtn1{    border: solid 1px #9e1717;
    border-radius: 22px;
    background: #38014e;
    font-size: 0.666em;
    cursor:pointer;
    margin: 0.444em;
    /* margin-bottom: 0; */

   }

   .roleBOX1{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color:  #136567;
    padding-left: 0.555em;
    margin: 0.444em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
   }
   .typeBOX1{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color:  #136567;
    padding-left: 0.555em;
    margin: 0.444em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
   }
   .roleData1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: cyan;
    padding: 0;
    text-align: center;
    max-width: 68px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}

    .typeData1 {
    border-radius: 8px;
    background: #02184b;
    color: cyan;
    padding: 0;
    text-align: center;
    max-width: 36px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;
    font-size: 1.111em;
}

   .tkrPriceBOX1{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: cyan;
    padding-left: 0.555em;
    margin: 0.444em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
   }
   .tkrPriceData1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: cyan;
    padding: 0 0.444em;
    text-align: center;
    max-width: 34px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}

    .tkrPriceDate1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: #546a9b;
    padding: 0 0.444em;
    text-align: center;
    max-width: 40px;
    height: 16px;
    font-size: 0.444em;
    margin-bottom: -1px;
    border: 1px solid steelblue;}

   .spotamountBOX1{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color:  #136567;
    padding-left: 0.555em;
    margin: 0.222em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
   }
   .spotamountData1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: #136567;
    padding: 0 0.444em;
    text-align: center;
    max-width: 34px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}

    .tkrATHBOX1{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: cyan;
    padding-left: 0.555em;
    margin: 0.444em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
   }
   .tkrATHData1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: cyan;
    padding: 0 0.444em;
    text-align: center;
    max-width: 34px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}
   .tkrATHDate1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color:#546a9b;
    padding: 0 0.444em;
    text-align: center;
    max-width: 40px;
    height: 16px;
    font-size: 0.444em;
    margin-bottom: -1px;
    border: 1px solid steelblue;}


   .spotATHBOX1{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: cyan;
    padding-left: 0.555em;
    margin: 0.222em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
   }
   .spotATHData1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: cyan;
    padding: 0 0.444em;
    text-align: center;
    max-width: 34px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}
   .spotAtBOX1{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: #136567;
    padding-left: 0.555em;
    margin: 0.222em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
   }
   .amtBOX1{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: #136567;
    padding-left: 0.555em;
    margin: 0.222em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
   }
   .spotAtData1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: cyan;
    padding: 0 0.444em;
    text-align: center;
    max-width: 34px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}
   .genTicker1{    border-radius: 10px;
         max-width: 66px;
    text-align: center;
    font-size: 0.666em;
    color: cyan;;
    background: #6679a0;
   }
    .genTicker1::-webkit-input-placeholder {
    color: rgb(68, 52, 106);
 }
 .decodeTick1{  border-radius: 10px;
         max-width: 66px;
    text-align: center;
    font-size: 0.666em;
    color: cyan;;
    background: #6679a0;
        }
    .decodeDate1{
      font-size:0.444em;color: #1a8c8c;background: none;
    border: 0;
    max-width: 6em;
    }
   .decodeRow1{margin: 1%;
   display: flex;
   justify-content: space-around;
   align-items: center;
   flex-wrap: wrap;      
   width: 92%;
   border: solid 1px steelblue;
   padding: 0 0 0 1%;
   padding-left: 2%;
   border-radius: 22px;
   }
   .encodeNUMBOX1{
         font-family: sans-serif;
      font-size: 0.555em;
      margin-left: -2em;
      padding-left: 1em;
      display: flex;
   }
   .capsNUMBOX1{
         font-family: sans-serif;
      font-size: 0.555em;
      /* margin-left: -2em;
      padding-left: 1em; */
      display: flex;
   }
   .capsNUMBOX2{
         font-family: sans-serif;
      font-size: 0.555em;
      margin-left: -2em;
      padding-left: 1em;
      display: flex;
   }
   .encodeSelect1{
      color:cyan;
   }
   .decodeNUMBOX1{
         font-family: sans-serif;
      font-size: 0.555em;
      margin-left: -1em;
      padding-left: 1em;
      display: flex;
   }
   .decodeSelect1{
      color:cyan;
   }
   .genRow1{margin: 1%; width:92%; border:solid 1px steelblue;
   border-radius:18px;padding-left: 3%;padding-top: 0;
   display: flex;
   justify-content: space-around;
   align-items: center;
   flex-wrap: wrap;
   }
        /* .btnTXT:hover{color:navajowhite;} */
        .hoverTXT:hover{color:navajowhite;}
        /* .mainBtn:hover{color:navajowhite} */
        /* .btnTXT:hover{color:navajowhite} */
        .subMenuBtn:hover{border:2px solid steelblue; color:darkslategrey}
        .disabled{ color: darkslategrey; border: 1px solid steelblue; 
            background: transparent !important;}
        .hiddenTab{ display:none !important;}
         #textareaBOX {
            background:darkslateblue;
            background-attachment: local;
            background-image:
               linear-gradient(to right, darkslateblue 20px, transparent 20px),
               linear-gradient(to left, darkslateblue 20px, transparent 20px),
               repeating-linear-gradient(darkslateblue, darkslateblue 40px, #344065 40px, #344065 41px, darkslateblue 41px);
            line-height: 31px;
            padding: 8px 10px;
         }
         #rightBOX,#leftBOX,#keyBOX{margin:2px;border: solid 1px steelblue;width: 100%;font-size: 0.777em;}
        
         #encodeBOX, #decodeBOX, #instructionBOX, #scheduleBOX, #historyBOX, #allMarginsBOX{
            margin:2%;
         }

         #generatedScheduleBOX, #generatedProfitsBOX, #generatedMarginsBOX{
            margin:2%;
         }
         .quarterBOX{
            display: flex;
    flex-direction: column;
            margin-top:2em;
            background:#1b0227;
            border-radius: 13px;
         }
.trimTick{
   font-family: sans-serif;
    /* font-weight: bold; */
    border-radius: 10px;
        max-width: 44px;
   text-align: center;
   font-size: 0.666em;
   color: cyan;;
   background: #6679a0;
   height: 1.222em;
   align-self: center;

}

.inputDATABOX1, .inputDATABOX2,.inputDATABOX3,.inputDATABOX4,.inputDATABOX5{
   border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: #1e8385;
    padding-left: 0.555em;
    margin: 0.222em 0;
    /* margin: 0.222em 1em; */
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
    align-self: center;
   }
   .inputDATA1{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color:    #136567;
    padding: 0 0.444em;
    text-align: center;
    max-width: 34px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}

.inputDATABOX2{border-radius: 8px;
    font-size: 0.666em;
    background: #1a0033;
    color: #b19f50;
    padding-left: 0.555em;
    margin: 0.222em 1em;
    display: flex;
    max-height: 24px;
    align-items: center;
    text-align: right;
    align-self: center;
   }
   .inputDATA2{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: #b19f50;
    padding: 0 0.444em;
    text-align: center;
    max-width: 22px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}
   .inputDATA3{    border-radius: 8px;
    font-size: 0.888em;
    background: #02184b;
    color: #b19f50;
    padding: 0 0.444em;
    text-align: center;
    max-width: 15px;
    height: 16px;
    margin-bottom: -1px;
    border: 1px solid steelblue;}

.profitRow1, .marginsRow1, .detailRow1 {
   display: flex;
    justify-content: space-between;
    margin-right: 2%;
    flex-wrap: wrap;
}
.detailRow2 {
   display: flex;
    justify-content: space-between;
    margin-right: 2%;
    flex-wrap: wrap;
    padding-left:6.666%;
    font-size: 0.777em;
    color: #136567;
    align-items: center;
}
.totalsRow1{
   display: flex;
    justify-content: space-evenly;
    font-size: 1.222em;
    color: limegreen;
}
.profitRow1 aside{
   display: flex;
    align-items: center;
}
.marginsRow1 aside{
   display: flex;
    align-items: center;
}
.detailRow1 aside{
   /* display: flex; */
   font-size :0.777em;
    align-items: center;
    /* margin-left:2%; */
    padding-left:2%;
    color:#595fa5;
    line-height: 1.666em;
    text-align: right;
    width: 80px;
}
.scheduleRow1{
   display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 2%;
}
.detailDate1{
   background: none;
    color: #4b53b9;
    font-size: 0.555em;
    border: none;
    max-width: 6em;
}
.capROW{
   display: flex;
    justify-content: space-between;
    flex-wrap: wrap;    margin: 0 10px; 
}
/* .capROW div{
   margin: 0 2% 0 0;    height: 2em;
} */
.quarterTXT{
   line-height: 1em;
   font-weight: bold;
    font-family: sans-serif;
    color: #3db63f;
    background: black;
    border-radius: 14px;
    padding: 6px;
    max-width: 7em;    
}
.trimBtnROW{
   display: flex;
    justify-content: space-between;
    flex-wrap: wrap;    margin: 0 10px;
}
.proTick1{
   width: 44px; /*align item column*/
}
      .smICON{font-size:0.555em;}
      #instructionText{display:none;margin:4%;}

      #keyINPUT:-webkit-autofill { -webkit-box-shadow: 0 0 0px 1000px #233453 inset;}


      #scrollFrame{width: 88%; }  
      /*  custom scroll bar */
      /* .scrollBar2 {height:97%; overflow-x:hidden; background:#010111; border: 1px steelblue solid; border-radius:13px; padding:0.5em; } */
      .scrollBarV {height:97%; overflow-x:scroll; background:#010111; border: 1px steelblue solid; border-radius:13px;  }
      .scrollBarV::-webkit-scrollbar-track { background-color: #010213;  border-radius: 13px; }
      .scrollBarV::-webkit-scrollbar { width: 0.666em; height: 100%; }
      .scrollBarV::-webkit-scrollbar-thumb { background-color: #04223c; border-radius: 13px;
      background-image: -webkit-linear-gradient(0deg, rgba(255, 255, 255, 0.6) 26%, transparent 26%, transparent 51%, rgba(255, 255, 255, -0.4) 51%, rgba(255, 255, 255, 0.6) 74%, transparent 74%, transparent);
      }

      .typeTRIMColor{
         color:lime;
      }
      .typePADColor{
         color:red;
      }


/* checkbox_frame */
.checkboxFrame {
  display: block;
  position: relative;
  padding: 0 4px;
    margin: 17px 6px 0 6px;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* Hide the browser's default checkbox */
.checkboxFrame input {
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
}

/* Create a custom checkbox */
.checkmark {
border:1px solid lime;
border-radius:13px;
  position: absolute;
  top: 0;
  left: 0;
  height: 10px;
  width: 10px;
  background-color: black;
  box-shadow: 0px 2px 6px 1px #010191;  
}

/* On mouse-over, add a grey background color */
.checkboxFrame:hover input ~ .checkmark {
  background-color: #014601;
}

/* When the checkbox is checked, add a blue background */
.checkboxFrame input:checked ~ .checkmark {
  background-color: steelblue;
}

/* Create the checkmark/indicator (hidden when not checked) */
.checkmark:after {
  content: "";
  position: absolute;
  display: none;
}

/* Show the checkmark when checked */
.checkboxFrame input:checked ~ .checkmark:after {
  display: block;
}

/* Style the checkmark/indicator */
.checkboxFrame .checkmark:after {
   left: 4px;
    top: -1px;
    width: 2px;
    height: 6px;
  border: solid #014601;
  border-width: 0 3px 3px 0;
  -webkit-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  transform: rotate(45deg);
}

.btmBtns1{
   margin:1em 1%;
   font-size:0.666em;
}

      @media only screen and (max-width: 800px) { /* TABLET */
         body{  background-color: #000f1b;}
         .btnTXT{font-size:0.888em;}
         .mainBtn{margin:0.888em;}
         .subMenuBtn{font-size:0.666em;}
         #rightBOX{margin-right:6%; border:0px} 
         #leftBOX{margin-left:8%; border:0px }
         /* .delBtn1{margin-bottom: 1em;} */
         /* .genRow1{padding:0.444em 2% 0.444em 0} */
         /* .decodeRow1{padding:0.222em 2% 0.222em 2%} */
         .boxTitle{font-size:0.888em}
      }  
      @media only screen and (max-width: 500px) { /* PHONE */
         body{ background-color: #08011e;}
         .btnTXT{font-size:0.888em;}
         .mainBtn{margin:0.666em;}
         .subMenuBtn{font-size:0.666em;}
         #messageBOX{flex-direction: column;}
         /* .delBtn1{margin-bottom: 1em;} */
         #encodeBOX, #decodeBOX, #instructionBOX, #scheduleBOX, #historyBOX, #allMarginsBOX{
            margin:2% 0;
         }  
         #scrollFrame{width: 95%; }       
         /* .genRow1{padding:0.444em 2% 0.444em 2%} */
         /* .decodeRow1{padding:0.222em 1% 0.222em 1%} */
         .boxTitle{font-size:0.777em}
      }

     </style>
     <aside class="topLeftBtn1">
      <span class="icon1" style="border-radius:100%;background:steelblue; 
      border:2px solid grey;">üé™</span><span class="txt1">home</span>
      </aside>
      <aside style="font-size: 0.666em;color: steelblue;margin: -10px 0 4px 0;">
        ai_ledger</aside>
      <aside style="font-size: 0.666em;color: steelblue;margin: -10px 0 4px 0;">
      </aside>
      <aside class="topRightBtn2">
         <span class="txt1">charts</span>
         <span class="icon1" style="border-radius:100%;background:crimson; 
         border:2px solid grey;">üé¢</span>
         </aside>      
      <header style="display:flex;justify-content:space-evenly; flex: 0 0 auto;
        background-image: linear-gradient(grey, steelblue, black);
        box-shadow:0 0 14px 0px steelblue;border-radius:13px; margin:0 auto;
        width:93%;">
         <button class="mainBtn" onclick="transcribeTXT()" style="border-radius:8px;
            background:grey; 
            cursor:pointer;box-shadow: inset 0px 0px 10px 0px limegreen;">
            <span style="border-radius:100%;background:limegreen;
              border:1px solid grey;">
            üè∞</span><span class="btnTXT hoverTXT">Network</span>
         </button>

         <section id="notConnectedBox" class="mainBtn" style="border-radius:8px;
         background:#61f361;padding: 6px;">
            <span>üî¥</span> Not Connected 
        </section>

         <section id="ConnectedBox" class="mainBtn" style="border-radius:8px;
         background:#6283be;padding: 6px;border: 1px solid darkslateblue;
         display:none;"><span style="border-radius:33%;background:skyblue;
              border:1px solid grey;">‚ö°</span>Connected
        </section>

         <section id="savedBox" class="mainBtn" style="border-radius:20px;
            background:rgb(249, 231, 130);padding:4px 4px 8px 4px;display:none;
            border: 1px solid rgb(221, 118, 2);color:rgb(221, 118, 2);
            ">üíæ saved.</section>

         <section id="copiedBox" class="mainBtn" style="border-radius:20px;
            background:#fad688;padding:4px 4px 8px 4px;display:none;
            border: 1px solid rgb(221, 118, 2);color:rgb(221, 118, 2);
            ">üé≠ copied.</section>

         <section id="errorBox" class="mainBtn" style="border-radius:20px;
            background:#091d3e;padding:4px 4px 8px 4px;display:none;
            border: 1px solid rgb(221, 118, 2);color:rgb(221, 118, 2);
            ">‚ö†Ô∏è error...</section>


         <button class= "mainBtn " onclick="stopTXT()" style="border-radius:8px;
            background:grey;box-shadow: inset 0px 0px 10px 0px crimson;
            cursor:pointer;"><span style="border-radius:100%;background:firebrick;
              border:1px solid grey;">
            üí°</span><span class="btnTX hoverTXT">Market</span>
         </button>
        </header>
      <header id="messageBOX" style="display:flex;flex: 0 0 auto;
      margin: 0.222em;">
         <section id="leftBOX" style="display:flex; justify-content: center;
         border-radius: 13px;padding: 2px 6px;color: steelblue;align-items: center;
         "><span class="smICON">‚ú¥&nbsp;&nbsp;</span> ai probability stock forcast <span class="smICON">&nbsp;‚ú≥</span></section>            
         <section id="keyBOX" style="display:flex;border: solid 1px steelblue;
         border-radius: 13px;padding: 2px 6px;color: steelblue;align-items: center;
         margin:2px;">
               API:<input id="keyINPUT"  type="password" placeholder="api_key" 
               style="margin-left: 1em; background:#233453;
               border-radius: 10px 0px 0px 10px;"></input>
               <button style="margin-right: 1em; background:#03cbcb;cursor:pointer;
               border-radius: 0px 10px 10px 0px; font-size:0.666em;padding: 4px;" onclick="setAPIKEY();">SET</button>
         </section>
         <section id="rightBOX" style="display:flex;  justify-content: center;
         border-radius: 13px;padding: 2px 6px;color: steelblue;align-items: center;
         "><span class="smICON">&nbsp;&nbsp;‚úß&nbsp;</span>generate ledger schedule<span class="smICON">&nbsp;‚ùá</span></section>
      
      </header>         
        <!-- <main id="symbolBOX" style="display:none;">
         <button class="subMenuBtn" onclick="primeFn()">primeüóù</button>
         <button class="subMenuBtn" onclick="omniFn()">omniüóùÔ∏è</button>
         <button class="subMenuBtn" onclick="alphaFn()">alphaüîë</button>
         <button class="subMenuBtn" onclick="ymdFn()">ymd<span style="font-size: 0.777em;
            padding-left: 2px;">üìÖ</span></button>
         <button class="subMenuBtn" onclick="hrFn()"><span style="font-size: 0.777em;
            ">__</span></button>
        </menu> -->
      <!-- <section id="allchatBOX"  class="hiddenTab" style="width:80.888%;margin: 0 2% 0 2%;
      border-radius: 13px; border: solid 1px steelblue; box-shadow: 1px 1px 11px 0px cyan;
      padding: 4% 0 4% 4%; color: cyan;">
         <header style="font-size: 0.777em;">SAVE CHATS (by title): </header>
         <article id="btnContainer" style="display:flex;flex-direction:column;
               align-items:flex-start;">
         </article>
      </section> -->
<article id="scrollFrame" class="scrollBarV" style="overflow:auto;    display: flex;
flex-direction: column; max-width: 777px;
align-items: center;">


      <section id="encodeBOX"
        style="width:80.888%; flex:1;
        border-radius: 13px; border: solid 1px steelblue; 
        box-shadow: 1px 1px 11px 0px cyan;
        padding:2%; color: cyan; line-height: 2.444em;
        /* display: flex;
    flex-direction: column; */

    "
        >
        <button id="latestBtn1" class="genBtn1" style="display:none;float:right" onclick="getLatestTickerClick()">latestüîÑ</button>
          
        <span class="boxTitle">üéØ <span style="font-size:0.888em; color:cyan">1</span> Encode Stocks <span style="font-size:0.666em">(metadata) üî¨</span></span>
        <article id="encodeDATA"></article>
        <button id="saveTickBtn1" onclick="saveTickerClick()">saveüåü</button>
        <!-- <button id="genr8Btn" class="genBtn1" onclick="generateSelected()">‚ö°gener8üó∫Ô∏è</button> -->
        <button class="delBtn1" style="float:right;margin-top:0.888em;margin-right:4%;" onclick="deleteSelectedTicker()">üóëÔ∏è</button>
          <button id="addTickBtn" class="addBtn1" onclick="addTickerClick()">addüéá</button>

          <br>
         </section>
         
         <section id="decodeBOX"
         style="width:80.888%; flex:1;
        background: #0a0014;
        border-radius: 13px; border: solid 1px steelblue; box-shadow: 0px 7px 20px 6px #39029e;
        padding: 2%; color: cyan; line-height: 2.444em;" 
        ">
        
        <span class="boxTitle">üé± <span style="font-size:0.888em;color:#2a2acf">2</span> Decode Spots <span style="font-size:0.666em">(timedata) üé≤</span></span>
        <aside id="decodeSPOTZ"></aside>
        <button class="delBtn1"  style="float:right;margin-top:0.888em;margin-right:4%;"  onclick="deleteSelectedSpot()">üóëÔ∏è</button>
        <button id="addSpotBtn" class="addBtn1" onclick="addSpotClick()">addüéÜ</button>
        <button id="saveSpotBtn1" onclick="saveSpotClick()">save‚öì</button>
        <!-- <button id="addSellBtn" class="genBtn1" onclick="sellSelectedSpots()">üîílock sellüßæ</button> -->
        <br>
      </section>

      <section id="allMarginsBOX"
         style="width:80.888%; flex:1;
         background:#071936; 
         border-radius: 13px; border: solid 1px #4ba1a9; box-shadow: 0px 7px 7px 3px #023e16;
         padding: 4% 0 4% 4%; color: #47c270; line-height: 2.444em;" 
         ">
         <button id="generateMarginsBtn" class="genReportBtn1" onclick="generateMarginsClick()">gener8‚ú®</button>
         <span class="boxTitle">üê§ <span style="font-size:0.888em;color:#47c270;">
         </span> Generate Margins <span style="font-size:0.666em">(on spots) üíé</span>
         </span><br>
         <article style="font-size:0.777em;font-family: sans-serif;line-height:2.222em;">
            <hr> 
            Margins:
            <section id="generatedMarginsBOX"></section>
            <hr> 
            <button id="detailsBtn1" class="genReportBtn1" style="display:none;" onclick="setMarginDetailsClick(event)">detailsüî¨</button> 
            <button id="totalsBtn1" class="genReportBtn1" style="display:none;" onclick="setMarginDetailsClick(event)">totalsüî≠</button> 
                      
      </section>
      <section id="scheduleBOX"
        style="width:80.888%; flex:1;
        background: #0e0015;
        border-radius: 13px; border: solid 1px #a9a04b; box-shadow: 0px 7px 7px 3px #9b6237;
        padding: 4% 0 4% 4%; color: #b19f50; line-height: 2.444em;" 
        ">
        <button id="generateScheduleBtn" class="genReportBtn1" onclick="generateScheduleClick()">gener8üìâ</button>
        <span class="boxTitle">üîî <span style="font-size:0.888em;color:#b19f50;">
        </span> Generate Schedule</span><span style="font-size:0.666em"> (TGTz) üìà
      </span></span><br>
        <article>
           <hr>   
           <section id="generatedScheduleBOX"></section>
           <hr>   
           <button class="delBtn1"  style="float:right;margin-top:0.888em;margin-right:4%;"  
           onclick="deleteSelectedSchedule(event)">üóëÔ∏è</button> 
           <button id="trimScheduleBtn" class="genBtn1" onclick="trimScheduleClick()">trimüêá</button>
           <button id="padScheduleBtn1" class="genBtn1" onclick="padScheduleClick()">padüêí</button>
           <button id="detailsBtn2" class="genReportBtn2" style="display:block;" onclick="setScheduleDetailsClick(event)">detailsüî¨</button> 
           <button id="totalsBtn2" class="genReportBtn2" style="display:none;" onclick="setScheduleDetailsClick(event)">briefüî≠</button> 
           <button id="addScheduleBtn" class="addBtn1" onclick="addScheduleClick()">add qrtrüëª</button>
           <button id="saveScheduleBtn1" class="yellowBtn1" onclick="saveScheduleClick()">save‚öì</button>
         </article>
      </section>
      <section id="historyBOX"
        style="width:80%;flex:1;
        background: #001206;
        border-radius: 13px; border: solid 1px darkgreen; box-shadow: 0px 7px 20px 0px #029e4a;
        padding: 4% 0 4% 4%; color: cyan; line-height: 2.444em;" 
        ">
        <button id="generateProfitBtn" class="genReportBtn1" onclick="generateProfitLossClick()">gener8üè∞</button>
        <span class="boxTitle">üåä <span style="font-size:0.888em;color:cyan;">
         </span> Generate Profit/Loss/Tax </span><span style="font-size:0.666em">(reports) üö®
         </span></span><br>
        <article style="font-size:0.666em;">
         <hr>   
  
         Profit & Loss:
         <section id="generatedProfitsBOX"></section>
         <hr>   
         Tax Calculations:<br>
         Tax_Max: <i>everything 25%</i> - tax-loss-harvesting (later)
         <hr>     
         Analytics:<br>
         <i>ai charts (later)</i>
         <hr>     
       </article> 
      </section>

      <section id="instructionBOX"
        style="width:80%; flex:1;padding: 1% 2% 1% 2%;
        background: #000815; font-size:0.666em;
        border-radius: 13px; border: solid 1px steelblue; box-shadow: 0px 7px 20px 0px #026767;
        color: steelblue;
    line-height: 3.222em;
    font-family: verdana;
    font-size: 0.777em;     font-weight: bold;
        ">
        <button id="openBtn1" class="genReportBtn1" onclick="openBtnClick()">showüí†</button>        
        <span class="boxTitle">üí° Instructions:</span><br>
      <article id="instructionText">
        
        
        <hr>   
        Generate Worksheet, Generate Schedule, Generate Reports.
        <hr><br><hr>  

        # STEPS

        1. ADD numbers QUARTERLY and MONTHLY as WORKSHEET input.

        2. GENERATE REPORT metadata, 

        3. COMPARE against schedule for QUARTERLY and MONTHLY

        4. Try to see clear distinction between
        
        - buyRED or cutLOSS

        - upsideHEDGE or

        - TRIM_HIGHER_HIGHS and PAD_LOWER_LOWS

        - place alerts on BUY_RED and SELL_GREEN.

        - sellGREEN or rideBULL, DOWNLIMITLOSS UPLIMITTRIM

        - PRESSUP  PRESSDOWN, TRIMUP, TRIMDOWN.

        <hr><br><hr>
        # CAP STRATEGY

        Really nice and simple way to limit risk, schedule acts, and bank profits.

        In correction and downturn - level up positions - to new CAPS.

        Then on return sideways and bull market - bank at 10% increments.

        Keeping the CAPS the whole way.

        3 strike pad limit on all CAPS. to catch lows... 3 times.

        On Crash - level up positions. Example from 500 to 1000 or 2000 to 3000.

        Trim = 0 is beginning of crash.

        During Crash bottom is half down last bull run.

        Add new LEVEL each LEG DOWN CRASH.

        LEVEL LIMIT is also 3 strikes. 1, 2, 3. Graduated amounts 500, 500, 1000.

        REVIEW SCHEDULE each month on 1st - largest position on largest gainers?
        RESET LIMITS only in downturn. SIGNAL.
        BOLLINGER and RSI and VIX OVERSOLD. Fearful VOLUME RED FLUSH.
        HALF Prior Run.




        <hr><br><hr>
         # ACTS

         buyHOLD, sellSAFE, cutLOSS, buySPOT, sellSPOT

         #risk_on snap  robinhood  roblox

         #DIVERSIFY LLY and FIRSTSOLAR. CRYPTO

         <hr><br><hr>
        # PRINCIPLE_BASIS TRADES.


        11/14/2023 - clear equity rally vs crypto decline.
        if bitcoin becomes negative correlated to stocks
        trimming stocks at top, and buy crypto, for 
        reversal flight_to_safety sell crypto going down,
        for bottom of recession or decline, next bull run.
  
        RULE: only make PRINCIPLE moves at BOTTOM.
  
        11/14/2023 - growth levels on MDB, mirrors NVDA.
        LOOK for MDB and NVDA to be OVERBOUGHT boll.
        And switch from GROWTH to TRIM (at higher principle)
        TRIM_TGT: MDB 2,000_BAL and NVDA 5,000_BAL
        TRIM_TGT: MDB & NVDA upper boll band.
        TRIM_TGT: BANK_10% (2,000), then BANK_20% on TRIM_TOP. 
        CRASH_TGT: After all Pads used, and still down. 
        Set new POSITIONS DURING CRASH: 500, 500, 1000.
        EARLY_TRIM:MDB,AMD,MSFT,GOOG
        MID_TRIM:XLK,NDAQ,GOOG
        LATE_TRIM:
        PAD_LIMIT: 1,000_TOT_MONTH
        CRASH_LIMIT: 10_POSITION_PRESS_QUARTER
        PRINCIPLE-FOCUS METHOD.
        GROWTH_TGT - move to higher principle
        TRIM_TGT   - pull 100's off the top.
        SAFE_TGT - intended to not decline
        PAD_TGT: New_Lower_Low
        TRIM_TGT: New_Higher_High
        SAFE_TGT: BANK_PROFITS in very good times.
        - we do not want safe targets at the top. we want cash.
        - we want safe targets at toward the bottom, then growth.
        - Bear Rally great for returns.

        Quarterly and Monthly Limits. 
        
        - 10SPOT_LIMIT: 1000 per month max, 
        
        - 10, 100 SPOT_LIMIT. Per month.

        This financial tool uses NATURAL LANGUAGE PROCESSING to solve that.

        <hr><br><hr>

        # Technical description (ai)

        Ai encode/decode algorithms, to generate, a schedule, 
        of probabilistic states, with spot nlp, 
        and trades tracking with metadata.

        As scheduled routine, set EXPECTATIONS,
        and REVIEW on a MONTHLY and QUARTERLY basis.
        Specificallly, at times of tax review (quarterly),

        An overall report is generated, where NLP tokens,
        are used to generate visual charts of market_state.

        <hr><br><hr>
        # MONTHLY and QUARTERLY VISUALS of all spots:
        sideways, inGREEN, inRED.

        Ticker input is encoded, with spot input, and a 
        schedule of how it compares to static conditions,
        is generated.

        Static Conditions are like all time high, all time low,
        52 week high, 52 week low, quarterly high, quarterly low.
        Also computed, % off of ATH, and recency of ATH, as 1,2,3 months.
        
        LAST-WEDNESDAY (day before last THURSDAY) put in a GUESS and REAL.

        <hr><br><hr>
        QUARTERLY HiGH/LOWS (QHL) and MHL (monthly high lows.) 
        - monthHIGH, monthLOW, quarterHIGH, quarterLOW, yearHIGH, yearLOW
        <hr>
         This tool is designed to help solve a few common problems 
         in a financial ledger. Over and over, similar patters appear.
         Below are those patterns.
         Along with the strategy to classify each.
         In advance of defining probabalistic state.
         To then trigger articulated response and note keeping.

         <hr><br><hr>
        # Patterns of all possible probability.

         - sold too much, thinking it would go down - but it went way up.
         - sold correctly, before it tanked.
         - bought correctly, before it went way up. didnt buy enough.
         - bought and it tanked. Should've bought less, or not at all.
      
         As SPOT patterns:
         - upside hedge spots: put in more, before a BULL. Climbing Stairs.
         - downside buy spots: put in more, in expected CORRECTION. 
            Try to time the bottom of a Market Downturn.
         - rebalance spots: cut loss and move to better percentage spots.
         - upside sell profit spots: try to time the top.

         Formula:
         The prime determination of successful investment is ROI.
         So % ROI is a key metric, among other statistics.
         The state of each SPOT changes, based on TIME and %ROI
         <hr><br><hr>
         EXAMPLE:
         A spot that is down 10% - 1 week after purchase - still has TIME.
         But a spot down 10% - years after purchase - is very bad.
         <hr><br><hr>
         Another EXAMPLE:
         A stock that had a huge run, is only cash - as booked_profit.
         So trimming strategically is required to get returns.
         Alternatively, a stock that has a huge run, but then returns
         to minimal profit (or loss) - years laters, is out of time.
         And is a dog. At that point the state changes from a stock
         that still has time_to_turnaround, or a dog, that needs to 
         cut_loss and rebalance risk off into better profit_margin spots.
         <hr><br><hr>
         Strength and volume
         check low rsi on buy, And
         check for high selling volume as climax (low buys) sellers tapped out.
         check high rsi on sell, And
         check for high buying volume as climax (low sells) buyers tapped out
         check vix for climax of fear or greed. 
         VIX_INFLOW (greed,hype,fomo) VIX_OUTFLOWS(fear,risk,uncertainty)
         <hr><br><hr>
         Another Example:
         Biggest spots for heighest weighted probabilities.
         Smaller spots for less certain probabilities.
         Calculate TREND LENGTH, days above MA:100,200
         <hr><br><hr>
         Another Example:
         fallback to half of bull run - a year later.
         Need to see end of bull.
         Need to see end of bear.
         <hr><br><hr>
         FUD FOMO CASHOUT or CASHIN
         <hr><br><hr>
         Seasonality:
         buy halloween, sell thanksgiving
         <hr><br><hr>
         Bad comps
         last years numbers skewed.
         <hr><br><hr>
         Topics in news, SELLNEWS or BUYNEWS
         CATALYST EVENT_ON and EVENT_OFF
         have an input for topics in the news such as
         beginning or ending of wars, raising or lowering of interest rates,
         last thursday of the month (bustshort, bustputs).
         Or Earnings - how to opposite_respond - earnings calls?
         <hr><br><hr>
         ANALYTICS:
         - days_sideways
         - days_red
         - days_green
         - %_green
         - %_red
         <hr><br><hr>
         GOAL2GO
         GOAL to make in a YEAR, Goal to make in Quarter, 
         Goal to make in month
         Goal to make in week, goal to make in day.
         <hr><br><hr>
         VISUALIZATIONS:
         Graphs and charts for ticker over time, to show state.
         With Natural Language Processing parameters.
         To trigger various prescribed strategy.
         <hr><br><hr>
         Over TIME durations: 
         - stock goes up mild 10% 20% 
         - stock goes up hot  50%, 100% 500%
         - stock stays flat +- 10% range 
         - stock is cold -10% 20%
         - stock is dog.
         <hr><br><hr>
         FORCAST:
         select box: up middle down - then result.
         And set reactions on results.
         Example: every 20% up sell 10% 
         or 1/3 up, sell 1/4.
         <hr><br><hr>
         ## NLP Classification mechanism

         More animated pattern recognitions.
         hot-bull, mild-bull, mild-bear, hot-bear.
                  
         NLP parameters for the SPOTS, 
         top-out, dip, correction, retracement, head and shoulders.
         upside-hedge, seeking-bottom,
         pruning-top, rebalance-out, rebalance-in.
         % to point. Like % to go under water.
         And total trade-profits, with total-red positions,
         And total-green positions.
         <hr><br><hr>
         Quarterly_Market_Narratives:
         - higher for longer - geo-political risks
         - taboo 10yr over 5% - weakened consumer
         - consumer stimulus pullback
         NEGATIVE_TO_POSITIVE shift
         POSITIVE_TO_NEGATIVE shift
         NEW_NEGATIVE
         NEW_POSITIVE
         UPSIDE_SURPRISE
         DOWNSIDE_SURPRISE
         <hr><br><hr>
         LITMUS_STOCKS. TRENDS_TO_WATCH
         COSTCO and WMT to read CONSUMER_RISK
         GOOGLE and MICROSOFT for TECH GROWTH
         MDB and AMD and NVDIA for AI GROWTH
         QQQ XLK and SPX for Industry_Trends
         STATE_CHANGES: 
         HOOD moves from watch to risk_on or
         HOOD moves from watch to cutloss.
         
         <hr><br><hr>
         KEY_POINT_INDICATOR_worksheet:
         10yr 5% interest rates
         200 day moving average bounce to ATH or return
         breach of 100 day, 200day.
         breach of 10% up ytd
         breach of 20% up ytd
         RSI and Market sentiment fear_greed_index
         S&P500 4500
         Russel 200 turnaround
         <hr><br><hr>
         HISTORIC_DATA_MATRIX
         latest_price
         new_ath 
         new_high_quarter, new_low_month
         new_low_quarter, new_low_month
         month_spot, quarter_spot, ytd_spot
         resistance_support_ranges
         
         <hr><br><hr>

         With expectations as,
         Expecting_bull, expecting_bottom.

         Weighted probabilities, change actions on stocks,
         based on path that stocks take, over time.

         Where increasing time, increases weighted probability,
         of correctness of classification.

         Quarterly Story: buzzwords: 'higher for longer', 'quantitative easing'
         etc.
          
         TrimSpot: 1,2,3,4...: 10%, date, margin.
         PressSpots 1,2,3,4...: avg_price, date

         RISK_ON, RISK_OFF.
         NLP: Nomenclature,Taxonomy,Ontology,Index,FoundationModel.
         HeadWind, TailWind.
         <hr><br><hr>
         Forcast Dashboard: 
         what if it breaks out (earning beat) +10%
         - what if it tanks 10%?
         - what if sideways for quarter?
         <hr><br><hr>
         Analytic display.
         Individual Spot Profit/Loss.
         SpotFamily Profit/Loss.

         LAST_DAY, FIRST_DAY.
         - input data on the last day and first day of data every month.
         - put a reminder on phone. along with last thursday.
         - SET NEW upper band and lower band RANGE ALERTS! - every month.
         - 10% and 20% (mid moves and big moves) 

         <hr><br><hr>
         RULES:
         buy_red_support üî¥‚ö†Ô∏è
         sell_green_resistance,üöÄ
         detect & respect market waves.üåä

      </article>

      </section>


   </article>

    <!-- <menu style="display:flex;justify-content:space-evenly;background: #182b3d;
        border-radius: 30px;margin:0;padding:0;margin-bottom:-6px;
        box-shadow: inset -5px 7px 8px 0px #472c88;">
        <button class="subMenuBtn" onclick="undoFn()">‚Ü∂undo</button>
        <button class="subMenuBtn" onclick="titlelineFn()">#Ô∏è‚É£title</button>
        <button class="subMenuBtn" onclick="numberlineFn()">üî¢1.2.3.</button>
        <button class="subMenuBtn" onclick="endlineFn()">üî£.,_?!</button>
        <button class="subMenuBtn" onclick="quotelineFn()">*Ô∏è‚É£quote</button>
    </menu> -->
      <footer style="display:flex;justify-content:space-evenly;width:90%;margin:0 auto; 
      margin-bottom:0.666%; flex: 0 0 auto;    margin-top: 0.555em;
      background-image: linear-gradient(grey, steelblue, black);
      box-shadow:0 0 14px 0px steelblue;border-radius:13px;">
       <button onclick="copyLedgerFn()" class="btmBtns1" style="border-radius:8px;background:grey;
          cursor:pointer;box-shadow: inset -1px -1px 4px 1px gold;">
          <span style="border-radius:100%;background:gold;border:1px solid grey;">
            üíæ</span> <span class="btnTXT hoverTXT">COPY LEDGER</span>
       </button>
       <button onclick="copyHistoryFn()" class="btmBtns1" style="border-radius:8px;background:grey;
          cursor:pointer;box-shadow: inset -1px -1px 4px 1px orangered;">
          <span style="border-radius:100%;background:orangered;border:1px solid grey;">
            üìã</span> <span class="btnTXT hoverTXT">COPY HISTORY</span>
       </button>
      <button onclick="copyScheduleFn()" class="btmBtns1" style="border-radius:8px;background:grey;
         cursor:pointer;box-shadow: inset -1px -1px 4px 1px rgb(51, 153, 109);">
         <span style="border-radius:100%;background:rgb(51, 153, 99);border:1px solid grey;">
            üçß</span> <span class="btnTXT hoverTXT">COPY TGTS</span>
      </button>
       <button onclick="resetAllFn()" class="btmBtns1" style="border-radius:8px;background:grey;
          cursor:pointer;box-shadow: inset -1px -1px 4px 1px rebeccapurple;">
          <span style="border-radius:100%;background:rebeccapurple;border:1px solid grey;">
            üé°</span> <span class="btnTXT hoverTXT">RESTART</span>
       </button>
      </footer>
      <legal style="color:darkslategray;font-size: 0.666em;">copyright 2020-2023 netcinematics llc, all rights reserved.
        this is a personal ledger system, not financial advice. 
        It is not intended for day trading use, but quarterly and monthly review.
      </legal>
      <script>
        const currentDate = new Date();
        const year = currentDate.getFullYear();
        const month = (currentDate.getMonth() + 1).toString().padStart(2, '0'); // Adding 1 because months are zero-indexed
        const day = currentDate.getDate().toString().padStart(2, '0');
        let current_ymd = `YMD_${year}_${month}_${day}`;

        let keyBOX = document.getElementById('keyBOX');
        let keyINPUT = document.getElementById('keyINPUT');
        let symbolINPUT = document.getElementById('symbolINPUT');
        
        let stateConnectedBox = document.getElementById('ConnectedBox');
        let stateNotConnectedBox = document.getElementById('notConnectedBox');

        let encodeBOX = document.getElementById('encodeBOX');
        let encodeDATA = document.getElementById('encodeDATA');
        let decodeBOX = document.getElementById('decodeBOX');
        let decodeSPOTZ = document.getElementById('decodeSPOTZ');
        let scheduleBOX = document.getElementById('scheduleBOX')
        let allMarginsBOX = document.getElementById('allMarginsBOX')

        let saveTickBtn1 = document.getElementById('saveTickBtn1');
        let saveSpotBtn1 = document.getElementById('saveSpotBtn1');
        let saveScheduleBtn1 = document.getElementById('saveScheduleBtn1');

        let generatedScheduleBOX = document.getElementById('generatedScheduleBOX');         
        let generatedProfitsBOX = document.getElementById('generatedProfitsBOX');
        let generatedMarginsBOX = document.getElementById('generatedMarginsBOX');

        let detailsBtn1 = document.getElementById('detailsBtn1');
        let detailsBtn2 = document.getElementById('detailsBtn2');
        let totalsBtn1 = document.getElementById('totalsBtn1');
        let totalsBtn2 = document.getElementById('totalsBtn2');
        let openBtn1 = document.getElementById('openBtn1');

        //FINANCIAL - ANALYTICS - CALCULATIONS
        let target_SYMBOL = 'NVDA';
        let daily_data = null;
        let monthly_data = null;
        let calculate_ATH = 0;
        let calculate_ATL = 0;
        let current_PRICE = 0;

         /************************************************\
          * - AI_LEDGER
          *  - ability to save in localstorage
          * ***********************************************/
         let ai_ledger=null;
         let ai_ticks=[],ai_spots=[];
         let ai_tick={}, ai_spot={};
        let ai_ledger_LOAD_from_LOCALSTORAGE=()=>{ //READ from LOCAL STORAGE
            ai_ledger = (localStorage.ai_ledger)?
               JSON.parse( localStorage.ai_ledger ):null;
            if(!ai_ledger){ ai_ledger_LOAD_MOCK_DATA(); }
        }; ai_ledger_LOAD_from_LOCALSTORAGE();

        let ai_ledger_LOAD_MOCK_DATA=()=>{ //READ from OBJ
            //ai_ledger = {"ticks":[{"tick":"NVDA","price":"483","ath":"493","ath_ymd":"2023_08_31","price_ymd":"2023_11_11"},{"tick":"MDB","price":"375","ath":"569","ath_ymd":"2021_09_19","price_ymd":"2023_11_11"},{"tick":"MSFT","price":"369","ath":"344","ath_ymd":"2023_07_14","price_ymd":"2023_11_11"},{"tick":"GOOGL","price":"132","ath":"150","ath_ymd":"2021_11_19","price_ymd":"2023_11_11"},{"tick":"QQQ","price":"377","ath":"400","ath_ymd":"2021_11_19","price_ymd":"2023_11_11"},{"tick":"XLK","price":"179","ath":"180","ath_ymd":"2023_07_18","price_ymd":"2023_11_11"},{"tick":"NDAQ","price":"52","ath":"70","ath_ymd":"2021_11_05","price_ymd":"2023_11_11"},{"tick":"COIN","price":"93","ath":"105","ath_ymd":"2023_07_14","price_ymd":"2023_11_11"},{"tick":"V","price":"245","ath":"250","ath_ymd":"2023_09_13","price_ymd":"2023_11_11"},{"tick":"COST","price":"576","ath":"590","ath_ymd":"2022_04_08","price_ymd":"2023_11_11"},{"tick":"AMD","price":"118","ath":"130","ath_ymd":"2023_06_12","price_ymd":"2023_11_11"}],
            //   "spots":[{"tick":"NVDA","amount":"200","spot_at":"412","ymd":"2023_10_20","role":"TRIM"},{"tick":"NVDA","amount":"300","spot_at":"459","ymd":"2023_10_10","role":"HOLD"},{"tick":"COST","amount":"200","spot_at":"552","ymd":"2023_10_20","role":"SAFE"},{"tick":"MDB","amount":"300","spot_at":"370","ymd":"2023_10_12","role":"WATCH"},{"tick":"MDB","amount":"200","spot_at":"333","ymd":"2023_09_21","role":"WATCH"},{"tick":"FSLR","amount":"0","spot_at":"0","ymd":"2023_11_02","role":"..."},{"tick":"NDAQ","amount":"180","spot_at":"49","ymd":"2023_09_22","role":"TRIM"},{"tick":"V","amount":"200","spot_at":"232","ymd":"2023_10_24","role":"HOLD"},{"tick":"GOOGL","amount":"500","spot_at":"130","ymd":"2023_09_29","role":"TRIM"},{"tick":"QQQ","amount":"500","spot_at":"370","ymd":"2023_11_09","role":"TRIM"},{"tick":"XLK","amount":"300","spot_at":"168","ymd":"2023_09_18","role":"TRIM"},{"tick":"MSFT","amount":"100","spot_at":"330","ymd":"2023_10_26","role":"HOLD"},{"tick":"MSFT","amount":"100","spot_at":"339","ymd":"2023_10_25","role":"HOLD"},{"tick":"MSFT","amount":"200","spot_at":"316","ymd":"2023_10_02","role":"TRIM"},{"tick":"AMD","amount":"200","spot_at":"102","ymd":"2023_10_02","role":"WATCH"}]}
            // ai_ledger = {"ticks":[{"tick":"NVDA","price":"477","ath":"493","ath_ymd":"2023_08_31","price_ymd":"2023_11_27"},{"tick":"MDB","price":"407","ath":"569","ath_ymd":"2021_09_19","price_ymd":"2023_11_27"},{"tick":"MSFT","price":"377","ath":"371","ath_ymd":"2023_07_14","price_ymd":"2023_11_27"},{"tick":"GOOGL","price":"136","ath":"150","ath_ymd":"2021_11_19","price_ymd":"2023_11_27"},{"tick":"QQQ","price":"389","ath":"400","ath_ymd":"2021_11_19","price_ymd":"2023_11_27"},{"tick":"XLK","price":"184","ath":"182","ath_ymd":"2023_07_18","price_ymd":"2023_11_27"},{"tick":"NDAQ","price":"55","ath":"70","ath_ymd":"2021_11_05","price_ymd":"2023_11_27"},{"tick":"COIN","price":"115","ath":"105","ath_ymd":"2023_07_14","price_ymd":"2023_11_27"},{"tick":"V","price":"254","ath":"250","ath_ymd":"2023_09_13","price_ymd":"2023_11_27"},{"tick":"COST","price":"592","ath":"596","ath_ymd":"2022_04_08","price_ymd":"2023_11_27"},{"tick":"AMD","price":"122","ath":"130","ath_ymd":"2023_06_12","price_ymd":"2023_11_27"},{"tick":"BTC","price":"20000"},{"tick":"ETH","price":"2000"}],"spots":[{"tick":"NVDA","amount":"200","spot_at":"412","ymd":"2023_10_20","role":"TRIM"},{"tick":"NVDA","amount":"300","spot_at":"459","ymd":"2023_10_10","role":"HOLD"},{"tick":"COST","amount":"200","spot_at":"552","ymd":"2023_10_20","role":"SAFE"},{"tick":"MDB","amount":"300","spot_at":"370","ymd":"2023_10_12","role":"WATCH"},{"tick":"MDB","amount":"200","spot_at":"333","ymd":"2023_09_21","role":"WATCH"},{"tick":"V","amount":"200","spot_at":"232","ymd":"2023_10_24","role":"HOLD"},{"tick":"GOOGL","amount":"500","spot_at":"130","ymd":"2023_09_29","role":"TRIM"},{"tick":"QQQ","amount":"500","spot_at":"370","ymd":"2023_11_09","role":"TRIM"},{"tick":"XLK","amount":"300","spot_at":"168","ymd":"2023_09_18","role":"TRIM"},{"tick":"MSFT","amount":"100","spot_at":"330","ymd":"2023_10_26","role":"HOLD"},{"tick":"MSFT","amount":"200","spot_at":"316","ymd":"2023_10_02","role":"TRIM"},{"tick":"AMD","amount":"200","spot_at":"102","ymd":"2023_10_02","role":"WATCH"}]}
            // ai_ledger = {"ticks":[{"tick":"NVDA","price":"465","ath":"493","ath_ymd":"2023_08_31","price_ymd":"2023_11_30"},{"tick":"MDB","price":"432","ath":"569","ath_ymd":"2021_09_19","price_ymd":"2023_11_30"},{"tick":"MSFT","price":"379","ath":"371","ath_ymd":"2023_07_14","price_ymd":"2023_11_30"},{"tick":"GOOGL","price":"135","ath":"150","ath_ymd":"2021_11_19","price_ymd":"2023_11_30"},{"tick":"QQQ","price":"390","ath":"400","ath_ymd":"2021_11_19","price_ymd":"2023_11_30"},{"tick":"XLK","price":"184","ath":"182","ath_ymd":"2023_07_18","price_ymd":"2023_11_30"},{"tick":"COIN","price":"127","ath":"105","ath_ymd":"2023_07_14","price_ymd":"2023_11_30"},{"tick":"V","price":"254","ath":"250","ath_ymd":"2023_09_13","price_ymd":"2023_11_30"},{"tick":"COST","price":"587","ath":"596","ath_ymd":"2022_04_08","price_ymd":"2023_11_30"},{"tick":"AMD","price":"124","ath":"130","ath_ymd":"2023_06_12","price_ymd":"2023_11_30"},{"tick":"TSLA","price":"245","price_ymd":"2023_11_30"},{"tick":"META","price":"332","price_ymd":"2023_11_30"}],"spots":[{"tick":"NVDA","amount":"100","spot_at":"486","ymd":"2023_11_22","role":"WATCH"},{"tick":"NVDA","amount":"200","spot_at":"494","ymd":"2023_11_17","role":"LONG"},{"tick":"NVDA","amount":"200","spot_at":"412","ymd":"2023_10_20"},{"tick":"NVDA","amount":"300","spot_at":"459","ymd":"2023_10_10","role":"LONG"},{"tick":"MDB","amount":"200","spot_at":"333","ymd":"2023_09_21","role":"WATCH"},{"tick":"V","amount":"200","spot_at":"232","ymd":"2023_10_24","role":"HOLD"},{"tick":"GOOGL","amount":"500","spot_at":"130","ymd":"2023_09_29","role":"TRIM"},{"tick":"QQQ","amount":"500","spot_at":"370","ymd":"2023_11_09","role":"TRIM"},{"tick":"XLK","amount":"300","spot_at":"168","ymd":"2023_09_18","role":"TRIM"},{"tick":"MSFT","amount":"100","spot_at":"330","ymd":"2023_10_26","role":"HOLD"},{"tick":"MSFT","amount":"200","spot_at":"316","ymd":"2023_10_02","role":"TRIM"},{"tick":"AMD","amount":"200","spot_at":"102","ymd":"2023_10_02","role":"LONG"},{"tick":"TSLA","amount":"100","spot_at":"235","ymd":"2023_11_30","role":"PAD"},{"tick":"FSLR","ymd":"2023_11_30","role":"WATCH"},{"tick":"AMZN","ymd":"2023_11_30","role":"WATCH"},{"tick":"META","amount":"100","spot_at":"326","ymd":"2023_11_30","role":"PAD"}]};
            ai_ledger = {"ticks":[{"tick":"NVDA","price":"467","ath":"493","ath_ymd":"2023_08_31","price_ymd":"2023_12_01"},{"tick":"MDB","price":"438","ath":"569","ath_ymd":"2021_09_19","price_ymd":"2023_12_01"},{"tick":"MSFT","price":"374","ath":"371","ath_ymd":"2023_07_14","price_ymd":"2023_12_01"},{"tick":"GOOGL","price":"131","ath":"150","ath_ymd":"2021_11_19","price_ymd":"2023_12_01"},{"tick":"QQQ","price":"390","ath":"400","ath_ymd":"2021_11_19","price_ymd":"2023_12_01"},{"tick":"XLK","price":"185","ath":"182","ath_ymd":"2023_07_18","price_ymd":"2023_12_01"},{"tick":"COIN","price":"134","ath":"105","ath_ymd":"2023_07_14","price_ymd":"2023_12_01"},{"tick":"V","price":"256","ath":"250","ath_ymd":"2023_09_13","price_ymd":"2023_12_01"},{"tick":"COST","price":"596","ath":"596","ath_ymd":"2022_04_08","price_ymd":"2023_12_01"},{"tick":"AMD","price":"121","ath":"130","ath_ymd":"2023_06_12","price_ymd":"2023_12_01"},{"tick":"TSLA","price":"238","price_ymd":"2023_12_01"},{"tick":"META","price":"324","price_ymd":"2023_12_01"},{"tick":"PINS"},{"tick":"FVRR"}],"spots":[{"tick":"NVDA","amount":"100","spot_at":"486","ymd":"2023_11_22","role":"WATCH"},{"tick":"NVDA","amount":"200","spot_at":"494","ymd":"2023_11_17","role":"LONG"},{"tick":"NVDA","amount":"200","spot_at":"412","ymd":"2023_10_20","role":"LOrLO"},{"tick":"NVDA","amount":"300","spot_at":"459","ymd":"2023_10_10","role":"LONG"},{"tick":"MDB","amount":"200","spot_at":"333","ymd":"2023_09_21","role":"WATCH"},{"tick":"V","amount":"200","spot_at":"232","ymd":"2023_10_24","role":"HOLD"},{"tick":"GOOGL","amount":"500","spot_at":"130","ymd":"2023_09_29","role":"TRIM"},{"tick":"QQQ","amount":"500","spot_at":"370","ymd":"2023_11_09","role":"TRIM"},{"tick":"XLK","amount":"300","spot_at":"168","ymd":"2023_09_18","role":"TRIM"},{"tick":"MSFT","amount":"100","spot_at":"330","ymd":"2023_10_26","role":"HOLD"},{"tick":"MSFT","amount":"200","spot_at":"316","ymd":"2023_10_02","role":"TRIM"},{"tick":"AMD","amount":"200","spot_at":"102","ymd":"2023_10_02","role":"LONG"},{"tick":"TSLA","amount":"100","spot_at":"235","ymd":"2023_11_30","role":"PAD"},{"tick":"FSLR","ymd":"2023_11_30","role":"WATCH"},{"tick":"AMZN","ymd":"2023_11_30","role":"WATCH"},{"tick":"META","amount":"100","spot_at":"326","ymd":"2023_11_30","role":"PAD"}]}
        }

        let initEncode = ()=>{
            console.log('load ai_ledger');//populate encode table
            let encodeRow,tick1,priceData1,priceDate1,priceBOX1;
            let athData1,athDate1,athBOX1,del1,btn1 = null;
            let encodeNUMBOX1,encodeCHECKBOX1,encodeSelect1;
            let uniqueMAP={};
            encodeDATA.innerHTML=''; //blank out reload.
            for(var i=0; i<ai_ledger.ticks.length;i++){
               if(uniqueMAP[ai_ledger.ticks[i].tick]){continue;}
               encodeRow = document.createElement('article')
               encodeNUMBOX1 = document.createElement('aside')
               encodeNUMBOX1.classList.add('encodeNUMBOX1')
               encodeCHECKBOX1 = document.createElement('label')
               encodeCHECKBOX1.classList.add('checkboxFrame') //encodeNUMBOX1
               encodeNUMBOX1.innerHTML=i+1;            
               encodeSelect1 = document.createElement('input')
               encodeSelect1.type = "checkbox";
               encodeSelect1.classList.add('tkr_checkmark')
               encodeCHECKBOX1.appendChild(encodeSelect1)
               encodeCheckMark1 = document.createElement('span')
               encodeCheckMark1.classList.add('checkmark')
               encodeCHECKBOX1.appendChild(encodeCheckMark1)
               encodeNUMBOX1.appendChild(encodeCHECKBOX1)

               priceBOX1 = document.createElement('aside')
               athBOX1 = document.createElement('aside')
               priceBOX1.innerHTML = "close $&nbsp;"
               athBOX1.innerHTML = "ath&nbsp;"
               tick1 = document.createElement('input')
               priceData1 = document.createElement('input')
               priceDate1 = document.createElement('input')
               athData1 = document.createElement('input')
               athDate1 = document.createElement('input')
               btn1 = document.createElement('button')
               del1 = document.createElement('button')
               del1.innerHTML = 'üóëÔ∏è'
               del1.classList.add('delBtn1')
               del1.setAttribute('data-arg1',i)
               del1.addEventListener('click',(e)=>{
                  deleteTickerClick(e.target.getAttribute('data-arg1'))})
               btn1.innerHTML = 'gener8‚ö°'
               tick1.value = ai_ledger.ticks[i].tick.toUpperCase();
               tick1.readOnly = false;
               tick1.addEventListener("keyup",(e)=>{
                  saveTickBtn1.style.display = 'block'; });
               athData1.addEventListener("keyup",(e)=>{
                  saveTickBtn1.style.display = 'block'; });
               athDate1.addEventListener("keyup",(e)=>{
                  saveTickBtn1.style.display = 'block'; });
               priceData1.addEventListener("keyup",(e)=>{
                  saveTickBtn1.style.display = 'block'; });
               priceDate1.addEventListener("keyup",(e)=>{
                  saveTickBtn1.style.display = 'block'; });
               priceData1.placeholder = "$0.00";
               priceDate1.placeholder = "yyyy_mm_dd";
               priceData1.value = ai_ledger.ticks[i].price || '';
               priceDate1.value = ai_ledger.ticks[i].price_ymd || '';
               athData1.placeholder = "$0.00";
               athData1.value = ai_ledger.ticks[i].ath || '';
               athDate1.placeholder = "yyyy_mm_dd";
               athDate1.value = ai_ledger.ticks[i].ath_ymd || '';
               tick1.classList.add('genTicker1')
               priceData1.classList.add('tkrPriceData1')
               priceDate1.classList.add('tkrPriceDate1')
               priceBOX1.classList.add('tkrPriceBOX1')
               athData1.classList.add('tkrATHData1')
               athDate1.classList.add('tkrATHDate1')
               athBOX1.classList.add('tkrATHBOX1')
               btn1.classList.add('genBtn1')
               encodeRow.classList.add('genRow1')
               encodeRow.appendChild(encodeNUMBOX1)
               encodeRow.appendChild(tick1)
               priceBOX1.appendChild(priceData1)
               priceBOX1.appendChild(priceDate1)
               encodeRow.appendChild(priceBOX1)
               athBOX1.appendChild(athData1)
               athBOX1.appendChild(athDate1)
               encodeRow.appendChild(athBOX1)
               // encodeRow.appendChild(btn1)
               // encodeRow.appendChild(del1)
               encodeDATA.appendChild(encodeRow)
               uniqueMAP[ai_ledger.ticks[i].tick] = ai_ledger.ticks[i];
            }
        }; initEncode();

        let initDecode = ()=>{
         let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11,role12;         
         let decodeRow1,date1,tick1,amountData1,amountBOX1,atData1,atBOX1;
         let btn1,roleBOX,roleData,decodeNUMBOX, decodeSelect1,decodeCHECKBOX1;
         decodeSPOTZ.innerHTML=''; //blank out reload.
         for(var i=0; i<ai_ledger.spots.length;i++){
            decodeRow1 = document.createElement('article')
            decodeRow1.classList.add('decodeRow1')
            decodeNUMBOX1 = document.createElement('aside')
            decodeNUMBOX1.classList.add('decodeNUMBOX1')
            decodeCHECKBOX1 = document.createElement('label')
            decodeCHECKBOX1.classList.add('checkboxFrame') //decodeNUMBOX1
            decodeNUMBOX1.innerHTML=i+1;            
            decodeSelect1 = document.createElement('input')
            decodeSelect1.type = "checkbox";
            decodeSelect1.classList.add('spot_checkmark')
            decodeCHECKBOX1.appendChild(decodeSelect1)
            decodeCheckMark1 = document.createElement('span')
            decodeCheckMark1.classList.add('checkmark')
            decodeCHECKBOX1.appendChild(decodeCheckMark1)
            decodeNUMBOX1.appendChild(decodeCHECKBOX1)
            amountBOX1 = document.createElement('aside')
            atBOX1 = document.createElement('aside')
            atBOX1.innerHTML="@&nbsp;"
            roleBOX = document.createElement('aside')
            roleBOX.innerHTML="role&nbsp;"
            roleData = document.createElement('select')
            role1 = document.createElement('option')
            role2 = document.createElement('option')
            role3 = document.createElement('option')
            role4 = document.createElement('option')
            role5 = document.createElement('option')
            role6 = document.createElement('option')
            role7 = document.createElement('option')
            role8 = document.createElement('option')
            role9 = document.createElement('option')
            role10 = document.createElement('option')
            role11 = document.createElement('option')
            role12 = document.createElement('option')
            role1.value = "...";
            role2.value = "HOLD";
            role3.value = "WATCH";
            role4.value = "RISKOFF";
            role5.value = "LONG";
            role6.value = "TRIM";
            role7.value = "SAFE";
            role8.value = "RISKON";
            role9.value = "EXIT";
            role10.value = "PAD";
            role11.value = "LOrLO";
            role12.value = "HIrHI";
            role1.innerHTML = "...";
            role2.innerHTML = "HOLD";
            role3.innerHTML = "WATCH";
            role4.innerHTML = "RISKOFF";
            role5.innerHTML = "LONG";
            role6.innerHTML = "TRIM";
            role7.innerHTML = "SAFE";
            role8.innerHTML = "RISKON";
            role9.innerHTML = "EXIT";
            role10.innerHTML = "PAD";
            role11.innerHTML = "LOrLO";
            role12.innerHTML = "HIrHI";            
            roleData.appendChild(role1);
            roleData.appendChild(role2);
            roleData.appendChild(role3);
            roleData.appendChild(role4);
            roleData.appendChild(role5);
            roleData.appendChild(role6);
            roleData.appendChild(role7);
            roleData.appendChild(role8);
            roleData.appendChild(role9);
            roleData.appendChild(role10);
            roleData.appendChild(role11);
            roleData.appendChild(role12);
            roleData.value = ai_ledger.spots[i].role || '';
            roleBOX.appendChild(roleData)
            roleBOX.classList.add('roleBOX1')
            roleData.classList.add('roleData1')
         
            date1 = document.createElement('input')
            date1.value = ai_ledger.spots[i].ymd || '';
            date1.classList.add('decodeDate1')
            date1.addEventListener("keyup",(e)=>{
                  saveSpotBtn1.style.display = 'block'; });
            tick1 = document.createElement('input')
            amountData1 = document.createElement('input')
            btn1 = document.createElement('button')
            del1 = document.createElement('button')
            del1.innerHTML = 'üóëÔ∏è'
            del1.classList.add('delBtn1')
            del1.setAttribute('data-arg1',i)
            del1.addEventListener('click',(e)=>{
               deleteSpotClick(e.target.getAttribute('data-arg1'))})            
               btn1.innerHTML = '‚ú®Lock Profit/Lossüí•'
               tick1.value = ai_ledger.spots[i].tick || '';
               tick1.readOnly = false;
               amountData1.placeholder = "start:$0.00";
               amountData1.value = ai_ledger.spots[i].amount || '';
            atData1 = document.createElement('input')
            atData1.placeholder = "$0.00";
            atData1.value = ai_ledger.spots[i].spot_at || '';
            tick1.addEventListener("keyup",(e)=>{
                  saveSpotBtn1.style.display = 'block'; });            
            atData1.addEventListener("keyup",(e)=>{
                  saveSpotBtn1.style.display = 'block'; });
            amountData1.addEventListener("keyup",(e)=>{
                  saveSpotBtn1.style.display = 'block'; }); 
            roleData.addEventListener("change",(e)=>{
                  saveSpotBtn1.style.display = 'block'; });
            roleBOX.value = ai_ledger.spots[i].role || '...';
                         
            tick1.classList.add('decodeTick1')
            amountBOX1.classList.add('spotamountBOX1')
            amountData1.classList.add('spotamountData1')
            atData1.classList.add('spotAtData1')
            atBOX1.classList.add('spotAtBOX1')
            btn1.classList.add('decBtn1')
            decodeRow1.appendChild(decodeNUMBOX1)
            decodeRow1.appendChild(date1)
            decodeRow1.appendChild(tick1)
            amountBOX1.innerHTML="$&nbsp;"
            amountBOX1.appendChild(amountData1)
            decodeRow1.appendChild(amountBOX1)
            atBOX1.appendChild(atData1)
            decodeRow1.appendChild(atBOX1)
            decodeRow1.appendChild(roleBOX)
            // decodeRow1.appendChild(btn1)
            // decodeRow1.appendChild(del1)
            decodeSPOTZ.appendChild(decodeRow1)   
                  
         }
        }; initDecode();

        
        let stock_api_key = null;//API_KEY - set in local storage.
        let init_api_key = ()=>{
            //Does local storage have API_KEY?
            // if(!localStorage.stock_api_key){ //if no: display enter key
            //     stateConnectedBox.style.display = "none";
            //     stateNotConnectedBox.style.display = "inline";                   
            //     symbolBOX.style.display = "none";
            //     keyBOX.style.display = "inline";                   
            //     //SHOW NOT CONNECTED. Hide connected. Hide tgt show key input.
            // } else {//if yes init
            //     //SHOW CONNNECTED and tgt, hide disconnected and key input
            //     stateConnectedBox.style.display = "inline";
            //     stateNotConnectedBox.style.display = "none";   
            //     symbolBOX.style.display = "inline";
            //     keyBOX.style.display = "none"; 

            //     stock_api_key = (localStorage.stock_api_key)?localStorage.stock_api_key:'';
            //     //initLedger() 
            // }

    //         if(!stock_api_key){return;}
    //         // const apiKey = '';
    //         const symbol = 'NVDA';
    //         const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${symbol}&interval=5min&apikey=${stock_api_key}`;
    //         fetch(apiUrl)
    //         .then(response => response.json())
    //         .then(data => {
    //             // Process the data here (e.g., extract the latest stock price)
    //             const latestPrice = data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]]['1. open'];

    // //             data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]]['1. open'];
    // // '175.3700'
    // // data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]];
    // // {1. open: '175.3700', 2. high: '175.3700', 3. low: '175.0000', 4. close: '175.0000', 5. volume: '24782'}
    //             console.log(`Latest price for ${symbol}: ${latestPrice}`);
    //         })
    //         .catch(error => {
    //             console.error('Error fetching data:', error);
    //         });
        }; //init_api_key();
        let init_monthly = ()=>{
            // replace the "demo" apikey below with your own key from https://www.alphavantage.co/support/#api-key
            // var url = 'https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY_ADJUSTED&symbol=IBM&apikey=demo';
            if(!stock_api_key){return;}
            if(localStorage.monthly_NVDA_data){ //LOAD FROM LOCAL not API.
                monthly_data = JSON.parse(localStorage.monthly_NVDA_data);
                // let, val_ath=0,val_atl=0,curr_price=0,perc_off_ath=0;
                let data_keys = Object.keys(monthly_data);
                for(let i=0; i<data_keys.length;i++){
                    daily_data = monthly_data[data_keys[i]];
                    if(parseFloat(daily_data["2. high"]) > calculate_ATH){
                        calculate_ATH = parseFloat(daily_data["2. high"])
                    }
                    if(parseFloat(daily_data["3. low"]) < calculate_ATL || calculate_ATL===0){
                        calculate_ATL = parseFloat(daily_data["3. low"])
                    }
                }
                console.log('ATH:',calculate_ATH)
                console.log('ATL:',calculate_ATL)
                console.log('Curr Price:', current_PRICE)
                console.log('%off ATH', perc_off_ath)
                return;
            }
            // const apiKey = '';
            // const symbol = 'NVDA';
            const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY_ADJUSTED&symbol=${target_SYMBOL}&apikey=${stock_api_key}`;
            fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                localStorage.monthly_NVDA_data = JSON.stringify(data["Monthly Adjusted Time Series"]);

            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });
        }; //init_monthly();

        let setAPIKEY = ()=>{
            if(keyINPUT.value){
                stock_api_key = keyINPUT.value;
               //  localStorage.stock_api_key = stock_api_key
               //  debugger;
               getData_TestConnection();
               //  initLedger()
            }
        }
 
      const addTickerClick = ()=>{ 
         saveTickBtn1.style.display = 'block';
         let encodeRow,tick1,priceData1,priceDate1,athData1,athDate1,athBOX1,saveBtn2;
         encodeRow = document.createElement('article')
         priceBOX1 = document.createElement('aside')
         athBOX1 = document.createElement('aside')
         priceBOX1.innerHTML="now&nbsp;"
         athBOX1.innerHTML="ath&nbsp;"
         tick1 = document.createElement('input')
         priceData1 = document.createElement('input')
         priceDate1 = document.createElement('input')
         athData1 = document.createElement('input')
         athDate1 = document.createElement('input')
         saveBtn2 = document.createElement('button')
         tick1.value = "";
         tick1.readOnly = false;
         tick1.placeholder = "ticker";
         priceData1.placeholder = "$0.00";
         priceDate1.placeholder = "yyyy_mm_dd";
         athData1.placeholder = "$0.00";
         athDate1.placeholder = "yyyy_mm_dd";
         tick1.classList.add('genTicker1')
         tick1.style.margin='1em 0 1em 0';
         priceData1.classList.add('tkrPriceData1')
         priceDate1.classList.add('tkrPriceDate1')
         priceBOX1.classList.add('tkrPriceBOX1')
         priceData1.style.margin='1em 0 1em 0';
         priceDate1.style.margin='1em 0 1em 0';
         athData1.classList.add('tkrATHData1') //todo remove genATH1 and rename
         athDate1.classList.add('tkrATHDate1') //todo remove genATH1 and rename
         athBOX1.classList.add('tkrATHBOX1')
         athData1.style.margin='1em 0 1em 0';
         athDate1.style.margin='1em 0 1em 0';
         saveBtn2.innerHTML = 'saveüåü'
         saveBtn2.classList.add('saveBtn2')
         saveBtn2.addEventListener("click",(e)=>{
            saveTickerClick() });
         athData1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         athDate1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         priceData1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         priceDate1.addEventListener("keyup",(e)=>{
            saveTickBtn1.style.display = 'block'; });
         encodeRow.classList.add('genRow1')
         encodeRow.appendChild(tick1)
         priceBOX1.appendChild(priceData1)
         priceBOX1.appendChild(priceDate1)
         encodeRow.appendChild(priceBOX1)
         athBOX1.appendChild(athData1)
         athBOX1.appendChild(athDate1)
         encodeRow.appendChild(athBOX1)
         encodeRow.appendChild(saveBtn2)
         // encodeRow.appendChild(del1)
         encodeDATA.appendChild(encodeRow)         
      }
      const saveTickerClick = ()=>{//loop elements, add data, localstorage
           saveTickBtn1.style.display = 'none';
           let items = encodeDATA.children,row,kids,kid;
           let tkr,price,ath,item=null;
           ai_ledger.ticks = []; //CLEAR LEDGER.
           for(var i=0; i<items.length;i++){ //LOOP DOM ROWS
            item = items[i];
            if(item.classList.contains('genRow1')){ //todo FORM remove btns
               kids = item.children;
               tkr = '';price='',ath='';//blank row.
               for(var j=0; j<kids.length;j++){ //LOOP ROW ITEMS
                  kid = kids[j];
                  if(kid.classList.contains('genTicker1')){
                     kid.value = kid.value.toUpperCase();
                     tkr = kid.value;
                     continue;
                  } if(kid.classList.contains('tkrPriceBOX1')){
                     price = kid.children[0].value;
                     // price_label = kid.innerHTML;
                     price_ymd = kid.children[1].value;
                     continue;
                  } if(kid.classList.contains('tkrATHBOX1')){
                     ath = kid.children[0].value;
                     ath_ymd = kid.children[1].value;
                     continue;                  
                  }
               }
            }
            if(tkr){
               let tickObj = new Object();
               tickObj.tick = tkr;
               if(price){tickObj.price = price}
               // if(price_label){tickObj.price_label = price_label}
               // if(price_label){tickObj.price_label = "now"}
               if(ath){tickObj.ath = ath}
               if(ath_ymd){tickObj.ath_ymd = ath_ymd}
               if(price_ymd){tickObj.price_ymd = price_ymd}
               ai_ledger.ticks.push(tickObj)
            }
           }
           //SAVE to LOCAL STORAGE
           localStorage.ai_ledger = JSON.stringify(ai_ledger)  
           initEncode(); //RELOAD VIEW.         
        }
      const saveSpotClick = ()=>{
           saveSpotBtn1.style.display = 'none';
           let items = decodeSPOTZ.children,row,kids,kid;
           let tkr,amount1,date1,role1,item,spot_at;
           ai_ledger.spots = []; //CLEAR LEDGER.  
           for(var i=0; i<items.length;i++){
            item = items[i];
            if(item.classList.contains('decodeRow1')){
               kids = item.children;
               tkr = '',amount1='',date1='',ath='';//blank row.
               for(var j=0; j<kids.length;j++){
                  kid = kids[j];
                  if(kid.classList.contains('decodeTick1')){
                     kid.value = kid.value.toUpperCase();                     
                     tkr = kid.value;
                  } if(kid.classList.contains('decodeDate1')){
                     date1 = kid.value;
                  } if(kid.classList.contains('spotAtBOX1')){
                     spot_at = kid.lastChild.value;
                  } if(kid.classList.contains('spotamountBOX1')){
                     amount1 = kid.lastChild.value;
                  } if(kid.classList.contains('roleBOX1')){
                     role1 = kid.lastChild.value;
                  } 
               }
            }
            if(tkr){
               let spotObj = new Object();
               spotObj.tick = tkr;
               if(amount1){spotObj.amount = amount1}
               if(spot_at){spotObj.spot_at = spot_at}
               if(date1){spotObj.ymd = date1}
               if(role1){spotObj.role = role1}
               ai_ledger.spots.push(spotObj)
            } else { console.log('unsaved record',i) }
           } 
           //SAVE to LOCAL STORAGE
           localStorage.ai_ledger = JSON.stringify(ai_ledger) 
           initDecode(); //RELOAD VIEW.                      
         }
         const addSpotClick = ()=>{
            saveSpotBtn1.style.display = 'block';
            let decodeRow1,date1,tick1,amountData1;
            let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11,role12;
            let saveBtn3,roleBOX,roleData,atBOX1,atData1;
            decodeRow1 = document.createElement('article')
            decodeRow1.classList.add('decodeRow1')
            atBOX1 = document.createElement('aside')
            atBOX1.innerHTML="@&nbsp;"
            roleBOX = document.createElement('aside')
            roleBOX.innerHTML="role&nbsp;"
            roleData = document.createElement('select')
            role1 = document.createElement('option')
            role2 = document.createElement('option')
            role3 = document.createElement('option')
            role4 = document.createElement('option')
            role5 = document.createElement('option')
            role6 = document.createElement('option')
            role7 = document.createElement('option')
            role8 = document.createElement('option')
            role9 = document.createElement('option')
            role10 = document.createElement('option')
            role11 = document.createElement('option')
            role12 = document.createElement('option')
            role1.value = "...";
            role2.value = "HOLD";
            role3.value = "WATCH";
            role4.value = "CUTLOSS";
            role5.value = "LONG";
            role6.value = "TRIM";
            role7.value = "SAFE";
            role8.value = "RISK_ON";
            role9.value = "EXIT";
            role10.value = "PAD";
            role11.value = "HIrHI";
            role12.value = "LOrLO";
            role1.innerHTML = "...";
            role2.innerHTML = "HOLD";
            role3.innerHTML = "WATCH";
            role4.innerHTML = "CUTLOSS";
            role5.innerHTML = "LONG";
            role6.innerHTML = "TRIM";
            role7.innerHTML = "SAFE";
            role8.innerHTML = "RISK_ON";
            role9.innerHTML = "EXIT";
            role10.innerHTML = "PAD";
            role11.innerHTML = "HIrHI";
            role12.innerHTML = "LOrLO";            
            roleData.appendChild(role1);
            roleData.appendChild(role2);
            roleData.appendChild(role3);
            roleData.appendChild(role4);
            roleData.appendChild(role5);
            roleData.appendChild(role6);
            roleData.appendChild(role7);
            roleData.appendChild(role8);
            roleData.appendChild(role9);            
            roleData.appendChild(role10);            
            roleData.appendChild(role11);            
            roleData.appendChild(role12);            
            roleBOX.appendChild(roleData)
            roleBOX.classList.add('roleBOX1')
            roleData.classList.add('roleData1')
            atData1 = document.createElement('input')
            atData1.placeholder = "$0.00";
            saveBtn3 = document.createElement('button')
            date1 = document.createElement('input')
            date1.value = current_ymd.split('YMD_')[1];//user display
            date1.classList.add('decodeDate1')
            tick1 = document.createElement('input')
            amountData1 = document.createElement('input')
            amountBOX1 = document.createElement('aside')
            athBOX1 = document.createElement('aside')
            amountBOX1.innerHTML = "$&nbsp;"
            athBOX1.innerHTML = "ath&nbsp;"
            athData1 = document.createElement('input')
            tick1.value = "";
            tick1.readOnly = false;
            tick1.placeholder="ticker"
            amountData1.placeholder = "0.00";
            athData1.placeholder = "+-:%";
            tick1.addEventListener("keyup",(e)=>{
               saveSpotBtn1.style.display = 'block'; });
            athData1.addEventListener("keyup",(e)=>{
               saveSpotBtn1.style.display = 'block'; });
            amountData1.addEventListener("keyup",(e)=>{
               saveSpotBtn1.style.display = 'block'; });                         
            tick1.classList.add('decodeTick1')
            saveBtn3.innerHTML = 'saveüåü'
            saveBtn3.classList.add('saveBtn2')
            saveBtn3.addEventListener("click",(e)=>{
               saveSpotClick() });
            amountData1.classList.add('spotamountData1')
            amountBOX1.classList.add('spotamountBOX1')
            athData1.classList.add('spotATHData1')
            athBOX1.classList.add('spotATHBOX1')
            decodeRow1.appendChild(date1)
            decodeRow1.appendChild(tick1)
            amountBOX1.appendChild(amountData1)
            decodeRow1.appendChild(amountBOX1)
            // athBOX1.appendChild(athData1)
            atData1.classList.add('spotAtData1')
            atBOX1.classList.add('spotAtBOX1')
            atBOX1.appendChild(atData1)            
            decodeRow1.appendChild(atBOX1)
            decodeRow1.appendChild(roleBOX)
            decodeRow1.appendChild(saveBtn3)
            decodeSPOTZ.appendChild(decodeRow1)   
        }
        const deleteTickerClick = (idx)=>{
            if(idx>-1){
               ai_ledger.ticks.splice(idx,1); //remove item
               localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
               initEncode(); //RELOAD VIEW.                 
            }
        }
        const deleteSpotClick = (idx)=>{ //remove ledger item, save, refresh
         if(idx>-1){
               ai_ledger.spots.splice(idx,1); //remove item
               localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
               initDecode(); //RELOAD VIEW.                 
            }
        }

        const openBtnClick = ()=>{
          if(instructionText.style.display==='block'){
             instructionText.style.display='none'
            } else {
             instructionText.style.display='block'
          }
      }

      const deleteSelectedTicker = ()=>{
         let selected = [],temp=[];
         let items = document.getElementsByClassName('tkr_checkmark');
         for(let i=0; i<items.length;i++){
            if(items[i].checked){
               selected.push(i)
               items[i].checked = false;
            }
         }
         if(!selected.length){showErrorMSG(' Nothing selected üòµ') 
            return;}         
         for(let idx=0; idx<ai_ledger.ticks.length;idx++){
            if(!selected.includes(idx)){ //not removed
               temp.push(ai_ledger.ticks[idx])
            } else {console.log('removed',idx)}
            // temp.ticks.splice(selected[idx],1); //remove item
         }
         ai_ledger.ticks = temp;
         localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
         initEncode(); //RELOAD VIEW.                 

      }
      const deleteSelectedSpot = ()=>{
         let selected = [], temp = [];
         let items = document.getElementsByClassName('spot_checkmark');
         for(let i=0; i<items.length;i++){
            if(items[i].checked){
               selected.push(i)
               items[i].checked = false;
            }
         }
         if(!selected.length){showErrorMSG(' Nothing selected üòµ'); return;}         
         for(let idx=0; idx<ai_ledger.spots.length;idx++){
            if(!selected.includes(idx)){ //not removed
               temp.push(ai_ledger.spots[idx])
            } else {console.log('removed',idx)}
         }
         ai_ledger.spots = temp;         
         localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
         initDecode(); //RELOAD VIEW.                
      }

      const deleteSelectedSchedule = (event)=>{ //remove ledger item, save, refresh
         let capSelected = [], detSelected=[], temp = [], removeChildRow=false;
         // let items = document.getElementsByClassName('spot_checkmark');
         let capChecks = document.getElementsByName("scheduleCapsRadio");
         let detChecks = document.getElementsByName("scheduleDetailsRadio");
         for(let i=0; i<capChecks.length;i++){
            if(capChecks[i].checked){ //SORT THROUGH ai_schedule to delete data and reload
               capSelected.push(capChecks[i])
               let ymdt = capChecks[i].ymdt;
               let zArr = capChecks[i].ymdt.split('_')
               let tickTGT = zArr.pop();
               let ymd = zArr.join('_')
               let qtrCaps = ai_schedule.quarters[ymd].caps;
               let monthData = ai_schedule.quarters[ymd].monthData;
               for(var j=0; j<qtrCaps.length;j++){ //DELETE TGT DATA
                  if( tickTGT === qtrCaps[j].tkr ){
                     qtrCaps.splice(j,1) //remove data
                     break;
                  }
               }
               for(var k=0; k<monthData.length;k++){ //DELETE MONTH DATA
                  if( tickTGT === monthData[k].tick ){
                     monthData.splice(k,1) //remove data
                     // break;
                  }
               }
               //SAVE & RELOAD VIEW
               showErrorMSG('üíó Saved. ');
               localStorage.ai_schedule = JSON.stringify(ai_schedule) //SAVE to LOCAL STORAGE
               generateScheduleClick(); //RELOAD VIEW. 
               break;
            }
         }
         if(!capSelected.length && detChecks.length){ // DETAIL ROW SELECTION
            for(let j=0; j<detChecks.length;j++){
               if(detChecks[j].checked){
                  detSelected.push(detChecks[j])
                  let ymdtn = detChecks[j].ymdtn
                  let zArr = detChecks[j].ymdtn.split('_')
                  let itemNUM = zArr.pop();
                  let tickTGT = zArr.pop();
                  let ymd = zArr.join('_')
                  let monthData = ai_schedule.quarters[ymd].monthData;
                  // for(var k=0; k<monthData.length;k++){ //DELETE MONTH DATA
                  if(monthData[itemNUM]){

                     if( tickTGT === monthData[itemNUM].tick ){
                        monthData.splice(itemNUM,1) //remove data
                     }
                  }
                  //SAVE & RELOAD VIEW
                  showErrorMSG(' Savedüíó ');
                  localStorage.ai_schedule = JSON.stringify(ai_schedule) //SAVE to LOCAL STORAGE
                  generateScheduleClick(); //RELOAD VIEW. 
                  break;
               }
            }
         } 
         if(!capSelected.length && !detSelected.length){showErrorMSG(' Nothing selected üòµ'); return;}
      } //end delete tgt fn

      const generateProfitLossClick = ()=>{ // GENERATE PROFIT AND LOSS DISPLAY
         //PROFIT and LOSS View
         let keyz = Object.keys(ai_MetaData_TickMap);
         let bookValue = 0, bankValue=0,itm;
         let totMargin=0,totMarginPct,totMarginSum,totMarginBOX,totMarginPctBOX;
         for(let idx=0; idx<keyz.length;idx++){
            itm=ai_MetaData_TickMap[keyz[idx]];
            bookValue += itm.total_val;
            bankValue += 3; //TODO sum SOLD PROFITS.

            if(itm.margin){ //CALCULATE TOTAL MARGIN
               totMargin += itm.margin;
            }
            totMarginSum += itm.margin_pct;
         }
         totMarginPct = totMarginSum/keyz.length;
         let totalsRow1,totBookValue1,totBankValue1;
         totBookValue1 = document.createElement('aside')
         totBookValue1.classList.add('totBookValue1')
         totBookValue1.innerHTML = 'book_value: '+bookValue;
         totMarginBOX = document.createElement('aside')
         totMarginBOX.classList.add('totMarginBOX')
         totMarginBOX.innerHTML = 'total margin: '+totMargin;
         totMarginPctBOX = document.createElement('aside')
         totMarginPctBOX.classList.add('totMarginPctBOX')
         totMarginPctBOX.innerHTML = 'total pct: '+totMarginPct;
         totBankValue1 = document.createElement('aside')
         totBankValue1.classList.add('totBankValue1')
         totBankValue1.innerHTML = 'bank_value: '+bankValue;//+ai_MetaData_TickMap[ticker.tick].sum_spot_amt || 0;                        
         totalsRow1 = document.createElement('footer')
         totalsRow1.innerHTML = "Totals:"         
         totalsRow1.classList.add('totalsRow1') 
         totalsRow1.appendChild(totBookValue1)         
         totalsRow1.appendChild(totMarginBOX)         
         totalsRow1.appendChild(totBankValue1)         
         generatedProfitsBOX.appendChild(totalsRow1) 
         


      } 

      /*****************************************\
       * - end UI fns
      \****************************************/



      /*****************************************\
       * - ai_BANK functions
      \*****************************************/
      let ai_BANK = {
         "Q4_2023_OCT": {trxns:{pads:[],trims:[]}}
      }
   

   /************************************************\
    * - AI_SCHEDULE_MATRIX
    *  - ability to save quarterly data in localstorage
   \************************************************/
      /*****************************************\
       * - SCHEDULE functions
      \****************************************/
      const trimScheduleClick = ()=>{ 
         //selection trim ai_bank{"tick":{balance}}  //increment trim_count.
         let selected=null, quarterID,transObj;
         let items = document.getElementsByClassName('cap_checkmark');
         for(let i=0; i<items.length;i++){
            if(items[i].checked){
               selected = items[i]
               selected.checked = false;
               break;
            }
         }
         if(!selected){ showErrorMSG(' Nothing selected üòµ'); return; }            
         quarterSet = selected.ymdt.toUpperCase().split('_');
         quarterTick = quarterSet.pop()
         quarterID = quarterSet.join('_')
         if(!ai_BANK[quarterID]){ //INIT
            ai_BANK[quarterID] = {id:quarterID}
            ai_BANK[quarterID].trxns = {pads:[],trims:[]}
         } 
         transObj = {}
         transObj.tick = ''
         transObj.type = ''
         transObj.amt = ''
         transObj.at = ''
         transObj.ymd = ''
         //FIND UI DATA
         quarterSets = Object.keys(ai_schedule.quarters);
         for(var x = 0; x<quarterSets.length;x++){ //UI QUARTER DATA LOOKUP.
            quarter= ai_schedule.quarters[quarterSets[x]];            
            if(quarter.qID===quarterID){
               for(var y=0; y<quarter.caps.length;y++){ // LOOK UP CAPS
                  if(quarter.caps[y].tkr.toUpperCase()===quarterTick){
                     transObj.tick = quarterTick;
                     transObj.type = 'trim';
                     transObj.amt =  quarter.caps[y].trim_at || '';
                     transObj.ymd = formatYMD();
                     break;             
                  }
               }
               ai_schedule.quarters[quarterID].monthData.push(transObj)
               break
            }
         }
         if(!transObj || !transObj.tick){return}
         ai_BANK[quarterID].trxns.trims.push(transObj)
         show_schedule_details_view = true; //SHOW DETAILS
         totalsBtn2.style.display='block'
         detailsBtn2.style.display='none'  
         generateScheduleClick();       
         //UPDATE LOCALSTORAGE with ai_schedule. SAVE
         localStorage.ai_schedule = JSON.stringify(ai_schedule)  
      }
      const padScheduleClick = ()=>{ 
         let selected=null, quarterID,transObj;
         let items = document.getElementsByClassName('cap_checkmark');
         for(let i=0; i<items.length;i++){
            if(items[i].checked){
               selected = items[i]
               selected.checked = false;
               break;
            }
         }
         if(!selected){ showErrorMSG(' Nothing selected üòµ'); return; }            
         show_schedule_details_view = true; //SHOW DETAILS
         quarterSet = selected.ymdt.toUpperCase().split('_');
         quarterTick = quarterSet.pop()
         quarterID = quarterSet.join('_')
         if(!ai_BANK[quarterID]){ //INIT
            ai_BANK[quarterID] = {id:quarterID}
            ai_BANK[quarterID].trxns = {pads:[],trims:[]}
         } 
         transObj = {}
         transObj.tick = ''
         transObj.type = ''
         transObj.amt = ''
         transObj.at = ''
         transObj.ymd = ''
         //FIND UI DATA
         quarterSets = Object.keys(ai_schedule.quarters);
         for(var x = 0; x<quarterSets.length;x++){ //UI QUARTER DATA LOOKUP.
            quarter= ai_schedule.quarters[quarterSets[x]];  
            if(quarter.qID===quarterID){
               for(var y=0; y<quarter.caps.length;y++){ // LOOK UP CAPS
                  if(quarter.caps[y].tkr.toUpperCase()===quarterTick){
                     transObj.tick = quarterTick;
                     transObj.type = 'pad';
                     transObj.amt =  quarter.caps[y].trim_at || '';
                     transObj.ymd = formatYMD();
                     break;             
                  }
               }
               ai_schedule.quarters[quarterID].monthData.push(transObj)
               break
            }
         }
         if(!transObj && transObj.tick){return}
         ai_BANK[quarterID].trxns.pads.push(transObj)
         show_schedule_details_view = true; //SHOW DETAILS
         totalsBtn2.style.display='block'
         detailsBtn2.style.display='none'
         generateScheduleClick();
         //UPDATE LOCALSTORAGE with ai_schedule. SAVE
         localStorage.ai_schedule = JSON.stringify(ai_schedule)  
      }
      const addScheduleClick = ()=>{ 
         //TODO: needs to become QUARTERLY...
         let scheduleRow1,date1,tick1,amountData1;
         let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11;
         let saveBtn3,roleBOX,roleData,atBOX1,atData1;
         scheduleRow1 = document.createElement('article')
         scheduleRow1.classList.add('scheduleRow1')

         // atData1.value = ai_ledger.spots[i].spot_at || '';
         saveBtn3 = document.createElement('button')
         // date1 = document.createElement('input')
         // date1.value = current_ymd.split('YMD_')[1];//user display
         // date1.classList.add('scheduleDate1')
         tick1 = document.createElement('input')
         // amountData1 = document.createElement('input')
         // amountBOX1 = document.createElement('aside')
         // athBOX1 = document.createElement('aside')
         // amountBOX1.innerHTML = "$&nbsp;"
         // athBOX1.innerHTML = "ath&nbsp;"
         // athData1 = document.createElement('input')
         tick1.value = "";
         tick1.placeholder="Q#_YYYY_JAN"
         // amountData1.placeholder = "0.00";
         // athData1.placeholder = "+-:%";
         // tick1.addEventListener("keyup",(e)=>{
         //    saveScheduleBtn1.style.display = 'block'; });
         // athData1.addEventListener("keyup",(e)=>{
         //    saveScheduleBtn1.style.display = 'block'; });
         // amountData1.addEventListener("keyup",(e)=>{
         //    saveScheduleBtn1.style.display = 'block'; });                         
         tick1.classList.add('quarterTXT')
         saveBtn3.innerHTML = 'saveüåü'
         saveBtn3.classList.add('saveBtn2')
         saveBtn3.addEventListener("click",(e)=>{
            saveQuarterClick(e) 
         });

         scheduleRow1.appendChild(tick1)
         scheduleRow1.appendChild(saveBtn3)
         generatedScheduleBOX.appendChild(scheduleRow1)
   
      } //end add schedule click

      const addCapClick = (quarterID) =>{
         saveScheduleClick();//FIX: save first for bug on double create row, keeps first row tickr.
         //go to parent quarter and add a unique row
         let newCap = {}
         let qtr = ai_schedule.quarters[quarterID]; //lookup
         if(!qtr){return}
            newCap.cap = "1000";
            newCap.crashlvl = "2";
            newCap.pad_at = "100";
            newCap.padlvl = "1";
            newCap.tkr = "NEW";
            newCap.trim_at = "100";
         qtr.caps.push(newCap)
         // for(var i = 0; i<ai_schedule[quarterID])
           //SAVE to LOCAL STORAGE
           localStorage.ai_schedule = JSON.stringify(ai_schedule) 
         //   generateScheduleClick(); //RELOAD VIEW.  
           generateScheduleClick(); //RELOAD VIEW.  

           showErrorMSG('‚öîÔ∏è SAVED ‚öîÔ∏è');    


      }

      const saveQuarterClick = (e)=>{ 
         // debugger;
            //GET input value
            let keyInput = e.target.parentElement.children[0].value;
            if(!keyInput){ showErrorMSG('üéÄNo dataüéÄ'); return; }
            keyInput = keyInput.toUpperCase();
            if(ai_schedule[keyInput]){ showErrorMSG('üññduplicateü§ô'); return; }
            
            ai_schedule.quarters[keyInput] = {}
            ai_schedule.quarters[keyInput].qID = keyInput;
            ai_schedule.quarters[keyInput].caps = [];
            ai_schedule.quarters[keyInput].monthData = [];

           //SAVE to LOCAL STORAGE
           localStorage.ai_schedule = JSON.stringify(ai_schedule) 
         //   generateScheduleClick(); //RELOAD VIEW.  
           generateScheduleClick(); //RELOAD VIEW.  

           showErrorMSG('‚öîÔ∏è ADDED ‚öîÔ∏è');          
      }
   const saveScheduleClick = ()=>{ // GENERATE PROFIT AND LOSS DISPLAY
      saveScheduleBtn1.style.display = 'none'; 
         let quarterBoxes = generatedScheduleBOX.children,row,kids,kid;
         let tkr,cap,trim_at,pad_at,padlvl,crashlvl;
         let date3,type3,amt3,role3;
         let capData,trimDetail, expand1;
         let qtrTXT,dataBox1,dataBox2,qtrBOX, tgtMonth;
         let save_schedule = {quarters:{}};
      try{     
           for(var i=0; i<quarterBoxes.length;i++){ //LOOP QUARTER BOX
            qtrBOX = quarterBoxes[i];
            if(qtrBOX.classList.contains('quarterBOX')){
               kids = qtrBOX.children;
               for(var j=0;j<kids.length;j++){ //MONTH LOOP
                  kid = kids[j];
                  if(kid.classList.contains('quarterHeader')){ 
                     qtrTXT = kid.children[0].value;
                     save_schedule.quarters[qtrTXT] = {qID:qtrTXT}
                     // ai_schedule.quarters[qtrTXT] = {qID:qtrTXT}
                     expand1 = (kid.children[2].innerHTML==='v')? true : false;
                     save_schedule.quarters[qtrTXT].expanded = expand1;
                     // ai_schedule.quarters[qtrTXT].expanded = expand1;
                     tgtMonth = save_schedule.quarters[qtrTXT]
                     // tgtMonth = ai_schedule.quarters[qtrTXT]
                     tgtMonth.caps = [];
                     tgtMonth.monthData = []
                  }
                  if(kid.classList.contains('monthBOX')){
                     if(kid.children.length===0){ // NO MONTHBOX data, COLLAPSED.
                        save_schedule.quarters[qtrTXT] = ai_schedule.quarters[qtrTXT]
                        continue; //DO NOT SAVE, use saved data, since it is collapsed.
                     } 
 
                     for(var k=0; k<kid.children.length;k++){ //POPULATE DATA from VIEW.
                       row = kid.children[k]
                       if(row.classList.contains('capROW')){ 
                           capData = {};//, trimData = {};
                           for(var mm = 0; mm<row.children.length;mm++){
                              dataBox1 = row.children[mm]
                              if(dataBox1.classList.contains('trimTick')){
                                 dataBox1.value = dataBox1.value.toUpperCase();                     
                                 capData.tkr = dataBox1.value;
                                 tkr = capData.tkr;
                              }
                              else if(dataBox1.classList.contains('inputDATABOX1')){
                                 capData.cap = dataBox1.children[0].value
                              }
                              else if(dataBox1.classList.contains('inputDATABOX2')){
                                 capData.trim_at = dataBox1.children[0].value
                              }
                              else if(dataBox1.classList.contains('inputDATABOX3')){
                                 capData.pad_at = dataBox1.children[0].value
                              }
                              else if(dataBox1.classList.contains('inputDATABOX4')){
                                 capData.padlvl = dataBox1.children[0].value
                              }
                              else if(dataBox1.classList.contains('inputDATABOX5')){
                                 capData.crashlvl = dataBox1.children[0].value
                              }
                           }
                        } //end cap row
                  
                        else if(row.classList.contains('detailRow2')){  
                           trimData = {}; 
                           for(var mm = 0; mm<row.children.length;mm++){
                              dataBox2 = row.children[mm];
                              if(dataBox2.classList.contains('detailDate1')){
                                 trimData.ymd = dataBox2.value
                                 trimData.tick = tkr //important load.
                              }
                              if(dataBox2.classList.contains('typeBOX1')){
                                 trimData.type = dataBox2.children[0].value.toLowerCase()
                              }
                              if(dataBox2.classList.contains('amtBOX1')){
                                 trimData.amt = dataBox2.children[0].value
                              }
                              if(dataBox2.classList.contains('roleBOX1')){
                                 trimData.role = dataBox2.children[0].value
                              }
                           }
                        } // end details row
           
                        // if(capData.tkr && tgtMonth && tgtMonth.caps){
                        if(capData.tkr){
                           tgtMonth.caps.push(capData);
                           capData = {}
                        }
                        // if (trimData.type && tgtMonth && tgtMonth.monthData){
                        // if(!show_schedule_details_view){   //could move out of loop, below.
                        //    tgtMonth.monthData = ai_schedule.quarters[qtrTXT].monthData
                        // }                            
                        else if (trimData.type){
                           tgtMonth.monthData.push(trimData)
                           trimData = {}
                        }

                     } //END CAPS ROW.
                  } //END EXPANDED MONTHBOX
               } //MONTH LOOP
               if(!show_schedule_details_view){   //could move out of loop, below.
                           tgtMonth.monthData = ai_schedule.quarters[qtrTXT].monthData
                        }  
             } // IF QUARTER 
           } //END QUARTER BOX LOOP
         } //end TRY
         catch(e){
            console.log('err in save')
            showErrorMSG('‚öîÔ∏è ERR ‚öîÔ∏è'); 
            return;
         }
         if(save_schedule){
           //SAVE to LOCAL STORAGE
           ai_schedule = save_schedule;
           localStorage.ai_schedule = JSON.stringify(ai_schedule) 
           generateScheduleClick(); //RELOAD VIEW.  
           showErrorMSG('‚öîÔ∏è SAVED ‚öîÔ∏è');
         }
      }     //end save schedule click        

   /************************************************\
    * - AI_SCHEDULE_MATRIX
    *  - ability to save quarterly data in localstorage
   \************************************************/

   let ai_schedule=null;
   const ai_schedule_LOAD_MOCK_DATA=()=>{ //READ from OBJ
      ai_schedule = {"quarters":{"Q4_2023_OCT":{"qID":"Q4_2023_OCT","expanded":false,"caps":[{"tkr":"NVDA","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"50","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_27","tick":"NVDA","type":"pad","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"pad","amt":"100","role":"EXIT"},{"ymd":"2023_11_27","tick":"COST","type":"pad","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"MSFT","type":"trim","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"QQQ","type":"trim","amt":"50","role":"WATCH"}]},"Q4_2023_NOV":{"qID":"Q4_2023_NOV","expanded":false,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"META","cap":"100","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_30","tick":"COIN","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_30","tick":"META","type":"pad","amt":"100","role":"SAFE"},{"ymd":"2023_11_30","tick":"ETH","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_30","tick":"ETH","type":"pad","amt":"100","role":"HIGHrHIGH"}]},"Q4_2023_DEC":{"qID":"Q4_2023_DEC","expanded":true,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"META","cap":"100","trim_at":"10","pad_at":"10","padlvl":"1","crashlvl":"2"},{"tkr":"TSLA","cap":"100","trim_at":"10","pad_at":"10","padlvl":"2","crashlvl":"2"}],"monthData":[{"ymd":"2023_12_01","tick":"BTC","type":"trim","amt":"25","role":"RISKOFF"}]},"Q1_2024_JAN":{"qID":"Q1_2024_JAN","expanded":false,"caps":[],"monthData":[]}}}
      // ai_schedule = {"quarters":{"Q4_2023_OCT":{"qID":"Q4_2023_OCT","expanded":false,"caps":[{"tkr":"NVDA","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"50","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_27","tick":"NVDA","type":"pad","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"pad","amt":"100","role":"EXIT"},{"ymd":"2023_11_27","tick":"COST","type":"pad","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"MSFT","type":"trim","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"QQQ","type":"trim","amt":"50","role":"WATCH"}]},"Q4_2023_NOV":{"qID":"Q4_2023_NOV","expanded":true,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"META","cap":"100","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_30","tick":"COIN","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_30","tick":"META","type":"pad","amt":"100","role":"SAFE"},{"ymd":"2023_11_30","tick":"ETH","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_30","tick":"ETH","type":"pad","amt":"100","role":"HIGHrHIGH"}]},"Q4_2023_DEC":{"qID":"Q4_2023_DEC","expanded":false,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[]},"Q1_2024_JAN":{"qID":"Q1_2024_JAN","expanded":false,"caps":[],"monthData":[]}}};
      // ai_schedule = {"quarters":{"Q4_2023_OCT":{"qID":"Q4_2023_OCT","expanded":false,"caps":[{"tkr":"NVDA","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"50","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_27","tick":"NVDA","type":"pad","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"trim","amt":"100","role":"LOrLO"},{"ymd":"2023_11_27","tick":"MDB","type":"pad","amt":"100","role":"EXIT"},{"ymd":"2023_11_27","tick":"COST","type":"pad","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"MSFT","type":"trim","amt":"100","role":"LONG"},{"ymd":"2023_11_27","tick":"QQQ","type":"trim","amt":"50","role":"WATCH"}]},"Q4_2023_NOV":{"qID":"Q4_2023_NOV","expanded":true,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_28","tick":"ETH","type":"trim","amt":"100","role":"HIGHrHIGH"},{"ymd":"2023_11_28","tick":"ETH","type":"pad","amt":"100","role":"LOrLO"}]},"Q4_2023_DEC":{"qID":"Q4_2023_DEC","expanded":false,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[]},"Q1_2024_JAN":{"qID":"Q1_2024_JAN","expanded":false,"caps":[],"monthData":[]}}}
      // ai_schedule = {"quarters":{"Q4_2023_OCT":{"qID":"Q4_2023_OCT","expanded":true,"caps":[{"tkr":"NVDA","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"50","pad_at":"50","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_27","tick":"NVDA","type":"pad","amt":"100","role":"LOWrLOW"},{"ymd":"2023_11_27","tick":"MDB","type":"trim","amt":"100","role":"LOWrLOW"},{"ymd":"2023_11_27","tick":"MDB","type":"pad","amt":"100","role":"EXIT"},{"ymd":"2023_11_27","tick":"COST","type":"pad","amt":"100","role":"HEDGE"},{"ymd":"2023_11_27","tick":"MSFT","type":"trim","amt":"100","role":"HEDGE"},{"ymd":"2023_11_27","tick":"QQQ","type":"trim","amt":"50","role":"WATCH"}]},"Q4_2023_NOV":{"qID":"Q4_2023_NOV","expanded":true,"caps":[{"tkr":"NVDA","cap":"4500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"MDB","cap":"1500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COST","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"1"},{"tkr":"GOOG","cap":"5000","trim_at":"100","pad_at":"100","padlvl":"2","crashlvl":"3"},{"tkr":"MSFT","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"QQQ","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"XLK","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"AMD","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"V","cap":"500","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"COIN","cap":"200","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"BTC","cap":"2000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"},{"tkr":"ETH","cap":"1000","trim_at":"100","pad_at":"100","padlvl":"1","crashlvl":"2"}],"monthData":[{"ymd":"2023_11_28","tick":"ETH","type":"trim","amt":"100","role":"HIGHrHIGH"},{"ymd":"2023_11_28","tick":"ETH","type":"pad","amt":"100","role":"LOWrLOW"}]},

   }

   const ai_schedule_init=()=>{ //READ from LOCAL STORAGE
      ai_schedule = (localStorage.ai_schedule)?
         JSON.parse( localStorage.ai_schedule ):null;
      // ai_schedule = null; //test mock data
      if(!ai_schedule){
         ai_schedule_LOAD_MOCK_DATA();
      }
   }; ai_schedule_init();

   /*************************************\
    * SCHEDULE_MATRIX - quarterly values in time
   \*************************************/
   // const update_Schedule_Matrix = ( tickr ) => {//data updated: to not lose, push duplicate to history
      //TODO
      // if(!tickr || !tickr.price || !tickr.ymd){return}
      // if(!ai_schedule[tickr.tick]) { ai_schedule[tickr.tick]= {tick:ai_schedule[tickr.tick]} }
      // if(!ai_schedule[tickr.tick]['ymd_price']) { ai_schedule[tickr.tick]['ymd_price'] = {} }
      // ai_schedule[tickr.tick]['ymd_price'][tickr.ymd] = tickr.price;
      // //UPDATE LOCALSTORAGE with ai_schedule. SAVE
      // localStorage.ai_schedule = JSON.stringify(ai_schedule)  
   // }      
         
   const generateScheduleClick = ()=>{ //GENERATE SCHEDULE DISPLAY
      let trimBOX1,quarter,quarterSets=[];
      let quarterBOX,monthBOX,quarterTXT,capROW;//trimBtnROW;
      let capsData, trimTick,trimCap,trim_at,pad_at,pad_limit,lvl_limit;
      let trimBtn1,padBtn1,lvlUpBtn1,expandBtn1;
      let capBOX1, capData1, trim_atBOX1,trim_atData1,pad_atBOX1,pad_atData1;
      let padlvlBOX1,padlvlData1,crashlvlBOX1,crashlvlData1;
      let monthData1=[], addBtn4, quarterHeader;
      let capsNUMBOX1, capsCHECKBOX1, capsSelect1, capsCheckMark1; 
      let capsNUMBOX2, capsCHECKBOX2, capsSelect2, capsCheckMark2;
      generatedScheduleBOX.innerHTML = ""
      quarterSets = Object.keys(ai_schedule.quarters);//ai_ledger.ticks;
      if(!quarterSets){ console.log('no data'); return}
      for(let i=0;i<quarterSets.length;i++){  //BEGIN QUARTERLY LOOP
         quarter= ai_schedule.quarters[quarterSets[i]];
         quarterBOX = document.createElement('section')
         quarterBOX.classList.add('quarterBOX')

         quarterHeader = document.createElement('aside')
         quarterHeader.classList.add('quarterHeader')

         quarterTXT = document.createElement('input')
         quarterTXT.classList.add('quarterTXT')
         quarterTXT.value = quarter.qID;//.quarterID.toUpperCase();
         quarterTXT.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
            }); 

         expandBtn1 = document.createElement('button')
         expandBtn1.innerHTML = '>'
         expandBtn1.classList.add('addBtn4')
         expandBtn1.setAttribute('data-arg3',quarter.qID)
         expandBtn1.addEventListener("click",(e)=>{
               expandTGTClick(e.target.getAttribute('data-arg3')) });
         addBtn4 = document.createElement('button')
         addBtn4.innerHTML = 'addtgtüåü'
         addBtn4.classList.add('addBtn4')
         addBtn4.setAttribute('data-arg2',quarter.qID)
         addBtn4.addEventListener("click",(e)=>{
               addCapClick(e.target.getAttribute('data-arg2')) });

         quarterHeader.appendChild(quarterTXT)
         quarterHeader.appendChild(addBtn4)
         quarterHeader.appendChild(expandBtn1)
         // quarterBOX.appendChild(addBtn4)
         quarterBOX.appendChild(quarterHeader)

         monthBOX = document.createElement('article')
         monthBOX.classList.add('monthBOX')

         if(quarter.expanded){
               expandBtn1.innerHTML = 'v'
            for(let j=0;j<quarter.caps.length;j++){  //MONTHLY CAP LOOP .
               capsData = quarter.caps[j];
               capROW = document.createElement('aside')
               capROW.classList.add('capROW')
               //**********************************************selector
               capsNUMBOX1 = document.createElement('aside')
               capsNUMBOX1.classList.add('capsNUMBOX1')//encodeNUMBOX1
               capsCHECKBOX1 = document.createElement('label')
               capsCHECKBOX1.classList.add('checkboxFrame') 
               capsNUMBOX1.innerHTML=j+1;            
               capsSelect1 = document.createElement('input');
               capsSelect1.ymdt = quarter.qID+'_'+capsData.tkr.toUpperCase() || '';
               capsSelect1.type = "radio";
               capsSelect1.name = "scheduleCapsRadio";
               capsSelect1.classList.add('cap_checkmark')
               capsCHECKBOX1.appendChild(capsSelect1)
               capsCheckMark1 = document.createElement('span')
               capsCheckMark1.classList.add('checkmark')
               capsCHECKBOX1.appendChild(capsCheckMark1)
               capsNUMBOX1.appendChild(capsCHECKBOX1)
               capROW.appendChild(capsNUMBOX1)
               // end ************************************** selector
               trimTick = document.createElement('input')
               trimTick.classList.add('trimTick')
               trimTick.value = capsData.tkr.toUpperCase() || 0;
               trimTick.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });             
               capBOX1 = document.createElement('aside')
               capBOX1.innerHTML="tgt&nbsp";
               capBOX1.classList.add('inputDATABOX1')
               capData1 = document.createElement('input')
               capData1.classList.add('inputDATA1')
               capData1.placeholder = "$0.00";
               capData1.value = capsData.cap || '';          
               capData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });  
               capBOX1.appendChild(capData1)

               trim_atBOX1 = document.createElement('aside')
               trim_atBOX1.innerHTML="trim&nbsp";
               trim_atBOX1.classList.add('inputDATABOX2')
               trim_atData1 = document.createElement('input')
               trim_atData1.classList.add('inputDATA2')
               trim_atData1.placeholder = "$0.00";
               trim_atData1.value = capsData.trim_at || '';          
               trim_atData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block';  
               });  
               trim_atBOX1.appendChild(trim_atData1)

               pad_atBOX1 = document.createElement('aside')
               pad_atBOX1.innerHTML="pad&nbsp";
               pad_atBOX1.classList.add('inputDATABOX3')
               pad_atData1 = document.createElement('input')
               pad_atData1.classList.add('inputDATA2')
               pad_atData1.placeholder = "$0.00";
               pad_atData1.value = capsData.pad_at || '';          
               pad_atData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });  
               pad_atBOX1.appendChild(pad_atData1)

               padlvlBOX1 = document.createElement('aside')
               padlvlBOX1.innerHTML="padlvl&nbsp";
               padlvlBOX1.classList.add('inputDATABOX4')
               padlvlData1 = document.createElement('input')
               padlvlData1.classList.add('inputDATA3')
               padlvlData1.placeholder = "0";
               padlvlData1.value = capsData.padlvl || '';          
               padlvlData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });  
               padlvlBOX1.appendChild(padlvlData1)

               crashlvlBOX1 = document.createElement('aside')
               crashlvlBOX1.innerHTML="crashPOS&nbsp";
               crashlvlBOX1.classList.add('inputDATABOX5')
               crashlvlData1 = document.createElement('input')
               crashlvlData1.classList.add('inputDATA3')
               crashlvlData1.placeholder = "0";
               crashlvlData1.value = capsData.crashlvl || 0;          
               crashlvlData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
               });  
               crashlvlBOX1.appendChild(crashlvlData1)

               capROW.appendChild(trimTick)         
               capROW.appendChild(capBOX1)         
               capROW.appendChild(trim_atBOX1)         
               capROW.appendChild(pad_atBOX1)         
               capROW.appendChild(padlvlBOX1)         
               capROW.appendChild(crashlvlBOX1)
               monthBOX.appendChild(capROW)

               if(show_schedule_details_view){   //BEGIN DETAILS VIEW
                  let detailRow2,date1,detAmt,detType,detRole,detNote;
                  let monthData = null;
                  let role1,role2,role3,role4,role5,role6,role7,role8,role9,role10,role11;
                  let type1,type2,type3,type4;
                  let roleBOX,roleData;
                  let typeBOX,typeData,atBOX1;
                  let atData1,amtData1;
                  for(let k=0;k<quarter.monthData.length;k++){  //CAP DETAILS LOOP.
                     monthData = quarter.monthData[k];
                     if(monthData.tick.toUpperCase()!=capsData.tkr.toUpperCase()){continue;}
                     detailRow2 = document.createElement('section')
                     detailRow2.classList.add('detailRow2')
                     //DETAILS ROW
               //**********************************************selector
               capsNUMBOX2 = document.createElement('aside')
               capsNUMBOX2.classList.add('capsNUMBOX2')//encodeNUMBOX1
               capsCHECKBOX2 = document.createElement('label')
               capsCHECKBOX2.classList.add('checkboxFrame') 
               capsNUMBOX2.innerHTML=k+1;            
               capsSelect2 = document.createElement('input');
               capsSelect2.ymdtn = quarter.qID+'_'+capsData.tkr.toUpperCase()+'_'+k || '';
               // capsSelect2.ymdt = quarter.qID+'_'+capsData.tkr.toUpperCase() || '';
               capsSelect2.type = "radio";
               capsSelect2.name = "scheduleDetailsRadio";
               capsSelect2.classList.add('cap_checkmark')
               capsCHECKBOX2.appendChild(capsSelect2)
               capsCheckMark2 = document.createElement('span')
               capsCheckMark2.classList.add('checkmark')
               capsCHECKBOX2.appendChild(capsCheckMark2)
               capsNUMBOX2.appendChild(capsCHECKBOX2)
               detailRow2.appendChild(capsNUMBOX2)
               // end ************************************** selector
                        date1 = document.createElement('input')
                        date1.value = ''+monthData.ymd;
                        date1.classList.add('detailDate1')
                        date1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
                        });  
                        amtBOX1 = document.createElement('aside')
                        amtBOX1.innerHTML="amt&nbsp;"
                        roleBOX = document.createElement('aside')
                        roleBOX.innerHTML="role&nbsp;"
                        typeBOX = document.createElement('aside')
                        typeBOX.innerHTML="type&nbsp;"
                        roleData = document.createElement('select')
                        typeData = document.createElement('input')
                        role1 = document.createElement('option')
                        role2 = document.createElement('option')
                        role3 = document.createElement('option')
                        role4 = document.createElement('option')
                        role5 = document.createElement('option')
                        role6 = document.createElement('option')
                        role7 = document.createElement('option')
                        role8 = document.createElement('option')
                        role9 = document.createElement('option')
                        role10 = document.createElement('option')
                        role11 = document.createElement('option')
                        role1.value = "...";
                        role2.value = "HOLD";
                        role3.value = "WATCH";
                        role4.value = "RISKOFF";
                        role5.value = "LONG";
                        role6.value = "TRIM";
                        role7.value = "SAFE";
                        role8.value = "RISKON";
                        role9.value = "EXIT";
                        role10.value = "LOrLO";
                        role11.value = "HIGHrHIGH";
                        role1.innerHTML = "...";
                        role2.innerHTML = "HOLD";
                        role3.innerHTML = "WATCH";
                        role4.innerHTML = "RISKOFF";
                        role5.innerHTML = "LONG";
                        role6.innerHTML = "TRIM";
                        role7.innerHTML = "SAFE";
                        role8.innerHTML = "RISKON";
                        role9.innerHTML = "EXIT";
                        role10.innerHTML = "LOrLO";
                        role11.innerHTML = "HIrHI";
                        roleData.appendChild(role1);
                        roleData.appendChild(role2);
                        roleData.appendChild(role3);
                        roleData.appendChild(role4);
                        roleData.appendChild(role5);
                        roleData.appendChild(role6);
                        roleData.appendChild(role7);
                        roleData.appendChild(role8);
                        roleData.appendChild(role9);
                        roleData.appendChild(role10);
                        roleData.appendChild(role11);
                        roleData.value = monthData.role || '';
                        roleBOX.appendChild(roleData)
                        
                        roleData.addEventListener("change",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
                        });  
                        typeData.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
                        });  

                        typeData.value= monthData.type || '';
                        roleBOX.classList.add('roleBOX1')
                        
                        typeBOX.appendChild(typeData)
                        typeBOX.classList.add('typeBOX1')
                        
                        if(monthData.type==='trim'){
                           typeData.classList.add('typeTRIMColor')
                        } else if (monthData.type==='pad'){
                           typeData.classList.add('typePADColor')
                        }

                        roleData.classList.add('roleData1')
                        typeData.classList.add('typeData1')
                        amtData1 = document.createElement('input')
                        amtData1.placeholder = "$0.00";
                        amtData1.value = monthData.amt;
                        amtData1.classList.add('spotAtData1')

                        amtData1.addEventListener("keyup",(e)=>{ saveScheduleBtn1.style.display = 'block'; 
                        });  

                        amtBOX1.classList.add('amtBOX1')
                        amtBOX1.appendChild(amtData1)            
                        detailRow2.appendChild(date1)
                        detailRow2.appendChild(typeBOX)
                        detailRow2.appendChild(amtBOX1)
                        detailRow2.appendChild(roleBOX)

                     //END DETAILS ROW
                     monthBOX.appendChild(detailRow2) 

                  } //END DETAILS LOOP
               }  //END DETAILS VIEW
            } //END MONTHLY LOOP
         } else {quarter.expanded = false;}//END EXPANDED
         quarterBOX.appendChild(monthBOX)
         generatedScheduleBOX.appendChild(quarterBOX)
      } //END QUARTERLY LOOP
   } //end generate schedule 2


   let show_schedule_details_view = null;
      const setScheduleDetailsClick = (e)=>{ 
         if(e.target.id==='detailsBtn2'){
            totalsBtn2.style.display='block'
            detailsBtn2.style.display='none'
            show_schedule_details_view = true;
         }else{
            totalsBtn2.style.display='none'               
            detailsBtn2.style.display='block'               
            show_schedule_details_view = false;
         }
         // scheduleBOX.scrollIntoView({
         //    behavior: 'smooth',
         //    block: 'start'
         // })
         generateScheduleClick();
      }



      /***************************************
       * MARGINS
       * **************************************/

      let show_margin_details_view = false;
      const setMarginDetailsClick = (e)=>{
         if(e.target.id==='detailsBtn1'){
            totalsBtn1.style.display='block'
            show_margin_details_view = true;
         }else{
            totalsBtn1.style.display='none'               
            show_margin_details_view = false;
         }
         allMarginsBOX.scrollIntoView({
         behavior: 'smooth',
         block: 'start'
      })
         generateMarginsClick();
   }
   let ai_MetaData_TickMap={}; //todo rename ai_MetaData_TickMap also separate generation into marginGeneration.
   const generateMarginsClick = ()=>{ // GENERATE Margin DISPLAY
      //TODO if selected, only run selected
      let ticker,spot_ticker,tickerBOX1,tickerSet=[],spotSet=[],numSPOTS=0;
      let numSPOT1, marginsRow1, profitRow1,curPrice1;
      generatedMarginsBOX.innerHTML = ""; //reset view
      generatedProfitsBOX.innerHTML = ""; //reset view //todo refactor
      if(show_margin_details_view){
         detailsBtn1.style.display = 'none'; //hide details
      }else{
         detailsBtn1.style.display='block' //show details btn
      }
      tickerSet = ai_ledger.ticks;
      spotSet = ai_ledger.spots;
      //TICKER INIT - iterator METADATA factory (generator)
      for(let i=0;i<tickerSet.length;i++){
         ticker= tickerSet[i];
         if(ticker.tick ){ // INIT META DATA obj
            ai_MetaData_TickMap[ticker.tick] = {};
            ai_MetaData_TickMap[ticker.tick].num = 0;
            ai_MetaData_TickMap[ticker.tick].curr_price = (ticker.price || 0);
            ai_MetaData_TickMap[ticker.tick].sum_spot_amt = 0;
            ai_MetaData_TickMap[ticker.tick].total_val = 0;
         }
      }
      //SPOT - iterator - calculate - METADATA generator
      for(let i=0;i<spotSet.length;i++){
         spot_ticker= spotSet[i];
         if(!ai_MetaData_TickMap[spot_ticker.tick]){ continue }
         ai_MetaData_TickMap[spot_ticker.tick].num++;
         ai_MetaData_TickMap[spot_ticker.tick].sum_spot_amt =
            parseInt(ai_MetaData_TickMap[spot_ticker.tick].sum_spot_amt) + parseInt(spot_ticker.amount || 0);               
         ai_MetaData_TickMap[spot_ticker.tick].total_val += parseInt(spot_ticker.spot_at || 0);               
      }
      //SPOT - CALCULATE SPOT MARGIN
      let curr_price, total_val,sum_spot_amt, spot_num, spot_margin, margin_pct, avg_price;
      for(let i=0;i<tickerSet.length;i++){
         ticker= tickerSet[i];
         if(!ai_MetaData_TickMap[ticker.tick]){ continue }
         spot_num = ai_MetaData_TickMap[ticker.tick].num;
         curr_price = ai_MetaData_TickMap[ticker.tick].curr_price;
         // spot_price = ticker.spot_at; //TODO rename at_spot
         sum_spot_amt = ai_MetaData_TickMap[ticker.tick].sum_spot_amt;
         total_val = ai_MetaData_TickMap[ticker.tick].total_val;
         margin_pct = 0;
         if(curr_price && spot_num && total_val){
            avg_price = total_val / spot_num;
            avg_price = avg_price.toFixed(0);//round number 
            spot_margin = curr_price - avg_price; //CALCULATE SPOT MARGIN
            ai_MetaData_TickMap[ticker.tick].margin = spot_margin || 0;
            ai_MetaData_TickMap[ticker.tick].avg_price = avg_price || 0;
         }
         if(spot_margin){
            margin_pct = spot_margin / avg_price * 100;
            ai_MetaData_TickMap[ticker.tick].margin_pct = margin_pct;
         }
      }

      //TODO separate into displayFactory()
      let avgPrice1,detailRow1;
      //DISPLAY - iterator
      for(let i=0;i<tickerSet.length;i++){
         ticker= tickerSet[i];
         
         if(!ai_MetaData_TickMap[ticker.tick]){continue;}
         if(!ai_MetaData_TickMap[ticker.tick].num){continue;}
         marginsRow1 = document.createElement('section')
         marginsRow1.classList.add('marginsRow1')
         profitRow1 = document.createElement('section')
         profitRow1.classList.add('profitRow1')
         tickerBOX1 = document.createElement('aside')
         tickerBOX1.classList.add('proTick1')
         tickerBOX1.innerHTML = ticker.tick;
         numSPOT1 = document.createElement('aside')
         numSPOT1.classList.add('proSpots1')
         curPrice1 = document.createElement('aside')
         curPrice1.classList.add('curPrice1')
         curPrice1.innerHTML =  'last: '+ai_MetaData_TickMap[ticker.tick].curr_price || 0;
         avgPrice1 = document.createElement('aside')
         avgPrice1.classList.add('avgPrice1')
         avgPrice1.innerHTML =  'avg: '+ai_MetaData_TickMap[ticker.tick].avg_price || 0;
         numMargin1 = document.createElement('aside')
         numMargin1.classList.add('proMargin1')
         numPCT1 = document.createElement('aside')
         numPCT1.classList.add('proPCT1')
         numTotalAmt1 = document.createElement('aside')
         numTotalAmt1.classList.add('proTotalAmt1')
         numTotalAmt1.innerHTML = 'sum: '+ai_MetaData_TickMap[ticker.tick].sum_spot_amt || 0;
         numSPOTS = (ai_MetaData_TickMap[ticker.tick] && ai_MetaData_TickMap[ticker.tick].num)?
            ai_MetaData_TickMap[ticker.tick].num:0;
         numSPOT1.innerHTML = 'spots: '+ numSPOTS;
         numMargin1.innerHTML = `margin: 
            ${( ai_MetaData_TickMap[ticker.tick].margin>0 )?'+':''}
            ${ai_MetaData_TickMap[ticker.tick].margin}`
         numPCT1.innerHTML = `pct: 
            ${( ai_MetaData_TickMap[ticker.tick].margin>0 )?'+':''}
            ${ai_MetaData_TickMap[ticker.tick].margin_pct.toFixed(0)}%`;

         marginsRow1.appendChild(tickerBOX1)         
         marginsRow1.appendChild(numSPOT1)         
         marginsRow1.appendChild(numTotalAmt1)         
         marginsRow1.appendChild(avgPrice1)         
         marginsRow1.appendChild(curPrice1)         
         marginsRow1.appendChild(numMargin1)         
         marginsRow1.appendChild(numPCT1)         
         generatedMarginsBOX.appendChild(marginsRow1)         

         if(show_margin_details_view){ //BEGIN DETAILS VIEW
            //loop over spots of and display detailRow.
            let spotObj,spotDate1,spotAmt1,spotPrice1;
            let spotMargin2=0,spotPCT2=0,curr_price2;
            for(var j=0; j<ai_ledger.spots.length;j++){
               spotObj = ai_ledger.spots[j];
               if(spotObj.tick != ticker.tick){continue}
               detailRow1 = document.createElement('section')
               detailRow1.classList.add('detailRow1')
               // detailRow1.innerHTML = ticker.tick;

               //CALCULATE individual SPOT MARGIN
               curr_price2 = ai_MetaData_TickMap[ticker.tick].curr_price;
               spotMargin2 = curr_price2 - spotObj.spot_at
               spotPCT2 = (spotMargin2/spotObj.spot_at) * 100 
               // spotPCT2 = spotPCT2.toFixed(0);

               spotDate1 = document.createElement('aside')
               spotDate1.classList.add('spotDate1')
               spotDate1.innerHTML = spotObj.ymd || 0;

               spotAmt1 = document.createElement('aside')
               spotAmt1.classList.add('spotAmt1')
               spotAmt1.innerHTML =  'amt '+spotObj.amount || 0;

               spotPrice1 = document.createElement('aside')
               spotPrice1.classList.add('spotPrice1')
               spotPrice1.innerHTML =  'price '+spotObj.spot_at || 0;

               spotMargin1 = document.createElement('aside')
               spotMargin1.classList.add('spotMargin1')
               // spotMargin1.innerHTML =  'margin '+spotMargin2 || 0;
               spotMargin1.innerHTML = `margin: 
                  ${(spotMargin2>0 )?'+':''}${spotMargin2}`                  

               spotPCT1 = document.createElement('aside')
               spotPCT1.classList.add('spotPCT1')
               // spotPCT1.innerHTML =  'pct '+ spotPCT2 || 0;
               spotPCT1.innerHTML = `pct: 
                  ${(spotPCT2>0 )?'+':''}
                  ${spotPCT2.toFixed(0)}%`;                  

               detailRow1.appendChild(spotDate1)         
               detailRow1.appendChild(spotAmt1)         
               detailRow1.appendChild(spotPrice1)         
               detailRow1.appendChild(spotMargin1)         
               detailRow1.appendChild(spotPCT1)

               generatedMarginsBOX.appendChild(detailRow1)   
            }
         } //END DETAILS VIEW
      }
      // //PROFIT and LOSS View
      // let keyz = Object.keys(ai_MetaData_TickMap);
      // let bookValue = 0, bankValue=0,itm;
      // let totMargin=0,totMarginPct,totMarginSum,totMarginBOX,totMarginPctBOX;
      // for(let idx=0; idx<keyz.length;idx++){
      //    itm=ai_MetaData_TickMap[keyz[idx]];
      //    bookValue += itm.total_val;
      //    bankValue += 3; //TODO sum SOLD PROFITS.

      //    if(itm.margin){ //CALCULATE TOTAL MARGIN
      //       totMargin += itm.margin;
      //    }
      //    totMarginSum += itm.margin_pct;
      // }
      // totMarginPct = totMarginSum/keyz.length;
      // let totalsRow1,totBookValue1,totBankValue1;
      // totBookValue1 = document.createElement('aside')
      // totBookValue1.classList.add('totBookValue1')
      // totBookValue1.innerHTML = 'book_value: '+bookValue;
      // totMarginBOX = document.createElement('aside')
      // totMarginBOX.classList.add('totMarginBOX')
      // totMarginBOX.innerHTML = 'total margin: '+totMargin;
      // totMarginPctBOX = document.createElement('aside')
      // totMarginPctBOX.classList.add('totMarginPctBOX')
      // totMarginPctBOX.innerHTML = 'total pct: '+totMarginPct;
      // totBankValue1 = document.createElement('aside')
      // totBankValue1.classList.add('totBankValue1')
      // totBankValue1.innerHTML = 'bank_value: '+bankValue;//+ai_MetaData_TickMap[ticker.tick].sum_spot_amt || 0;                        
      // totalsRow1 = document.createElement('footer')
      // totalsRow1.innerHTML = "Totals:"         
      // totalsRow1.classList.add('totalsRow1') 
      // totalsRow1.appendChild(totBookValue1)         
      // totalsRow1.appendChild(totMarginBOX)         
      // totalsRow1.appendChild(totBankValue1)         
      // generatedProfitsBOX.appendChild(totalsRow1)  
   } //END generate margins click

   //    const generateSelected = ()=>{
   //    let selected = [];
   //    let items = document.getElementsByClassName('tkr_checkmark');
   //    for(let i=0; i<items.length;i++){
   //       if(items[i].checked){
   //          selected.push(i)
   //          items[i].checked = false;
   //       }
   //    }
   //    if(!selected.length){showErrorMSG(' Nothing selected üòµ') 
   //       return;}
   //    ai_schedule = [];
   //    ai_analytics = [];
   //    for(let i=0; i<selected.length;i++){
   //       //calculate +-%, days since ath, 
   //    }
   //    scheduleBOX.scrollIntoView({
   //       behavior: 'smooth',
   //       block: 'start'
   //    })

   // }
   // const sellSelectedSpots = ()=>{
   //    let selected = [];
   //    let items = document.getElementsByClassName('spot_checkmark');
   //    for(let i=0; i<items.length;i++){
   //       if(items[i].checked){
   //          selected.push(i)
   //          items[i].checked = false;
   //       }
   //    }         
   //    if(!selected.length){showErrorMSG(' Nothing selected üòµ') 
   //       return;}  
   // }

      const expandTGTClick = (qID)=>{ //expand or collapse section
         // debugger;
         let qtr = ai_schedule.quarters[qID];
         qtr.expanded = !qtr.expanded;
           //SAVE to LOCAL STORAGE
         localStorage.ai_schedule = JSON.stringify(ai_schedule) 
         generateScheduleClick(); //RELOAD VIEW.  
         showErrorMSG('‚öîÔ∏è SAVED ‚öîÔ∏è');   
      }

      const getLatestTickerClick = ()=>{ //loop all for last close.
         let item,urls=[];
         for(let i=0;i<ai_ledger.ticks.length;i++){
            // if(i>=1){continue;}//DEV_limiter stay below 20
            item = ai_ledger.ticks[i];
            // item.tick = 'NVDA';//DEV_specifier 
            urls.push(`https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${item.tick}&interval=5min&apikey=${stock_api_key}`)
         }
         getData_Quotes(urls)
         showErrorMSG('üåºDATA UPDATEDüåº') //todo error. need show message not error.

      }



      /**************************************************************\
       * MSGS : interface
       * \***********************************************************/
       let stateErrorBox = document.getElementById('errorBox');
         let stateSavedBox = document.getElementById('savedBox');
         let stateCopiedBox = document.getElementById('copiedBox');
 

      /**************************************************************\
       * API : interface
       * \***********************************************************/
      const getData_Quotes = async (quotes)=>{
         if(!stock_api_key){ showErrorMSG('üõ†Ô∏è connect api'); return;}
         if(!quotes.length){return;}
         try{
            for(let i=0; i<quotes.length;i++){
               fetch(quotes[i]).then((data)=>{
                  if(data.ok){
                     return data.json();
                  }
               }).then((tickData)=>{
                  let responseTick = tickData["Meta Data"]["2. Symbol"];
                  if(!responseTick){return;}
                  let latestClose = tickData["Time Series (5min)"][Object.keys(tickData["Time Series (5min)"])[0]]["4. close"];
                  if(!latestClose){return;}
                  console.log(responseTick,"last close",latestClose)
                  updateLatestTickPrice(responseTick,latestClose);
                  //SHOW CONNNECTED and tgt, hide disconnected and key input
                  stateConnectedBox.style.display = "inline";
                  stateNotConnectedBox.style.display = "none";   
                  keyBOX.style.display = "none"; 
                  latestBtn1.style.display = "none"; //do not call twice. because of limit
                  localStorage.ai_ledger = JSON.stringify(ai_ledger) //SAVE to LOCAL STORAGE
                  initEncode(); //RELOAD VIEW. 

               }).catch((error)=>{
                  showErrorMSG('üõ†Ô∏è api daily limit')
                  console.log(error)
               })
            }
         } catch(error) {
               showErrorMSG('üõ†Ô∏è api down')
         }           
      }
      const getData_TestConnection = ()=>{
         if(!stock_api_key){
            showErrorMSG('üõ†Ô∏è connect api')
            return;}
            //SHOW CONNNECTED and tgt, hide disconnected and key input
            stateConnectedBox.style.display = "inline";
            stateNotConnectedBox.style.display = "none";   
            keyBOX.style.display = "none"; 
            latestBtn1.style.display = "inline";
      }

      const getData_Intraday = ()=>{
         // debugger;
         if(!stock_api_key){return;}
            const symbol = 'NVDA';
            const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${symbol}&interval=5min&apikey=${stock_api_key}`;
            fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                //SHOW CONNNECTED and tgt, hide disconnected and key input
                stateConnectedBox.style.display = "inline";
                stateNotConnectedBox.style.display = "none";   
                symbolBOX.style.display = "inline";
                keyBOX.style.display = "none"; 
                // Process the data here (e.g., extract the latest stock price)
                const latestPrice = data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]]['1. open'];
               //data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]]['1. open'];
               // data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]];
               // {1. open: '175.3700', 2. high: '175.3700', 3. low: '175.0000', 4. close: '175.0000', 5. volume: '24782'}
                console.log(`Latest price for ${symbol}: ${latestPrice}`);
            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });         
      }

      function updateLatestTickPrice(responseTick,latestClose){
         //loop ai_ledger, update price and latest label.
         let tickr='',item=null;
         for(let i=0; i<ai_ledger.ticks.length;i++){
            tickr=ai_ledger.ticks[i];
            if(tickr.tick===responseTick){ //FOUND ticker record
               ai_ledger.ticks[i].price = latestClose.split('.')[0];
               ai_ledger.ticks[i].price_ymd = formatYMD();
               update_History_matrix(
                  {tick:tickr.tick,
                     ymd:ai_ledger.ticks[i].price_ymd,
                     price: ai_ledger.ticks[i].price
                  })
               break;
            }
         }
      }

   /************************************************\
    * - AI_HISTORY_MATRIX
    *  - ability to save in localstorage
   \************************************************/
      let ai_history_matrix=null;

      const ai_history_LOAD_MOCK_DATA=()=>{ //READ from OBJ
         // ai_history_matrix = {'NVDA':{ymd_price:{'2023_11_01':'428'}}}
         // ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464"}}}
         // ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464","2023_11_11":"483"}},"V":{"ymd_price":{"2023_11_11":"245"}},"MSFT":{"ymd_price":{"2023_11_11":"369"}},"MDB":{"ymd_price":{"2023_11_11":"375"}},"XLK":{"ymd_price":{"2023_11_11":"179"}},"NDAQ":{"ymd_price":{"2023_11_11":"52"}},"AMD":{"ymd_price":{"2023_11_11":"118"}},"COST":{"ymd_price":{"2023_11_11":"576"}},"COIN":{"ymd_price":{"2023_11_11":"93"}},"QQQ":{"ymd_price":{"2023_11_11":"377"}},"GOOGL":{"ymd_price":{"2023_11_11":"132"}}}
         // ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464","2023_11_11":"483","2023_11_16":"488","2023_11_20":"493","2023_11_24":"477","2023_11_27":"477"}},"V":{"ymd_price":{"2023_11_11":"245","2023_11_16":"248","2023_11_20":"249","2023_11_24":"254","2023_11_27":"254"}},"MSFT":{"ymd_price":{"2023_11_11":"369","2023_11_16":"371","2023_11_20":"366","2023_11_24":"377","2023_11_27":"377"}},"MDB":{"ymd_price":{"2023_11_11":"375","2023_11_16":"391","2023_11_20":"392","2023_11_24":"407","2023_11_27":"407"}},"XLK":{"ymd_price":{"2023_11_11":"179","2023_11_16":"182","2023_11_20":"182","2023_11_24":"184","2023_11_27":"184"}},"NDAQ":{"ymd_price":{"2023_11_11":"52","2023_11_16":"52","2023_11_20":"53","2023_11_24":"55","2023_11_27":"55"}},"AMD":{"ymd_price":{"2023_11_11":"118","2023_11_16":"117","2023_11_20":"120","2023_11_24":"122","2023_11_27":"122"}},"COST":{"ymd_price":{"2023_11_11":"576","2023_11_16":"596","2023_11_20":"576","2023_11_24":"592","2023_11_27":"592"}},"COIN":{"ymd_price":{"2023_11_11":"93","2023_11_16":"99","2023_11_20":"98","2023_11_24":"115","2023_11_27":"115"}},"QQQ":{"ymd_price":{"2023_11_11":"377","2023_11_16":"385","2023_11_20":"385","2023_11_24":"389","2023_11_27":"389"}},"GOOGL":{"ymd_price":{"2023_11_11":"132","2023_11_16":"135","2023_11_20":"135","2023_11_24":"136","2023_11_27":"136"}}}
         ai_history_matrix = {"NVDA":{"ymd_price":{"2023_11_01":"428","2023_11_08":"464","2023_11_09":"464","2023_11_11":"483","2023_11_16":"488","2023_11_20":"493","2023_11_24":"477","2023_11_27":"477","2023_11_28":"477","2023_11_30":"481","2023_12_01":"467"}},"V":{"ymd_price":{"2023_11_11":"245","2023_11_16":"248","2023_11_20":"249","2023_11_24":"254","2023_11_27":"254","2023_11_28":"253","2023_11_30":"254","2023_12_01":"256"}},"MSFT":{"ymd_price":{"2023_11_11":"369","2023_11_16":"371","2023_11_20":"366","2023_11_24":"377","2023_11_27":"377","2023_11_28":"382","2023_11_30":"379","2023_12_01":"374"}},"MDB":{"ymd_price":{"2023_11_11":"375","2023_11_16":"391","2023_11_20":"392","2023_11_24":"407","2023_11_27":"407","2023_11_28":"408","2023_11_30":"432","2023_12_01":"438"}},"XLK":{"ymd_price":{"2023_11_11":"179","2023_11_16":"182","2023_11_20":"182","2023_11_24":"184","2023_11_27":"184","2023_11_28":"184","2023_11_30":"184","2023_12_01":"185"}},"NDAQ":{"ymd_price":{"2023_11_11":"52","2023_11_16":"52","2023_11_20":"53","2023_11_24":"55","2023_11_27":"55","2023_11_28":"55","2023_11_30":"55"}},"AMD":{"ymd_price":{"2023_11_11":"118","2023_11_16":"117","2023_11_20":"120","2023_11_24":"122","2023_11_27":"122","2023_11_28":"122","2023_11_30":"124","2023_12_01":"121"}},"COST":{"ymd_price":{"2023_11_11":"576","2023_11_16":"596","2023_11_20":"576","2023_11_24":"592","2023_11_27":"592","2023_11_28":"594","2023_11_30":"587","2023_12_01":"596"}},"COIN":{"ymd_price":{"2023_11_11":"93","2023_11_16":"99","2023_11_20":"98","2023_11_24":"115","2023_11_27":"115","2023_11_28":"127","2023_11_30":"127","2023_12_01":"134"}},"QQQ":{"ymd_price":{"2023_11_11":"377","2023_11_16":"385","2023_11_20":"385","2023_11_24":"389","2023_11_27":"389","2023_11_28":"390","2023_11_30":"390","2023_12_01":"390"}},"GOOGL":{"ymd_price":{"2023_11_11":"132","2023_11_16":"135","2023_11_20":"135","2023_11_24":"136","2023_11_27":"136","2023_11_28":"137","2023_11_30":"135","2023_12_01":"131"}},"TSLA":{"ymd_price":{"2023_11_30":"245","2023_12_01":"238"}},"META":{"ymd_price":{"2023_11_30":"332","2023_12_01":"324"}}}
      }

      const ai_history_init=()=>{ //READ from LOCAL STORAGE
         ai_history_matrix = (localStorage.ai_history_matrix)?
            JSON.parse( localStorage.ai_history_matrix ):null;
         if(!ai_history_matrix){
            ai_history_LOAD_MOCK_DATA();
         }
      }; ai_history_init();

      /*************************************\
       * HISTORY_MATRIX - store values in time
      \*************************************/
      const update_History_matrix = ( tickr ) => {//data updated: to not lose, push duplicate to history
         if(!tickr || !tickr.price || !tickr.ymd){return}
         if(!ai_history_matrix[tickr.tick]) { ai_history_matrix[tickr.tick]= {tick:ai_history_matrix[tickr.tick]} }
         if(!ai_history_matrix[tickr.tick]['ymd_price']) { ai_history_matrix[tickr.tick]['ymd_price'] = {} }
         ai_history_matrix[tickr.tick]['ymd_price'][tickr.ymd] = tickr.price;
         //UPDATE LOCALSTORAGE with ai_history_matrix. SAVE
         localStorage.ai_history_matrix = JSON.stringify(ai_history_matrix)  
      }
      /*************************************\
       * UTILITIES
      \*************************************/
         const formatYMD = () => {
            const currentDate = new Date();
            const year = currentDate.getFullYear();
            const month = String(currentDate.getMonth() + 1).padStart(2, '0'); // Month is zero-based, so add 1 and pad with '0'
            const day = String(currentDate.getDate()).padStart(2, '0');
            const formattedDate = `${year}_${month}_${day}`;
            return formattedDate;
         }
         const copyHistoryFn = () => { //
            console.log("ai_history_matrix ",ai_history_matrix)
            navigator.clipboard.writeText(JSON.stringify(ai_history_matrix) );
            stateCopiedBox.style.display = "inline";
            stateConnectedBox.style.display = "none";
            stateNotConnectedBox.style.display = "none";              
            setTimeout( ()=>{
               stateCopiedBox.style.display = "none";
               if(stock_api_key){
                  stateConnectedBox.style.display = "inline";
                  stateNotConnectedBox.style.display = "none";  
               }else{
                  stateConnectedBox.style.display = "none";
                  stateNotConnectedBox.style.display = "inline";  
               }               
            },2000)                          
         };   
         const copyLedgerFn = () => { 
            console.log("ai_ledger = ",ai_ledger)
            navigator.clipboard.writeText(JSON.stringify(ai_ledger) );
            stateCopiedBox.style.display = "inline";
            stateConnectedBox.style.display = "none";
            stateNotConnectedBox.style.display = "none";              
            setTimeout( ()=>{
               stateCopiedBox.style.display = "none";
               if(stock_api_key){
                  stateConnectedBox.style.display = "inline";
                  stateNotConnectedBox.style.display = "none";  
               }else{
                  stateConnectedBox.style.display = "none";
                  stateNotConnectedBox.style.display = "inline";  
               }               
            },2000)               
         };          
         const copyScheduleFn = () => { 
            console.log("ai_schedule = ",ai_schedule)
            navigator.clipboard.writeText(JSON.stringify(ai_schedule) );
            stateCopiedBox.style.display = "inline";
            stateConnectedBox.style.display = "none";
            stateNotConnectedBox.style.display = "none";              
            setTimeout( ()=>{
               stateCopiedBox.style.display = "none";
               if(stock_api_key){
                  stateConnectedBox.style.display = "inline";
                  stateNotConnectedBox.style.display = "none";  
               }else{
                  stateConnectedBox.style.display = "none";
                  stateNotConnectedBox.style.display = "inline";  
               }               
            },2000)  
         }
         const resetAllFn = () => { 
            ai_ledger_LOAD_MOCK_DATA();
            ai_history_LOAD_MOCK_DATA();
            ai_schedule_LOAD_MOCK_DATA();
           //SAVE to LOCAL STORAGE
           localStorage.ai_ledger = JSON.stringify(ai_ledger)  
           localStorage.ai_history_matrix=JSON.stringify(ai_history_matrix)  
           localStorage.ai_schedule=JSON.stringify(ai_schedule)  
           initEncode(); //RELOAD VIEW.             
           initDecode(); //RELOAD VIEW.             
         };            
         let primeFn = () => {
            selectedTXT = textareaBOX.value.substring(textareaBOX.selectionStart, textareaBOX.selectionEnd);
            if(selectedTXT){
               function formatPrimeKey() {// Replace spaces with underscores
                  let addEndSpace = false;
                  if(selectedTXT.charAt(selectedTXT.length-1)===' '){addEndSpace=true;}
                  transcript = selectedTXT.replace(/[ ]/g, '_');
                  transcript = transcript.replace(/[^a-zA-Z_]+/g, '');
                  transcript = `_${transcript}_`; //Wrap in _
                  transcript = transcript.replace(/__/g, '_');
                  transcript = (addEndSpace)?transcript+' ':transcript;
               }; formatPrimeKey();
               textareaBOX.value = textareaBOX.value.substring(0, textareaBOX.selectionStart) +
                  transcript +
                  textareaBOX.value.substring(textareaBOX.selectionEnd);
               textareaBOX.focus();
            }else{ showErrorMSG('‚ö†Ô∏è double click select...') }
         }
         let omniFn = () => { 
            selectedTXT = textareaBOX.value.substring(textareaBOX.selectionStart, textareaBOX.selectionEnd);
            if(selectedTXT && selectedTXT.indexOf(' ')>-1){
               let addEndSpace = false;
               if(selectedTXT.charAt(selectedTXT.length-1)===' '){addEndSpace=true;}
               transcript = selectedTXT.replace(/ /g,'_')
               transcript = transcript.replace(/[,.!?<>;:|'"-]/g, '');
               transcript = (addEndSpace)?transcript+' ':transcript;
               textareaBOX.value = textareaBOX.value.substring(0, textareaBOX.selectionStart) +
                  transcript +
                  textareaBOX.value.substring(textareaBOX.selectionEnd);
               textareaBOX.focus();
            }else{ showErrorMSG('‚ö†Ô∏è select text with spaces...') }
          }
         let alphaFn = () => { 
            selectedTXT = textareaBOX.value.substring(textareaBOX.selectionStart, textareaBOX.selectionEnd);
            if(selectedTXT){
               function formatAlphaKey() {// Replace spaces with underscores
                  let addEndSpace = false;
                  if(selectedTXT.charAt(selectedTXT.length-1)===' '){addEndSpace=true;}
                  transcript = selectedTXT.replace(/[ ]/g, '').toUpperCase();
                  transcript = transcript.replace(/[^a-zA-Z_]+/g, '');
                  transcript = `a${transcript}a`; //Wrap in _
                  transcript = transcript.replace(/aa/g, 'a');
                  transcript = (addEndSpace)?transcript+' ':transcript;
               }; formatAlphaKey();
               textareaBOX.value = textareaBOX.value.substring(0, textareaBOX.selectionStart) +
                  transcript +
                  textareaBOX.value.substring(textareaBOX.selectionEnd);
               textareaBOX.focus();
            }else{ showErrorMSG('‚ö†Ô∏è select any word...') }
          }
         let ymdFn = () => { 
            transcript = textareaBOX.value;
            textareaTXT = transcript.split('\n')             
            if(textareaTXT && textareaTXT.length>0){
               textareaTXT.push(current_ymd);
               textareaBOX.value = textareaTXT.join('\n');
            }            
          }
          let hrFn = () => {
            transcript = textareaBOX.value;
            textareaTXT = transcript.split('\n')             
            if(textareaTXT && textareaTXT.length>0){
               textareaTXT.push('<hr></hr>');
               textareaBOX.value = textareaTXT.join('\n');
            }             
         }             
         let undoFn = () => { 
            transcript = textareaBOX.value;
            textareaTXT = transcript.split('\n')             
            if(textareaTXT && textareaTXT.length>0){
               textareaTXT = textareaTXT.slice(0,textareaTXT.length-1)
               textareaBOX.value = textareaTXT.join('\n');
            }
         };         
         let titlelineFn = () => {  
            transcript = textareaBOX.value;
            textareaTXT = transcript.split('\n')
            if(textareaTXT && textareaTXT.length>0){
                txtline = textareaTXT[textareaTXT.length-1]
                if(txtline.charAt(0)==='#'){
                    if(txtline.charAt(1)==='#'){
                        if(txtline.charAt(2)==='#'){// back to blank
                            txtline = txtline.split(' ')
                            txtline = txtline.splice(1,txtline.length).join(' ')
                        }else{ //add 3
                            txtline = '#'+txtline;
                        }
                    }else{ //add 2
                        txtline = '#'+txtline;
                    }
                }else{ //add 1
                    txtline = '# '+txtline;
                }
                textareaTXT[textareaTXT.length-1] = txtline;
                textareaBOX.value = textareaTXT.join('\n');
                toggleRecordState(false);
               //  recognition.stop();
            }
         };          
         let numberlineFn = () => {  
            transcript = textareaBOX.value;
            textareaTXT = transcript.split('\n')
            if(textareaTXT && textareaTXT.length>0){
                txtline = textareaTXT[textareaTXT.length-1]
                function incrementNum(inputString) { //regex iteration of number lists
                    return inputString.replace(/^(\d+\.)?(.*)$/, function(match, number, rest) {
                        if (number === undefined) { // If no number, add "1." at the beginning
                            return "1. " + rest;
                        } else {// If number, increment and add back to string
                            return (parseInt(number, 10) + 1) + "." + rest;
                        }
                    });
                }; 
                txtline = incrementNum(txtline);
                textareaTXT[textareaTXT.length-1] = txtline;
                textareaBOX.value = textareaTXT.join('\n');
                toggleRecordState(false);
               //  recognition.stop();
            }
         }
      
         let quotelineFn = () => { 
            transcript = textareaBOX.value;
            textareaTXT = transcript.split('\n')
            if(textareaTXT && textareaTXT.length>0){
               if(textareaTXT[textareaTXT.length-1].indexOf('> ')===0){
                  txtline = textareaTXT[textareaTXT.length-1].replace('> ','')
               } else {
                  txtline = '> '+textareaTXT[textareaTXT.length-1]
               }
                textareaTXT[textareaTXT.length-1] = txtline;
                textareaBOX.value = textareaTXT.join('\n');
                toggleRecordState(false);
               //  recognition.stop();
            }            
         }
         let endlineFn = () => {  
            transcript = textareaBOX.value;
            textareaTXT = transcript.split('\n')
            if(textareaTXT && textareaTXT.length>0){
                txtline = textareaTXT[textareaTXT.length-1]
                txttgt = txtline.charAt(txtline.length-1)
                if(txttgt==='.'){ txtline=setCharAt(txtline,txtline.length-1,',');
                } else if(txttgt===','){ txtline=setCharAt(txtline,txtline.length-1,'_');
                } else if(txttgt==='_'){ txtline=setCharAt(txtline,txtline.length-1,'?');
                } else if(txttgt==='?'){ txtline=setCharAt(txtline,txtline.length-1,'!');
                } else if(txttgt==='!'){ txtline=setCharAt(txtline,txtline.length-1,'.');
                } else { txtline += '.';}
                textareaTXT[textareaTXT.length-1] = txtline;
                textareaBOX.value = textareaTXT.join('\n');
                toggleRecordState(false);
            }
         };   

//-END-BTN-HANDLERS-------------------------------------------------
//-HELPER_fns-------------------------------------------------------
         let getCurrentDocTitle = () => {
            // transcript = textareaBOX.value;
            // textareaTXT = transcript.split('\n')
            // if(textareaTXT && textareaTXT.length>0){            
            //    return textareaTXT[0];
            // }
            // return ''
         }
         let docLoad = () => { //reload all doc view
            //load data for view from local storage
            // all_chat_docs = (localStorage.all_chat_docs)?JSON.parse( localStorage.all_chat_docs ):[];
            // const btnContainer = document.getElementById('btnContainer');
            // btnContainer.innerHTML='';
            // // Map over the array and create buttons
            // all_chat_docs.forEach(item => {
            //    const section1 = document.createElement('section');
            //    section1.classList.add('docRowBox')
            //    const button1 = document.createElement('button');
            //    button1.textContent = item.title;
            //    button1.classList.add('docTopicBtn')
            //    button1.onclick = function() { docLookup(item.title); };
            //    section1.appendChild(button1);
            //    const button2 = document.createElement('button');
            //    button2.textContent = 'üóëÔ∏è';
            //    button2.classList.add('docDeleteBtn')
            //    button2.onclick = function() { docDelete(item.title); };
            //    section1.appendChild(button2);                  
            //    btnContainer.appendChild(section1);                  
            // });            
         }
         let docLookup = (text) => { //load txt, and switch to view
            // transcript = '';
            // all_chat_docs = (localStorage.all_chat_docs)?
            //    JSON.parse( localStorage.all_chat_docs ):[];
            // for(var i=0; i<all_chat_docs.length;i++){
            //    if(all_chat_docs[i].title===text){
            //       transcript = all_chat_docs[i].txt;
            //       break;
            //    }
            // }
            // textareaBOX.value = transcript;
            // textareaTXT = transcript.split('\n')
            // allchatBOX.classList.add('hiddenTab')
            // textareaBOX.classList.remove('hiddenTab') 
         } 
         let docDelete = (text) => { //lookup, remove from local storage.
            // all_chat_docs = (localStorage.all_chat_docs)?
            //    JSON.parse( localStorage.all_chat_docs ):[];
            // for(var i=0; i<all_chat_docs.length;i++){
            //    if(all_chat_docs[i].title===text){ //-----FOUND DOC
            //       // transcript = all_chat_docs[i].txt;
            //       all_chat_docs.splice(i,1)
            //       localStorage.all_chat_docs = JSON.stringify(all_chat_docs)
            //       docLoad();
            //       break; //splice object out
            //    }
            // }
            // allchatBOX.classList.add('hiddenTab')
            // textareaBOX.classList.remove('hiddenTab') 
         } 
      //    function setCharAt(str,idx,chr) {
      //       if(idx > str.length-1) return str;
      //       return str.substring(0,idx) + chr + str.substring(idx+1);
      //   }        
      //    let keyupTXT = (e) => {
      //       transcript = textareaBOX.value;
      //       textareaTXT = transcript.split('\n')
      //    }
         let showErrorMSG = (err) => {
            console.log(err)
            stateErrorBox.innerHTML = err;
            stateErrorBox.style.display = "inline";
            stateConnectedBox.style.display = "none";
            stateNotConnectedBox.style.display = "none";              
            setTimeout( ()=>{
               stateErrorBox.style.display = "none";
               if( stock_api_key   ){
                  stateConnectedBox.style.display = "inline";
                  stateNotConnectedBox.style.display = "none";  
               } else {
                  stateConnectedBox.style.display = "none";
                  stateNotConnectedBox.style.display = "inline";  
               }
               // selectedTXT = '';
            },3000)
         }
         // textareaBOX.addEventListener("select", (e) => {
         //    selectedTXT = e.target.value.substring(
         //       event.target.selectionStart,
         //       event.target.selectionEnd,
         //    );
         // });
      //    recognition.addEventListener("error", (event) => {
      //       console.error(`TRY CHROME browser: ${event.error}`);
      //       // textareaTXT.push("Try CHROME browser. ~ : )")
      //       // textareaBOX.innerHTML = textareaTXT.join('\n');
      //       // toggleRecordState(false);
      //   });          
      </script> 
   </body>
</html>
